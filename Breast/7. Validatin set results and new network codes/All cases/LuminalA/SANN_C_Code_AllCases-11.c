//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double AllCases_11_MLP_21_16_2_input_hidden_weights[16][21]=
{
 {-1.50599724382282e-001, -1.87649654360729e-001, 1.51916678183088e-001, 4.37811128569082e-001, 1.66481182569524e-001, 2.88015014326155e-001, -5.20109720612426e-002, -6.69469396674264e-002, 2.21308363191330e-001, 1.81155851034332e-001, -5.85427383119230e-001, -1.18323588150466e-001, -3.54252654049031e-001, -2.97531873475070e-001, 2.17614605528199e-001, 6.63712255853891e-001, -2.79763955050118e-002, 3.22475018461560e-001, 4.29542532622535e-001, -2.41217028227248e-001, 9.87739495867594e-003 },
 {-7.95401328380636e-002, -1.00692448159024e-001, -2.59025281761694e-003, 1.75594868334528e-001, 2.92820594387919e-002, 1.22691616451249e-001, -1.82119666914481e-001, -6.63595435117249e-002, -2.57565818299131e-002, -3.80179254429252e-002, -3.84581375116914e-001, -1.25155722809793e-001, -6.60389174615627e-002, -1.31229752026093e-001, 1.91208088800215e-001, 9.28387239357005e-002, -1.77784196041991e-001, -7.52074904160854e-002, 1.44362725364887e-001, -8.80233793372139e-002, -8.78018638709027e-002 },
 {6.20111225044617e-002, 7.82676415376702e-002, 1.92436447803724e-002, -1.01410451909720e-001, 1.73334986683223e-002, -1.14858895907425e-002, 8.93758466335963e-002, 6.98302680042980e-002, 3.25894134230710e-002, -3.20218111052842e-002, 2.58114469064327e-001, 6.22906866865507e-002, 4.85782105192334e-002, 9.46926635076194e-002, -1.09570580850060e-001, -1.15016062054225e-001, 7.86977600559555e-002, 3.20522303959781e-002, -1.30190704944675e-001, 1.90094648369886e-002, 5.75693111429116e-002 },
 {1.02774500504063e-001, 6.03913971919842e-002, 5.25941237435473e-002, -3.97760985068486e-002, 4.33087603057706e-002, -8.58497317965854e-003, 7.68439346559187e-002, 7.81022780185052e-002, 7.01634306536965e-002, -1.61322335611519e-002, 2.00757031288289e-001, 8.83801445067856e-002, 7.20614423615316e-002, 1.11803232138057e-001, -1.18653144800036e-001, -4.90642681135924e-002, 8.84120835144228e-002, 8.02464492759048e-002, -1.13001730101554e-002, 1.97238227778119e-002, 2.91292592879489e-002 },
 {-6.75851390740291e-002, -4.73883855697771e-002, 1.54105329303656e-002, -7.65982090969835e-002, 1.33501357508277e-002, -1.50116829949786e-002, 1.41111507128755e-001, 2.88226277135502e-002, 5.41629824888774e-002, 4.62682969422976e-002, 9.63987013583593e-002, 4.83424540667391e-002, -2.26658008949628e-001, -5.86211086130479e-002, -2.76944776735868e-001, 2.29191776723422e-001, 2.10646828705301e-001, 2.71968525999793e-001, 4.82656433811665e-003, -1.07395769420894e-001, 1.71490272211655e-001 },
 {1.00876126100195e-001, 1.02738715665405e-001, -7.63246329458604e-002, -1.77474618498463e-001, -6.62641931387629e-002, -8.11208233548815e-002, 2.62373622703716e-002, 2.64856686586426e-002, -5.62708680325804e-002, -1.08096834294090e-001, 2.75577812102408e-001, 7.11341660908781e-002, 1.92751015480931e-001, 1.56017766922133e-001, -9.58903651593069e-002, -2.91539686526767e-001, -2.46328324135492e-002, -1.39695975444013e-001, -1.64513086532017e-001, 1.66081200334275e-001, 3.00816402380132e-002 },
 {-3.42113910617938e-002, 1.75622602043590e-002, 1.00310746293060e-002, 1.19341376529383e-003, -8.95049297631180e-003, -2.64242329848768e-002, 2.81496599967741e-002, 5.88055004099545e-002, -9.03011534308869e-003, -6.48699153884387e-003, 6.99373357756223e-002, 5.98203691196705e-002, -4.38504289763683e-002, 2.59880749968801e-002, -1.62226889835626e-001, 3.90234554839115e-002, 1.03074791887861e-001, 8.98964245813180e-002, -3.47288848514867e-002, -5.58273003995900e-002, 1.03262683511656e-001 },
 {-2.87035157583330e-002, -2.16825993657044e-002, 3.88512063821531e-002, 1.03643199234640e-001, 3.62085948650338e-002, 5.60819716553835e-002, 3.95459942643106e-002, 9.52914989791375e-003, 5.98113030292735e-002, 9.28085384236966e-002, -8.54945456951770e-002, -9.58415935991776e-003, -5.98727758999743e-002, -6.24356551606256e-002, 4.71943972499141e-002, 1.76774359308062e-001, 1.53729504190416e-002, 9.95180167374167e-002, 6.90651711161214e-002, -6.85591857831054e-002, -8.64367121213621e-003 },
 {1.44937195740021e-001, 1.20060771175007e-001, -7.83685113600609e-003, -1.38660529732333e-001, -1.92060912958379e-002, -4.52658837000729e-002, 3.64689764015165e-002, 2.50632442166961e-002, -7.90520080245895e-002, -1.42070710949207e-002, 3.09010253890081e-001, 1.08248046604436e-001, 2.01378080588651e-001, 1.25026774575216e-001, -7.96752972996234e-002, -2.63583820041542e-001, 4.17021064627674e-003, -1.15975043214573e-001, -1.51847946159232e-001, 1.62228458924810e-001, 2.14534129071191e-002 },
 {3.71526019613363e-002, 7.78380258675445e-002, -1.47968447099274e-003, -4.72939436018468e-002, -2.65358784576825e-002, 8.53018191258280e-003, 9.80092222479039e-003, 7.47934335292158e-003, -7.10171061850550e-002, -3.21720221932672e-002, 7.26776116437612e-002, 2.93099004660562e-002, 1.30582307423510e-001, 7.38275931889606e-002, 3.36754377662623e-002, -2.20307806588444e-001, -1.00344616526429e-001, -9.59015849685367e-002, -8.52006984601737e-002, 1.47664195275857e-001, -3.31706819364759e-002 },
 {8.13945064036242e-003, 1.83047971891066e-002, 8.61505936456946e-002, 7.30646465070692e-002, 3.38153108120387e-002, 8.71283201821885e-002, 5.96127395890956e-002, 1.28536847224154e-002, 1.10704850848630e-001, 9.44567353546756e-002, -2.19141652958619e-002, -2.41444065678912e-002, -1.28532751923239e-001, -7.68532622571503e-002, -2.06154941371416e-002, 2.07805761754857e-001, 8.45742753655805e-002, 1.33246062685473e-001, 1.10476875972696e-001, -7.66587365083429e-002, 2.63966579376777e-002 },
 {1.12583966936070e-001, 1.25407294020630e-001, -8.46467017103208e-002, -2.70298414416395e-001, -7.73884041887627e-002, -1.48249725387989e-001, 3.32737442616674e-003, 1.31616387946394e-002, -1.24851980413404e-001, -1.33238098195925e-001, 3.09493364853366e-001, 1.00077042383580e-001, 2.57910803644728e-001, 1.96802498605630e-001, -8.81316387712776e-002, -3.75902554231236e-001, -2.11425694521300e-003, -2.11560116682857e-001, -2.59116089661082e-001, 2.18444218140264e-001, -2.64243375137898e-002 },
 {7.68103716306577e-002, 5.55132732824208e-002, -3.00487369899718e-002, -6.25064128393949e-002, -2.17263340683243e-002, -6.81140524294699e-002, -2.38631529058328e-002, -1.92363931456694e-002, -6.12731203618147e-002, -2.56384813205001e-002, 8.42452579044734e-002, 8.32056872373776e-003, 1.43739309695643e-001, 9.96486884845026e-002, 2.79241026987381e-002, -2.07903714413236e-001, -8.69933957210281e-002, -1.50183757475547e-001, -1.02802249750644e-001, 1.28916147281809e-001, -7.49044424132569e-002 },
 {-2.10526890544895e-001, -1.81742669705242e-001, 1.45455363224742e-001, 3.46273943998469e-001, 1.08085312200295e-001, 2.10144741063059e-001, 3.14662527145212e-002, -9.23676760731013e-004, 1.35130393093535e-001, 1.92481029843739e-001, -4.91853760100611e-001, -1.15303752577417e-001, -4.00956747682489e-001, -2.99358374609489e-001, 1.13918570087262e-001, 6.00796650732382e-001, 4.15345694989797e-002, 3.15459289710917e-001, 3.65474430095025e-001, -2.88989703911328e-001, 2.72567073504500e-002 },
 {-6.07483156332357e-002, -2.59441514346684e-002, -2.89593268893860e-002, -6.44623036149976e-002, -3.82538701624920e-002, -4.86957991031938e-002, 7.80510298433348e-002, -1.23212106704289e-002, -1.28413160297789e-002, -5.07061419282537e-003, 6.32484708206214e-002, 4.61388191789235e-002, -1.09699582244764e-001, -5.69507113253779e-002, -1.44007297646471e-001, 8.51159340717382e-002, 1.12252154124913e-001, 1.45361493684844e-001, -5.21523171944593e-002, -6.55404074247240e-002, 1.07353908435222e-001 },
 {1.04312164635062e-001, 1.06609786731594e-001, -1.00336600510437e-001, -1.95808093636236e-001, -4.72766053671214e-002, -1.20721138099936e-001, -1.02219727319178e-001, -2.23337056848999e-002, -1.42917145558768e-001, -1.58385368281514e-001, 1.71282672370319e-001, -5.38943578493246e-003, 2.51762338752139e-001, 1.17611348564082e-001, 1.16571542230067e-001, -4.45119109950136e-001, -1.29794628795852e-001, -3.46104035549032e-001, -1.69742994229109e-001, 1.53923945453514e-001, -1.05291740157557e-001 } 
};

double AllCases_11_MLP_21_16_2_hidden_bias[16]={ 3.41082800446352e-001, 3.31161687662646e-001, -1.72782386352401e-001, -6.07494911237073e-002, -4.87415554391162e-001, -6.76801843835457e-002, -2.37798339513743e-001, -4.17556012516241e-002, -1.45478385136950e-002, 1.12345221269974e-001, 9.96393892992864e-003, -1.12888240914749e-001, 1.14444522740292e-001, 1.07210791908467e-001, -3.40707874464857e-001, 1.06765987340544e-001 };

double AllCases_11_MLP_21_16_2_hidden_output_wts[2][16]=
{
 {-1.02133323513437e+000, -7.19678432718944e-001, 4.23492168701025e-001, 2.59946057152727e-001, 6.07703169020748e-001, 3.70385739066195e-001, 3.38972655530883e-001, -1.14423491101066e-001, 3.27382267918623e-001, -4.17240688450529e-002, -9.21763295439888e-002, 5.15063561627934e-001, -7.26479140858171e-003, -6.63650247891994e-001, 4.39738819613355e-001, 6.61522902490219e-002 },
 {5.22423187795377e-001, 4.57699407783749e-001, -2.33429768126552e-001, -2.62215832046061e-001, -6.68498447055253e-002, -3.08317772960956e-001, -6.14808595311094e-002, 9.67223776557586e-002, -3.76861792932658e-001, -8.14818327295753e-002, 3.83035494628240e-002, -4.28144189553744e-001, -1.17907273719471e-001, 5.15246209561226e-001, -3.16469384756624e-002, -9.95761136337218e-002 }
};

double AllCases_11_MLP_21_16_2_output_bias[2]={ 1.67580076169431e+000, -2.07459313613559e+000 };

double AllCases_11_MLP_21_16_2_max_input[21]={ 9.99976003863667e-001, 9.99979798185333e-001, 9.96754273526000e-001, 9.94259912350667e-001, 9.97911037399333e-001, 9.95170697016667e-001, 9.91759014152667e-001, 1.00000000000000e+000, 9.86949090259667e-001, 9.63523508705667e-001, 9.78343830095000e-001, 9.73612353747333e-001, 1.00000000000000e+000, 1.91273776273333e+000, 1.00000000000000e+000, 9.98520710059333e-001, 5.10890428384333e+000, 7.33447582588667e+000, 9.53722447143333e-001, 9.99712242127000e-001, 4.98455292063667e+000 };

double AllCases_11_MLP_21_16_2_min_input[21]={ 5.91988208305000e-001, 6.53839680357333e-001, 6.29844600410667e-001, 6.45877037209000e-001, 6.06600185362667e-001, 6.28152633660333e-001, 6.22852030775000e-001, 6.37131800065667e-001, 6.44827956739000e-001, 5.60026336363667e-001, 5.93084478843333e-001, 6.23316498316333e-001, 6.15666450404333e-001, 6.98564143853333e-001, 6.00000000000000e-001, 4.62825497869000e-001, 2.31263859634667e+000, 2.89944227281000e+000, 1.57423810395910e-001, 4.15107119795333e-001, 1.81602018986333e+000 };

double AllCases_11_MLP_21_16_2_input[21];
double AllCases_11_MLP_21_16_2_hidden[16];
double AllCases_11_MLP_21_16_2_output[2];

double AllCases_11_MLP_21_16_2_MeanInputs[21]={ 9.94239739642218e-001, 9.92644601955275e-001, 9.66739246426214e-001, 9.60851594373479e-001, 9.69385453102823e-001, 9.55835633423741e-001, 9.45299925394236e-001, 9.36915701035893e-001, 9.33596196888181e-001, 8.89310791280151e-001, 9.00698378718522e-001, 8.77433025347167e-001, 8.71428127373364e-001, 1.06003245957123e+000, 9.38632247260580e-001, 8.49899779290703e-001, 3.94675980446453e+000, 5.77075125762000e+000, 7.02402154241995e-001, 8.71386826795786e-001, 3.59136358450307e+000 };

void AllCases_11_MLP_21_16_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(AllCases_11_MLP_21_16_2_max_input[i]-AllCases_11_MLP_21_16_2_min_input[i]);
	input[i] = minimum - delta*AllCases_11_MLP_21_16_2_min_input[i]+ delta*input[i];
 }
}

void AllCases_11_MLP_21_16_2_Normalise(double out[],long length)
{
  long i, j;
  double sum = 0.0;
  for(i=0; i<length; i++)
  {
   if(out[i]>100)
   {
    out[i] = 1.0;
    j = i;
    for(i=0; i<length; i++)
    {
     if(i!=j) out[i] = 0.0;
    }
    break;
   }
   else out[i] = exp(out[i]);
  }
  for(i=0; i<length; i++)
  {
   sum += out[i];
  }
  for(i=0; i<length; i++)
  {
   out[i] = out[i]/sum;
  }
}

void AllCases_11_MLP_21_16_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==1) V_OUT[row] = exp(V_OUT[row]);
   }
}

void AllCases_11_MLP_21_16_2_RunNeuralNet_Classification () 
{
  AllCases_11_MLP_21_16_2_ComputeFeedForwardSignals((double*)AllCases_11_MLP_21_16_2_input_hidden_weights,AllCases_11_MLP_21_16_2_input,AllCases_11_MLP_21_16_2_hidden,AllCases_11_MLP_21_16_2_hidden_bias,21, 16,0);
  AllCases_11_MLP_21_16_2_ComputeFeedForwardSignals((double*)AllCases_11_MLP_21_16_2_hidden_output_wts,AllCases_11_MLP_21_16_2_hidden,AllCases_11_MLP_21_16_2_output,AllCases_11_MLP_21_16_2_output_bias,16, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-LLLglcmImc2): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[0]);
	printf("%s","Cont. Input-1(wavelet-LLHglcmImc2): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-LHLglcmIdmn): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-LLLglcmIdmn): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-HHLglcmIdmn): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-LHHglcmIdmn): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[5]);
	printf("%s","Cont. Input-6(wavelet-LHHglrlmShortRunEmphasis): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-LHLglrlmShortRunEmphasis): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[7]);
	printf("%s","Cont. Input-8(wavelet-LLHglcmIdmn): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-LHLglcmIdn): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[9]);
	printf("%s","Cont. Input-10(wavelet-HHHglcmIdn): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[10]);
	printf("%s","Cont. Input-11(wavelet-LLHglszmSmallAreaEmphasis): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[11]);
	printf("%s","Cont. Input-12(wavelet-LLLglszmSmallAreaEmphasis): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[12]);
	printf("%s","Cont. Input-13(wavelet-LLHglrlmLongRunEmphasis): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[13]);
	printf("%s","Cont. Input-14(wavelet-LLLglcmMCC): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[14]);
	printf("%s","Cont. Input-15(wavelet-HHHglrlmShortRunEmphasis): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[15]);
	printf("%s","Cont. Input-16(wavelet-LHLglrlmRunEntropy): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[16]);
	printf("%s","Cont. Input-17(wavelet-LLLglrlmRunEntropy): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[17]);
	printf("%s","Cont. Input-18(wavelet-LHHglszmSmallAreaEmphasis): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[18]);
	printf("%s","Cont. Input-19(wavelet-HLHglcmImc2): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[19]);
	printf("%s","Cont. Input-20(wavelet-LHLfirstorderEntropy): ");
	scanf("%lg",&AllCases_11_MLP_21_16_2_input[20]);
	for(cont_inps=0;cont_inps<21;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(AllCases_11_MLP_21_16_2_input[cont_inps] == -9999)
	  AllCases_11_MLP_21_16_2_input[cont_inps]=AllCases_11_MLP_21_16_2_MeanInputs[cont_inps];
	}
    AllCases_11_MLP_21_16_2_ScaleInputs(AllCases_11_MLP_21_16_2_input,0,1,21);
	AllCases_11_MLP_21_16_2_RunNeuralNet_Classification();
   //Normalise output if output activation is not Softmax;
 	AllCases_11_MLP_21_16_2_Normalise(AllCases_11_MLP_21_16_2_output,2);
	for(i=0;i<2;i++)
	{
      if(max<AllCases_11_MLP_21_16_2_output[i])
      {
        max=AllCases_11_MLP_21_16_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

