//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double AllCases_5_MLP_21_17_2_input_hidden_weights[17][21]=
{
 {1.10379852946753e-001, 2.07883472179067e-001, 2.77018824467326e-001, 3.67774298851761e-001, 2.48279335845369e-001, -6.52591792011488e-002, 3.44194685813042e-001, 7.15375113648677e-001, 2.32186058014253e-001, 2.55418248643947e-001, -2.01561133352447e-001, -2.76227887314834e-002, -4.19064095545859e-001, -5.36215307592208e-001, -2.33138545377704e-001, -1.95323852510500e-001, -4.73604608249174e-001, 2.48797809037688e-001, -3.16869451206289e-001, -3.46613303521372e-001, -2.72452496459750e-002 },
 {-7.21859581022454e-001, 1.06991404329423e-001, -4.56692411476574e-001, 1.01611541238311e+000, 4.49997929909911e-001, -2.32961011711263e-001, 1.15913755870614e+000, 2.00908470283011e+000, 4.93829434784505e-001, 1.51604582704686e+000, -3.20906192828217e-001, -5.40516768611251e-001, -8.91688924408264e-001, -1.30628541179992e+000, -4.58698773625256e-001, -1.70350733799346e-001, -1.53378423062297e+000, 8.84311580038151e-001, -7.30417297559624e-001, -7.71937437471197e-001, -7.72140625821601e-001 },
 {3.35667747311273e-001, 2.90146667327628e-001, 8.42487717698059e-001, 2.83379288749738e-001, 3.04765934737837e-001, -4.45638450358387e-001, 2.46893050424290e-001, 8.14579455695536e-001, 2.95548046946482e-001, -1.30888462575310e-001, -1.21432337223222e+000, 1.14484050748846e-001, -1.42586495054170e+000, -1.74015524977698e+000, -3.61340751802567e-001, -3.69472830333347e-001, -9.38462687436377e-001, 2.55890344228429e-001, -9.30753886670977e-001, -5.74262875921138e-001, 1.89535290097497e-001 },
 {-1.22381064361515e-001, 1.89431681329823e-001, 1.13407830944463e-001, 6.30389115625596e-001, 4.08450458050027e-001, -6.96040238477550e-002, 6.31528749787283e-001, 1.27781045267403e+000, 4.43599449505119e-001, 7.70880667739438e-001, -2.98856451011507e-001, -6.18310509842143e-002, -6.17310328310594e-001, -8.55466851830399e-001, -1.86339141650036e-001, 4.84679284464191e-002, -8.55741103293053e-001, 6.97797975077306e-001, -3.00522312383019e-001, -3.73625655711302e-001, -1.52890110521275e-001 },
 {-2.32521065094254e+000, -5.06371079370379e-001, -2.31575282239155e+000, 9.06617290111794e-001, 8.40135503220210e-002, -6.22246350674992e-001, 1.35658719667809e+000, 2.14918138802964e+000, 4.55920109899469e-001, 2.82754411066429e+000, -3.88902477125563e-002, -6.24652043146646e-001, -6.99512502438980e-001, -1.17118444511253e+000, -3.06086135783216e-001, 7.62234939023689e-002, -2.05176589188685e+000, 6.83128226941365e-001, 2.75083760036418e-001, -4.79403416948447e-001, -1.62291616936044e+000 },
 {-1.34110955223421e+000, -2.76888469956991e-001, -1.30489221910749e+000, 5.52677659467270e-001, 1.76006253883384e-001, -3.22088427398998e-001, 9.00358252480761e-001, 1.44238508937101e+000, 2.74859776355149e-001, 1.59398662662547e+000, -3.22728561517890e-001, -4.51033910423043e-001, -4.40455395414361e-001, -8.97139981847663e-001, -1.53178372682312e-001, 2.21026297386354e-001, -1.43712339115015e+000, 9.60193864297645e-001, 3.77124000162018e-002, -2.05897567999396e-001, -9.78852230973990e-001 },
 {-1.19047911304952e+000, -2.05327252180560e-001, -1.04580781767108e+000, 7.40973104339674e-001, 2.61032339074856e-001, -4.07721916195144e-001, 1.07966240398249e+000, 1.79949720566484e+000, 2.94602788493455e-001, 1.55391647914616e+000, -3.67972974709097e-001, -6.79869005043888e-001, -7.80950685990137e-001, -1.25747813475926e+000, -3.99923874283524e-001, -6.13109030319285e-002, -1.74851628315015e+000, 1.04936121610651e+000, -3.29943365925522e-001, -5.72016605383263e-001, -1.09346884061121e+000 },
 {-1.35350931387771e-001, 3.49264047308247e-001, 4.69141601820816e-001, 6.57253883441348e-001, 5.32738588236878e-001, -2.55192070564714e-001, 6.18991966294693e-001, 1.62920598543347e+000, 7.02793914922974e-001, 8.55885854416945e-001, -9.21861038633232e-001, 4.60426120613411e-003, -1.14545317563602e+000, -1.68120510450514e+000, -7.70591605540126e-002, 1.55927438811948e-001, -1.03885664220050e+000, 1.05298930543598e+000, -5.57120519435687e-001, -4.30253158322349e-001, 2.42071178943123e-001 },
 {-5.93237665557983e-001, 1.77194182456388e-001, -3.27892004086263e-001, 8.03462401666402e-001, 3.97863114944113e-001, -1.14247242179154e-001, 8.94399882136277e-001, 1.55207717575245e+000, 5.12844014872836e-001, 1.23459746982737e+000, -2.49514339206849e-001, -2.61564531898761e-001, -6.33015880959553e-001, -9.77683107970437e-001, -1.78905833919907e-001, 5.35815751898360e-002, -1.17359637880089e+000, 8.39481894892140e-001, -4.31999186817876e-001, -4.77430521544391e-001, -4.88266432497390e-001 },
 {-7.62764795337438e-001, 9.39044807686675e-002, -6.44873464788956e-001, 1.04657923224906e+000, 4.54004347045980e-001, -1.87429212840563e-001, 1.26551837216515e+000, 1.99014807544511e+000, 5.19804103359575e-001, 1.65923873179092e+000, -2.65638641432542e-001, -6.32184454402829e-001, -7.50264018688080e-001, -1.19899966543465e+000, -5.39750692994640e-001, -2.13251404170454e-001, -1.52327577755233e+000, 7.93282382301740e-001, -6.97031192872393e-001, -8.42069880574013e-001, -8.91995105856315e-001 },
 {4.27835230005579e-002, 2.93548092048985e-001, 6.28935809881214e-001, 2.95240680849368e-001, 2.52122911827995e-001, -3.92432764118038e-001, 2.33952858359063e-001, 1.04361966126562e+000, 4.79368486874062e-001, 2.10897948807666e-001, -9.60724152103639e-001, 2.55419213808821e-001, -1.23924368620806e+000, -1.55548095560163e+000, -1.52344850452969e-001, 2.92373973247907e-002, -9.18391984840963e-001, 6.81378914320511e-001, -5.08803391496906e-001, -3.65625748152894e-001, 2.38875708315069e-001 },
 {-4.71185863874338e-001, 9.74877927931665e-003, -2.69346117504262e-001, 5.22584105107495e-001, 1.84978898709919e-001, -1.27218326805077e-001, 5.80186941178247e-001, 1.16203090856538e+000, 3.64795458429516e-001, 8.68254635626589e-001, -6.17697390016994e-002, -1.47609352883733e-001, -4.23979254232729e-001, -6.73484091726213e-001, -2.61133471392485e-001, 2.30427760775574e-002, -8.41524963587528e-001, 6.09309054364619e-001, -8.17482382836800e-002, -4.32331713030572e-001, -3.44102962093971e-001 },
 {3.54311855906045e-001, 2.59651748998579e-002, 5.35707313177844e-001, -3.05570314584928e-002, -3.08022278945049e-002, -3.66672573861237e-001, -2.84336373403828e-002, -1.29088599714154e-001, -1.64893184230876e-001, -5.98140408427898e-001, -6.08715017810933e-001, -2.51359688918079e-001, -7.74593418375119e-001, -7.93547604377016e-001, -5.74632024520938e-001, -7.45872032787252e-001, -2.05008087052622e-001, -5.11836961907829e-001, -9.73244077077493e-001, -6.36472173029055e-001, 7.41568251808986e-002 },
 {1.88318244963617e-001, 2.17023466336259e-001, 7.27191151049013e-001, 2.31383695556375e-001, 2.48270312775072e-001, -3.84221375506729e-001, 1.75563169641863e-001, 9.31313786955762e-001, 3.89721087894188e-001, 1.35198491795449e-003, -8.92920877197028e-001, 2.59719635020729e-001, -1.20136420436672e+000, -1.49253787290711e+000, -2.15072534064739e-001, -7.01837698546996e-002, -9.72115158659144e-001, 5.69448429091112e-001, -4.92803826469663e-001, -4.03889534626200e-001, 1.57455971142853e-001 },
 {-1.09979712767397e+000, 2.34136181467333e-001, -1.55564734251621e+000, 1.36410906180911e+000, 3.29013625298879e-001, 7.59780094306399e-001, 1.46689269566990e+000, 2.60145433985677e-001, 5.67796669477694e-001, 3.03479470380583e+000, 6.25122557654641e-001, 2.19840542060736e-001, 1.01409176098559e-002, -1.75723316870479e-001, 2.23185392495350e-001, 7.27176171372770e-002, -4.18407176931457e-001, -9.52258975244127e-002, -1.33956245691055e+000, 7.79011043979518e-002, -6.96743102187551e-001 },
 {-3.34772960766683e-002, 5.99994507091626e-002, 1.38714973685076e-001, 2.88873801292977e-001, 6.94714922921773e-002, -9.81797886505569e-002, 2.49170009451626e-001, 8.98589252988597e-001, 1.90574829353105e-001, 1.74974712229406e-001, 1.39759337129481e-001, -1.01750944787124e-001, -2.17970861735870e-001, -2.77560117787691e-001, -3.25211187642407e-001, -2.98082448872397e-002, -5.44123954718255e-001, 4.89303818432226e-001, 1.44982123975704e-001, -3.85526224465639e-001, -2.52309594121581e-001 },
 {-2.08058452192120e+000, -5.01802157707894e-002, -2.59769290349045e+000, 1.39042236037841e+000, 4.27103166222128e-001, -1.02290346446585e-001, 1.86124690195191e+000, 1.60679026556849e+000, 5.97506562731085e-001, 3.79229034535248e+000, 3.56379477219595e-001, -9.11846998564727e-002, -2.42839370802786e-001, -8.66542959905194e-001, -2.86501159808197e-001, -2.52539863637250e-001, -1.32178304867793e+000, -3.18218615550268e-001, -8.84019138029282e-003, -3.96869045795960e-001, -1.51186039502976e+000 } 
};

double AllCases_5_MLP_21_17_2_hidden_bias[17]={ 2.74214400379622e-001, 4.87027785546989e-001, 2.14242300015075e-001, 3.29307570141079e-001, -2.52744472102549e-001, 2.22539425466608e-001, 5.28985051346241e-001, 3.10024013980625e-001, 2.60117521855634e-001, 5.06149564585726e-001, -4.83953435831308e-002, 7.03431411922652e-002, 1.28958032288768e-001, 4.68793207904655e-002, 7.92895293041770e-002, 1.94392099817773e-001, 2.14866046066516e-001 };

double AllCases_5_MLP_21_17_2_hidden_output_wts[2][17]=
{
 {-1.59827568274664e-001, 2.42970802839512e-001, -4.19729427228848e-001, 9.50929107947250e-002, 5.76119227962302e-001, 7.20716929819760e-001, 8.73381029617590e-001, -1.59138661758379e-001, 1.07659451664655e-001, 2.75234889957124e-001, -6.62434416014146e-001, -2.58379383334145e-001, 2.07764456171209e-002, -6.23712691279508e-001, 1.10440995679348e-001, -4.01360206415690e-001, 8.65159275055330e-001 },
 {1.45074093993534e-001, -2.91341502794162e-001, 3.73076174113924e-001, -3.29661262941862e-002, -5.49850343242356e-001, -7.11448142188581e-001, -9.02321490246472e-001, 1.89108031556800e-001, -9.75813401991198e-002, -3.14469399234411e-001, 6.32617231092772e-001, 2.69402744259083e-001, 1.16881696422777e-002, 6.05562892478091e-001, -1.36510453792550e-001, 4.09824427529392e-001, -8.40661347592961e-001 }
};

double AllCases_5_MLP_21_17_2_output_bias[2]={ -3.27599315421272e-001, 2.95316703236558e-001 };

double AllCases_5_MLP_21_17_2_max_input[21]={ 1.00000000000000e+000, 9.96754273526000e-001, 9.96496746661667e-001, 9.94259912350667e-001, 9.95170697016667e-001, 9.91759014152667e-001, 1.40417965636667e+000, 9.86949090259667e-001, 9.63523508705667e-001, 9.76060123067333e-001, 9.73612353747333e-001, 1.00000000000000e+000, 9.98520710059333e-001, 9.91759014152667e-001, 5.10890428384333e+000, 5.48591962498333e+000, 7.03128040914000e+000, 9.53722447143333e-001, 9.99712242127000e-001, 4.98455292063667e+000, 6.87179713731667e+000 };

double AllCases_5_MLP_21_17_2_min_input[21]={ 6.63040123456667e-001, 6.29844600410667e-001, 6.29765554143667e-001, 6.45877037209000e-001, 6.28152633660333e-001, 6.22852030775000e-001, 6.81172839506667e-001, 6.44827956739000e-001, 5.60026336363667e-001, 5.47665803838333e-001, 6.23316498316333e-001, 6.00000000000000e-001, 4.62825497869000e-001, 5.40743607384333e-001, 2.31263859634667e+000, 2.20680752570333e+000, 2.88102976749000e+000, 1.57423810395910e-001, 4.15107119795333e-001, 1.81602018986333e+000, 2.49992751346667e+000 };

double AllCases_5_MLP_21_17_2_input[21];
double AllCases_5_MLP_21_17_2_hidden[17];
double AllCases_5_MLP_21_17_2_output[2];

double AllCases_5_MLP_21_17_2_MeanInputs[21]={ 9.84939075942792e-001, 9.66739246426214e-001, 9.60995020680608e-001, 9.60851594373479e-001, 9.55835633423741e-001, 9.45299925394236e-001, 1.05385645241019e+000, 9.33596196888181e-001, 8.89310791280151e-001, 9.07804480645762e-001, 8.77433025347167e-001, 9.38632247260580e-001, 8.49899779290703e-001, 8.19193452266381e-001, 3.94675980446453e+000, 4.00812379732173e+000, 5.67530205194894e+000, 7.02402154241995e-001, 8.71386826795786e-001, 3.59136358450307e+000, 5.41968270299649e+000 };

void AllCases_5_MLP_21_17_2_FindMax(double* vec, double* max, long* maxIndex,int len)
{
  long i;
  *max = vec[0];
  *maxIndex = 0;
  for(i=1; i<len; i++)
  {
    if(vec[i]>*max)
    {
      *max = vec[i];
      *maxIndex = i;
    }
  }
}

void AllCases_5_MLP_21_17_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(AllCases_5_MLP_21_17_2_max_input[i]-AllCases_5_MLP_21_17_2_min_input[i]);
	input[i] = minimum - delta*AllCases_5_MLP_21_17_2_min_input[i]+ delta*input[i];
 }
}

void AllCases_5_MLP_21_17_2_softmax(double* vec,int len)
{

  long i, j;
  double sum=0.0;
  for(i=0; i<len; i++)
  {
    if(vec[i]>200)
    {
      double max;
      long maxIndex;
      AllCases_5_MLP_21_17_2_FindMax(vec, &max, &maxIndex,len);
      for(j=0; j<len; j++)
      {        if(j==maxIndex) vec[j] = 1.0;
        else vec[j] = 0.0;
      }
      return;
    }
    else
    {
      vec[i] = exp(vec[i]);
    }
    sum += vec[i];
  }
  if(sum==0)
  {
   long a = 1;
  }
  if(sum!=0.0)
  {
    for(i=0; i<len; i++) vec[i] = vec[i]/sum;
  }
  else for(i=0; i<len; i++) vec[i] = 1.0/(double)len;
}

void AllCases_5_MLP_21_17_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==0) V_OUT[row] = exp(V_OUT[row]);
   }
}

void AllCases_5_MLP_21_17_2_RunNeuralNet_Classification () 
{
  AllCases_5_MLP_21_17_2_ComputeFeedForwardSignals((double*)AllCases_5_MLP_21_17_2_input_hidden_weights,AllCases_5_MLP_21_17_2_input,AllCases_5_MLP_21_17_2_hidden,AllCases_5_MLP_21_17_2_hidden_bias,21, 17,0);
  AllCases_5_MLP_21_17_2_ComputeFeedForwardSignals((double*)AllCases_5_MLP_21_17_2_hidden_output_wts,AllCases_5_MLP_21_17_2_hidden,AllCases_5_MLP_21_17_2_output,AllCases_5_MLP_21_17_2_output_bias,17, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-LLLglrlmShortRunEmphasis): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[0]);
	printf("%s","Cont. Input-1(wavelet-LHLglcmIdmn): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-HLHglcmIdmn): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-LLLglcmIdmn): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-LHHglcmIdmn): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-LHHglrlmShortRunEmphasis): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[5]);
	printf("%s","Cont. Input-6(wavelet-LLLglrlmLongRunEmphasis): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-LLHglcmIdmn): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[7]);
	printf("%s","Cont. Input-8(wavelet-LHLglcmIdn): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-HHLglcmIdn): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[9]);
	printf("%s","Cont. Input-10(wavelet-LLHglszmSmallAreaEmphasis): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[10]);
	printf("%s","Cont. Input-11(wavelet-LLLglcmMCC): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[11]);
	printf("%s","Cont. Input-12(wavelet-HHHglrlmShortRunEmphasis): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[12]);
	printf("%s","Cont. Input-13(wavelet-HHLglrlmShortRunEmphasis): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[13]);
	printf("%s","Cont. Input-14(wavelet-LHLglrlmRunEntropy): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[14]);
	printf("%s","Cont. Input-15(wavelet-LHHglrlmRunEntropy): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[15]);
	printf("%s","Cont. Input-16(wavelet-LLHfirstorderEntropy): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[16]);
	printf("%s","Cont. Input-17(wavelet-LHHglszmSmallAreaEmphasis): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[17]);
	printf("%s","Cont. Input-18(wavelet-HLHglcmImc2): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[18]);
	printf("%s","Cont. Input-19(wavelet-LHLfirstorderEntropy): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[19]);
	printf("%s","Cont. Input-20(wavelet-LHLgldmDependenceEntropy): ");
	scanf("%lg",&AllCases_5_MLP_21_17_2_input[20]);
	for(cont_inps=0;cont_inps<21;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(AllCases_5_MLP_21_17_2_input[cont_inps] == -9999)
	  AllCases_5_MLP_21_17_2_input[cont_inps]=AllCases_5_MLP_21_17_2_MeanInputs[cont_inps];
	}
    AllCases_5_MLP_21_17_2_ScaleInputs(AllCases_5_MLP_21_17_2_input,0,1,21);
	AllCases_5_MLP_21_17_2_RunNeuralNet_Classification();
   //Output Activation is Softmax;
	AllCases_5_MLP_21_17_2_softmax(AllCases_5_MLP_21_17_2_output, 2);
	for(i=0;i<2;i++)
	{
      if(max<AllCases_5_MLP_21_17_2_output[i])
      {
        max=AllCases_5_MLP_21_17_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

