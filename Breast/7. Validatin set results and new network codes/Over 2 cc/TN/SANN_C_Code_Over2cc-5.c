//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over2cc_5_RBF_11_16_2_input_hidden_weights[192] =
{
9.51214100372699e-001, 5.07994686289571e-001, 7.99104699778496e-001, 6.09468569651768e-001, 
5.90839907045620e-001, 7.27507907821237e-001, 5.95995098680502e-001, 2.88049474447152e-001, 
6.54588913146312e-001, 5.74042092256086e-001, 7.81417327841204e-001, 9.93509679582614e-001, 
4.67298518773109e-001, 9.49741597491525e-001, 5.81723080794655e-001, 5.98265245967269e-001, 
6.74225126822444e-001, 6.89119362701377e-001, 9.01423520266792e-001, 7.37134882949173e-001, 
0.00000000000000e+000, 8.92223874936016e-001, 9.95403154175710e-001, 6.96513805319995e-001, 
9.06313272984686e-001, 6.62823282746174e-001, 8.61055898148440e-001, 9.04813946529443e-001, 
8.17176625398657e-001, 7.82976721675880e-001, 8.93842348213419e-001, 5.42334041847400e-001, 
1.84730031942251e-001, -9.69438148026694e+000, -1.87110667404945e+001, -4.46421181717017e+000, 
-5.14713895396064e+000, -3.18966806431508e+000, -2.83614235573196e+000, -1.73065389509128e+000, 
-2.69276289677406e+000, -2.04600653266477e+000, -1.45344827624239e+000, -4.40048261236468e-001, 
8.93931583803335e-001, 3.86164267049182e-001, 4.18088680361379e-001, 2.80679985017165e-001, 
1.06971825397689e-001, 3.16437543182357e-001, 2.18634163760002e-001, 5.13913671967973e-001, 
6.00941887242068e-002, 7.61882943400386e-001, 7.62116833737508e-001, 9.22130541146144e-001, 
8.07629764705649e-001, 6.21714387882914e-001, 8.45792329395091e-001, 9.48667668700405e-001, 
8.68762879803827e-001, 6.95314023265851e-001, 1.53645224603851e-001, 8.66143377813658e-001, 
7.64024264724289e-001, 6.51665868008401e-001, 9.99580311071409e-001, 5.11590369254986e-001, 
9.58888732428447e-001, 6.28632807389987e-001, 4.42783121357582e-001, 4.56387867197174e-001, 
7.81427074021605e-001, 6.81109490248889e-001, 5.75688780590915e-001, 8.41732143820638e-001, 
6.69930777139429e-001, 9.36080442689237e-001, 8.27853587865423e-001, 6.91814926291277e-001, 
9.20983977651421e-001, 9.55467732688149e-001, 8.96804145571065e-001, 6.34317716275679e-001, 
5.34031048992257e-001, 8.86403544564651e-001, 6.05026428628393e-001, 8.44384461824461e-001, 
2.49155621954611e-001, 9.55786389527077e-001, 7.71524198390957e-001, 9.26581370732940e-001, 
7.38858788158755e-001, 8.35677561060930e-001, 6.73484586747030e-001, 2.64215841368929e-001, 
6.12589852671169e-001, 8.36463079299268e-001, 0.00000000000000e+000, 9.95892018500097e-001, 
6.08159206638227e-001, 8.35453033738807e-001, 3.83980844232622e-001, 5.07854944314646e-001, 
5.81667544803675e-001, 7.30014976862519e-001, 3.13474034099968e-001, 5.11803453222913e-001, 
9.79915296054487e-001, 6.34004474675198e-001, 9.97698343875966e-001, 4.34624907806491e-001, 
6.68821002065303e-001, 7.16409054566483e-001, 6.09633288615368e-001, 6.86656021420434e-001, 
6.80013849235898e-001, 2.66698717790079e-001, 6.77028505532847e-001, 1.00000000000000e+000, 
8.78481337006727e-001, 9.82057284607894e-001, 5.20131364107719e-001, 6.16050904717879e-001, 
4.46880606840224e-001, 5.86370226507298e-001, 7.25275238299410e-001, 5.54503957879083e-001, 
0.00000000000000e+000, 6.32893822253879e-001, 6.53418410814489e-001, 6.59256641221576e-001, 
9.57875917815585e-001, 6.00732144930276e-001, 8.01096571023741e-001, 8.10960487600865e-001, 
7.90285107535964e-001, 8.29456565134957e-001, 3.92410018380920e-001, 6.81317996178795e-001, 
8.35562552607675e-001, 6.30294254989164e-001, 6.46652884505085e-001, 9.99629194080221e-001, 
5.82409028530932e-001, 9.62282553534314e-001, 6.12946171868255e-001, 8.56741600956592e-001, 
8.21024272639696e-001, 8.96407760286430e-001, 9.01404431227349e-001, 9.07098815412779e-001, 
3.03894163779309e-001, 4.40225340932956e-001, 9.74041855961167e-001, 5.78286619883972e-001, 
5.39356500464278e-001, 7.62014187020392e-001, 6.95825962348406e-001, 7.80545913642007e-001, 
5.14580313543099e-001, 2.04960753605534e-002, 7.28333031078384e-001, 8.35365710283535e-001, 
8.35284132792487e-001, 9.89040016577913e-001, 6.80143471381445e-001, 9.06761022917185e-001, 
7.42047165349014e-001, 6.40198849022553e-001, 5.41638087894316e-001, 3.14448314820454e-001, 
7.96904781378373e-001, 7.21904240291264e-001, 2.82218440888270e-001, 7.49046277117913e-001, 
4.09213423684044e-001, 5.86424291655143e-001, 4.10252636898459e-001, 2.39956731306310e+001, 
1.02238667374166e+000, 4.72492532416602e-001, 5.16357520118193e-001, 4.72492532416602e-001, 
1.02753950854526e+000, 5.16357520118193e-001, 4.19368917660800e-001, 4.09213423684044e-001, 
4.80064225236246e-001, 4.10252636898459e-001, 4.19368917660800e-001, 5.40883043124861e-001 
};

double Over2cc_5_RBF_11_16_2_hidden_output_wts[2][16]=
{
 {5.34127700443946e-001, 6.25616561488419e-001, -1.48219467285994e+000, 2.10763355358310e-002, -3.45052281561599e-002, -9.49076093163483e+000, 9.67966881471681e+000, -1.72471914795262e+001, 1.34100254952997e-001, 1.26402854738154e+001, -3.78990133792552e+000, -1.75589378245561e+000, 2.85974132436297e+001, -6.06382327584394e-001, 3.14657429577736e+000, 1.03822307480934e+001 },
 {-4.14198753957492e-001, -8.12407208704672e-001, 1.56996042695135e+000, 1.76795239426159e-001, 1.00429001362978e-001, 9.64100876525920e+000, -9.85918078165439e+000, 1.72433864542637e+001, 4.35254265824470e-002, -1.23900736304426e+001, 3.88169378574046e+000, 1.78891526225526e+000, -2.84817056784072e+001, 7.06307225801572e-001, -2.97020404933826e+000, -1.04094350335832e+001 }
};

double Over2cc_5_RBF_11_16_2_output_bias[2]={ 1.03706216915615e+000, -9.14175649923445e-001 };

double Over2cc_5_RBF_11_16_2_radial_centers[16][11]=
{
 {9.51214100372699e-001, 5.07994686289571e-001, 7.99104699778496e-001, 6.09468569651768e-001, 5.90839907045620e-001, 7.27507907821237e-001, 5.95995098680502e-001, 2.88049474447152e-001, 6.54588913146312e-001, 5.74042092256086e-001, 7.81417327841204e-001 },
 {9.93509679582614e-001, 4.67298518773109e-001, 9.49741597491525e-001, 5.81723080794655e-001, 5.98265245967269e-001, 6.74225126822444e-001, 6.89119362701377e-001, 9.01423520266792e-001, 7.37134882949173e-001, 0.00000000000000e+000, 8.92223874936016e-001 },
 {9.95403154175710e-001, 6.96513805319995e-001, 9.06313272984686e-001, 6.62823282746174e-001, 8.61055898148440e-001, 9.04813946529443e-001, 8.17176625398657e-001, 7.82976721675880e-001, 8.93842348213419e-001, 5.42334041847400e-001, 1.84730031942251e-001 },
 {-9.69438148026694e+000, -1.87110667404945e+001, -4.46421181717017e+000, -5.14713895396064e+000, -3.18966806431508e+000, -2.83614235573196e+000, -1.73065389509128e+000, -2.69276289677406e+000, -2.04600653266477e+000, -1.45344827624239e+000, -4.40048261236468e-001 },
 {8.93931583803335e-001, 3.86164267049182e-001, 4.18088680361379e-001, 2.80679985017165e-001, 1.06971825397689e-001, 3.16437543182357e-001, 2.18634163760002e-001, 5.13913671967973e-001, 6.00941887242068e-002, 7.61882943400386e-001, 7.62116833737508e-001 },
 {9.22130541146144e-001, 8.07629764705649e-001, 6.21714387882914e-001, 8.45792329395091e-001, 9.48667668700405e-001, 8.68762879803827e-001, 6.95314023265851e-001, 1.53645224603851e-001, 8.66143377813658e-001, 7.64024264724289e-001, 6.51665868008401e-001 },
 {9.99580311071409e-001, 5.11590369254986e-001, 9.58888732428447e-001, 6.28632807389987e-001, 4.42783121357582e-001, 4.56387867197174e-001, 7.81427074021605e-001, 6.81109490248889e-001, 5.75688780590915e-001, 8.41732143820638e-001, 6.69930777139429e-001 },
 {9.36080442689237e-001, 8.27853587865423e-001, 6.91814926291277e-001, 9.20983977651421e-001, 9.55467732688149e-001, 8.96804145571065e-001, 6.34317716275679e-001, 5.34031048992257e-001, 8.86403544564651e-001, 6.05026428628393e-001, 8.44384461824461e-001 },
 {2.49155621954611e-001, 9.55786389527077e-001, 7.71524198390957e-001, 9.26581370732940e-001, 7.38858788158755e-001, 8.35677561060930e-001, 6.73484586747030e-001, 2.64215841368929e-001, 6.12589852671169e-001, 8.36463079299268e-001, 0.00000000000000e+000 },
 {9.95892018500097e-001, 6.08159206638227e-001, 8.35453033738807e-001, 3.83980844232622e-001, 5.07854944314646e-001, 5.81667544803675e-001, 7.30014976862519e-001, 3.13474034099968e-001, 5.11803453222913e-001, 9.79915296054487e-001, 6.34004474675198e-001 },
 {9.97698343875966e-001, 4.34624907806491e-001, 6.68821002065303e-001, 7.16409054566483e-001, 6.09633288615368e-001, 6.86656021420434e-001, 6.80013849235898e-001, 2.66698717790079e-001, 6.77028505532847e-001, 1.00000000000000e+000, 8.78481337006727e-001 },
 {9.82057284607894e-001, 5.20131364107719e-001, 6.16050904717879e-001, 4.46880606840224e-001, 5.86370226507298e-001, 7.25275238299410e-001, 5.54503957879083e-001, 0.00000000000000e+000, 6.32893822253879e-001, 6.53418410814489e-001, 6.59256641221576e-001 },
 {9.57875917815585e-001, 6.00732144930276e-001, 8.01096571023741e-001, 8.10960487600865e-001, 7.90285107535964e-001, 8.29456565134957e-001, 3.92410018380920e-001, 6.81317996178795e-001, 8.35562552607675e-001, 6.30294254989164e-001, 6.46652884505085e-001 },
 {9.99629194080221e-001, 5.82409028530932e-001, 9.62282553534314e-001, 6.12946171868255e-001, 8.56741600956592e-001, 8.21024272639696e-001, 8.96407760286430e-001, 9.01404431227349e-001, 9.07098815412779e-001, 3.03894163779309e-001, 4.40225340932956e-001 },
 {9.74041855961167e-001, 5.78286619883972e-001, 5.39356500464278e-001, 7.62014187020392e-001, 6.95825962348406e-001, 7.80545913642007e-001, 5.14580313543099e-001, 2.04960753605534e-002, 7.28333031078384e-001, 8.35365710283535e-001, 8.35284132792487e-001 },
 {9.89040016577913e-001, 6.80143471381445e-001, 9.06761022917185e-001, 7.42047165349014e-001, 6.40198849022553e-001, 5.41638087894316e-001, 3.14448314820454e-001, 7.96904781378373e-001, 7.21904240291264e-001, 2.82218440888270e-001, 7.49046277117913e-001 } 
};

double Over2cc_5_RBF_11_16_2_Vector_SigmasInv2[16]={ -2.98586563841152e+000, -1.45393871336579e+000, -2.97075777219444e+000, -8.68368637135613e-004, -4.78343243720436e-001, -2.23964975127901e+000, -1.87529239149256e+000, -2.23964975127901e+000, -4.73557746950289e-001, -1.87529239149256e+000, -2.84300436735921e+000, -2.98586563841152e+000, -2.16955826507982e+000, -2.97075777219444e+000, -2.84300436735921e+000, -1.70908346146695e+000 };

double Over2cc_5_RBF_11_16_2_normalizer[16]={ -2.79621017101622e-001, -4.23749511896467e+000, -3.07520528836138e-001, -4.50649326718280e+001, -1.03518613381755e+001, -1.86125716284208e+000, -2.83780913050314e+000, -1.86125716284208e+000, -1.04071621609176e+001, -2.83780913050314e+000, -5.49276843509089e-001, -2.79621017101622e-001, -2.03613466924002e+000, -3.07520528836138e-001, -5.49276843509089e-001, -3.34824955560385e+000 };

double Over2cc_5_RBF_11_16_2_NormSqd(double* data,long length,int centerid)
{
  double sum = 0.0;
  long i;
	for(i=0; i<length; i++) {sum += (*(data+(centerid*length)+i)) * (*(data+(centerid*length)+i));}
  return sum;
}

void Over2cc_5_RBF_11_16_2_ComputeActivations(double* in,double* hid)
{
  double diff2;
  long i,j;
 	for(i=0; i<16; i++)
  {
    diff2=0.0;
    for(j=0;j<11; j++)
       diff2+=(Over2cc_5_RBF_11_16_2_radial_centers[i][j]-in[j])*(Over2cc_5_RBF_11_16_2_radial_centers[i][j]-in[j]);
    hid[i] = exp(Over2cc_5_RBF_11_16_2_normalizer[i] + diff2*Over2cc_5_RBF_11_16_2_Vector_SigmasInv2[i]);
  }
}

double Over2cc_5_RBF_11_16_2_max_input[11]={ 9.99958329432000e-001, 9.94505657234667e-001, 9.81000941145667e-001, 9.77249757356000e-001, 7.56346456271333e+000, 6.80611365125667e+000, 6.08511856610667e+000, 9.76903355877333e-001, 7.09083526106000e+000, 4.97958375536000e-001, 8.06335210109333e-001 };

double Over2cc_5_RBF_11_16_2_min_input[11]={ 9.07570890327000e-001, 9.44650005130667e-001, 8.06267137025000e-001, 8.22841769254000e-001, 5.86068628775333e+000, 5.13742515665000e+000, 4.01210318245333e+000, 7.31203984050667e-001, 4.93424538709667e+000, 3.13060595095333e-001, 3.12766281606667e-001 };

double Over2cc_5_RBF_11_16_2_input[11];
double Over2cc_5_RBF_11_16_2_hidden[16];
double Over2cc_5_RBF_11_16_2_output[2];

double Over2cc_5_RBF_11_16_2_MeanInputs[11]={ 9.95162114251585e-001, 9.73127748552063e-001, 9.40878102187135e-001, 9.25104787935739e-001, 6.80160489106444e+000, 6.13033404751014e+000, 5.15109253864092e+000, 8.47882026592947e-001, 6.21245045143614e+000, 4.40009626845691e-001, 6.49807676291053e-001 };

void Over2cc_5_RBF_11_16_2_FindMax(double* vec, double* max, long* maxIndex,int len)
{
  long i;
  *max = vec[0];
  *maxIndex = 0;
  for(i=1; i<len; i++)
  {
    if(vec[i]>*max)
    {
      *max = vec[i];
      *maxIndex = i;
    }
  }
}

void Over2cc_5_RBF_11_16_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over2cc_5_RBF_11_16_2_max_input[i]-Over2cc_5_RBF_11_16_2_min_input[i]);
	input[i] = minimum - delta*Over2cc_5_RBF_11_16_2_min_input[i]+ delta*input[i];
 }
}

void Over2cc_5_RBF_11_16_2_softmax(double* vec,int len)
{

  long i, j;
  double sum=0.0;
  for(i=0; i<len; i++)
  {
    if(vec[i]>200)
    {
      double max;
      long maxIndex;
      Over2cc_5_RBF_11_16_2_FindMax(vec, &max, &maxIndex,len);
      for(j=0; j<len; j++)
      {        if(j==maxIndex) vec[j] = 1.0;
        else vec[j] = 0.0;
      }
      return;
    }
    else
    {
      vec[i] = exp(vec[i]);
    }
    sum += vec[i];
  }
  if(sum==0)
  {
   long a = 1;
  }
  if(sum!=0.0)
  {
    for(i=0; i<len; i++) vec[i] = vec[i]/sum;
  }
  else for(i=0; i<len; i++) vec[i] = 1.0/(double)len;
}

void Over2cc_5_RBF_11_16_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
   }
}

void Over2cc_5_RBF_11_16_2_RunNeuralNet_Classification () 
{
  Over2cc_5_RBF_11_16_2_ComputeActivations(Over2cc_5_RBF_11_16_2_input,Over2cc_5_RBF_11_16_2_hidden);
  Over2cc_5_RBF_11_16_2_ComputeFeedForwardSignals((double*)Over2cc_5_RBF_11_16_2_hidden_output_wts,Over2cc_5_RBF_11_16_2_hidden,Over2cc_5_RBF_11_16_2_output,Over2cc_5_RBF_11_16_2_output_bias,16, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-LLLglcmImc2): ");
	scanf("%lg",&Over2cc_5_RBF_11_16_2_input[0]);
	printf("%s","Cont. Input-1(originalglcmIdmn): ");
	scanf("%lg",&Over2cc_5_RBF_11_16_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-LHHglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_5_RBF_11_16_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-HHHglcmIdn): ");
	scanf("%lg",&Over2cc_5_RBF_11_16_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-LLHglszmZoneEntropy): ");
	scanf("%lg",&Over2cc_5_RBF_11_16_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-HLLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_5_RBF_11_16_2_input[5]);
	printf("%s","Cont. Input-6(originalglrlmRunEntropy): ");
	scanf("%lg",&Over2cc_5_RBF_11_16_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-HHHglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_5_RBF_11_16_2_input[7]);
	printf("%s","Cont. Input-8(wavelet-LLHglcmSumEntropy): ");
	scanf("%lg",&Over2cc_5_RBF_11_16_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-HHLglcmInverseVariance): ");
	scanf("%lg",&Over2cc_5_RBF_11_16_2_input[9]);
	printf("%s","Cont. Input-10(originalshapeSphericity): ");
	scanf("%lg",&Over2cc_5_RBF_11_16_2_input[10]);
	for(cont_inps=0;cont_inps<11;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over2cc_5_RBF_11_16_2_input[cont_inps] == -9999)
	  Over2cc_5_RBF_11_16_2_input[cont_inps]=Over2cc_5_RBF_11_16_2_MeanInputs[cont_inps];
	}
    Over2cc_5_RBF_11_16_2_ScaleInputs(Over2cc_5_RBF_11_16_2_input,0,1,11);
	Over2cc_5_RBF_11_16_2_RunNeuralNet_Classification();
   //Output Activation is Softmax;
	Over2cc_5_RBF_11_16_2_softmax(Over2cc_5_RBF_11_16_2_output, 2);
	for(i=0;i<2;i++)
	{
      if(max<Over2cc_5_RBF_11_16_2_output[i])
      {
        max=Over2cc_5_RBF_11_16_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

