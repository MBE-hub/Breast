//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over2cc_1_RBF_11_18_2_input_hidden_weights[216] =
{
9.97176910398283e-001, 4.91860121887751e-001, 6.34861056839695e-001, 4.44102970752403e-001, 
6.01249694380037e-001, 2.99054228563070e-001, 5.84254624733588e-001, 7.73963643820332e-002, 
4.46604615712099e-001, 8.45168673039570e-001, 9.08940294352240e-001, 9.57875917815585e-001, 
6.00732144930276e-001, 8.01096571023741e-001, 8.10960487600865e-001, 7.90285107535964e-001, 
8.29456565134957e-001, 3.92410018380920e-001, 6.81317996178795e-001, 8.35562552607675e-001, 
6.30294254989164e-001, 6.46652884505085e-001, 8.08406044651273e-001, 7.52573518720254e-001, 
6.91335529694713e-001, 9.60445319422429e-001, 7.72850163552610e-001, 8.03331966630862e-001, 
4.52970480842170e-001, 3.89605841069054e-001, 7.71986598879999e-001, 8.12682362212306e-001, 
6.08270730629494e-001, 8.97755625077297e-001, 8.37505109669404e-001, 9.05479932832031e-001, 
8.42868741825459e-001, 9.49572846021101e-001, 9.66551460509017e-001, 9.79346376588608e-001, 
6.88015837010725e-001, 9.63429006198388e-001, 6.48783230206637e-001, 9.68066162618564e-002, 
9.73602922969919e-001, 9.24348681165934e-001, 8.64966146472116e-001, 8.30169982710497e-001, 
8.46754999555381e-001, 8.45116574644097e-001, 7.11914333966884e-001, 7.24565935221810e-001, 
9.10554260434246e-001, 7.07285967365262e-001, 4.83173603354933e-001, -9.69376192276563e+000, 
-1.87044619079669e+001, -4.45512098360047e+000, -5.13235946253560e+000, -3.40458337393044e+000, 
-3.03890293628867e+000, -1.89572515248298e+000, -2.64054746555389e+000, -2.24880990709984e+000, 
-1.15003967853598e+000, -3.37596889642668e-001, 9.89847182999984e-001, 5.41403148480754e-001, 
7.62702134121496e-001, 4.69827527660535e-001, 4.30908751421107e-001, 4.22804768697289e-001, 
4.01791480150743e-001, 2.90256065619808e-001, 5.57979146117635e-001, 7.85974410168584e-001, 
6.47871285929092e-001, 7.63252032701745e-001, 8.45272141242720e-001, 7.44098743203378e-001, 
9.07031042220536e-001, 8.91414108576364e-001, 9.16895598154952e-001, 6.16410481584583e-001, 
4.81827843667356e-001, 8.84542147443299e-001, 7.70383984070464e-001, 5.29803336363357e-001, 
9.59721746068706e-001, 8.10384199897474e-001, 8.25799270828863e-001, 6.70795694908685e-001, 
4.78855200474739e-001, 4.77703413191306e-001, 4.18097770227775e-001, 1.92901805679434e-001, 
5.85814817754331e-001, 8.95259639262059e-001, 7.58239977956077e-001, 9.99996574018398e-001, 
2.54544609081851e-001, 9.26907485814745e-001, 3.35536981684145e-001, 2.26623663476717e-001, 
2.57032863586941e-001, 7.31496961384949e-001, 4.11374671093196e-001, 3.92995037498296e-001, 
8.95198263807436e-001, 9.42537020122584e-001, 9.93116880243747e-001, 7.97858920837225e-001, 
8.99436919909333e-001, 8.33908506712800e-001, 5.68173116136370e-001, 6.40969256618972e-001, 
6.95664431520928e-001, 7.69630729502784e-001, 6.39644031773279e-001, 5.20210906221231e-001, 
4.74601890668653e-001, 9.91964587529159e-001, 7.43034535664240e-001, 8.46023007928753e-001, 
7.16623863181035e-001, 5.32267261397431e-001, 7.07492679094436e-001, 6.09229834289803e-001, 
2.82690669065554e-001, 6.58427685436745e-001, 6.88238874072561e-001, 8.12044353449412e-001, 
8.93931583803335e-001, 3.86164267049182e-001, 4.18088680361379e-001, 2.80679985017165e-001, 
1.06971825397689e-001, 3.16437543182357e-001, 2.18634163760002e-001, 5.13913671967973e-001, 
6.00941887242068e-002, 7.61882943400386e-001, 7.62116833737508e-001, 9.50624450071089e-001, 
3.62778401078199e-001, 6.38623102388397e-001, 5.86191725203201e-001, 7.56009662953274e-001, 
6.65432658331518e-001, 4.17487361171811e-001, 1.01481464311286e-002, 7.36440092674912e-001, 
7.69778979948366e-001, 7.67800543731525e-001, 9.99580311071409e-001, 5.11590369254986e-001, 
9.58888732428447e-001, 6.28632807389987e-001, 4.42783121357582e-001, 4.56387867197174e-001, 
7.81427074021605e-001, 6.81109490248889e-001, 5.75688780590915e-001, 8.41732143820638e-001, 
6.69930777139429e-001, 9.89749307584368e-001, 4.32717762899397e-001, 6.92639880405863e-001, 
8.28821309595244e-001, 5.86052633088774e-001, 8.24381502049562e-001, 5.77786504241543e-001, 
4.96160927251649e-001, 6.36588859396951e-001, 6.98337073880855e-001, 9.18374065666530e-001, 
9.80007957680977e-001, 2.66256904171591e-001, 7.99470991191438e-001, 6.46238189463037e-001, 
4.14368883637091e-001, 4.79407682028294e-001, 3.15611150773824e-001, 4.81075157554953e-001, 
5.07133963227815e-001, 5.88560850393341e-001, 8.68773910526562e-001, 9.91421135044495e-001, 
3.56409018164420e-001, 8.85263290453583e-001, 6.30108469051888e-001, 2.05147768845519e-001, 
2.42459697425653e-001, 3.70133604264164e-001, 3.39500378311292e-001, 3.99558232621402e-001, 
7.88774436774814e-001, 5.26138857370551e-001, 4.75931600935577e-001, 4.56421716368189e-001, 
3.14731054172688e-001, 5.18429117375904e-001, 3.91201866976213e-001, 2.40376112910527e+001, 
3.96968015262272e-001, 3.14731054172688e-001, 3.96968015262272e-001, 6.48178998161078e-001, 
4.97618787599862e-001, 3.99198442030133e-001, 7.68680609267668e-001, 5.82373310480076e-001, 
5.81607965332106e-001, 4.55428447345689e-001, 4.95930120443156e-001, 4.49199201200984e-001 
};

double Over2cc_1_RBF_11_18_2_hidden_output_wts[2][18]=
{
 {9.18766315916860e-002, 1.47914173571095e-002, 2.14139805279889e-001, 8.63621903555793e-002, -1.00908779107868e-002, 1.16083993291444e-001, 2.71154898648757e-001, -1.72747870789813e-001, 1.29769328897532e-001, -2.62531359235516e-002, -8.23581558066367e-002, -1.70898933940339e-002, -2.76944737188070e-002, 7.61548757046036e-002, -5.03311724498983e-002, -1.50461649384685e-002, 9.27298901941237e-002, 5.70502514755895e-002 },
 {-1.10612885691136e-001, -3.18717850542531e-002, -1.77651353687162e-001, -1.05511063303491e-001, 1.23295268523631e-001, 6.18059016015102e-002, -1.59659285818063e-001, 1.55207826492085e-001, -1.31265390629468e-001, 7.59942383653900e-002, -2.91485166495841e-003, -6.70629481578278e-002, -7.53631711560227e-002, 1.44612309815836e-001, -1.51870520690716e-001, -2.53370535794685e-002, -3.50884330777780e-002, -3.68233076665025e-001 }
};

double Over2cc_1_RBF_11_18_2_output_bias[2]={ 6.66897257007747e-001, -6.67353187960236e-001 };

double Over2cc_1_RBF_11_18_2_radial_centers[18][11]=
{
 {9.97176910398283e-001, 4.91860121887751e-001, 6.34861056839695e-001, 4.44102970752403e-001, 6.01249694380037e-001, 2.99054228563070e-001, 5.84254624733588e-001, 7.73963643820332e-002, 4.46604615712099e-001, 8.45168673039570e-001, 9.08940294352240e-001 },
 {9.57875917815585e-001, 6.00732144930276e-001, 8.01096571023741e-001, 8.10960487600865e-001, 7.90285107535964e-001, 8.29456565134957e-001, 3.92410018380920e-001, 6.81317996178795e-001, 8.35562552607675e-001, 6.30294254989164e-001, 6.46652884505085e-001 },
 {8.08406044651273e-001, 7.52573518720254e-001, 6.91335529694713e-001, 9.60445319422429e-001, 7.72850163552610e-001, 8.03331966630862e-001, 4.52970480842170e-001, 3.89605841069054e-001, 7.71986598879999e-001, 8.12682362212306e-001, 6.08270730629494e-001 },
 {8.97755625077297e-001, 8.37505109669404e-001, 9.05479932832031e-001, 8.42868741825459e-001, 9.49572846021101e-001, 9.66551460509017e-001, 9.79346376588608e-001, 6.88015837010725e-001, 9.63429006198388e-001, 6.48783230206637e-001, 9.68066162618564e-002 },
 {9.73602922969919e-001, 9.24348681165934e-001, 8.64966146472116e-001, 8.30169982710497e-001, 8.46754999555381e-001, 8.45116574644097e-001, 7.11914333966884e-001, 7.24565935221810e-001, 9.10554260434246e-001, 7.07285967365262e-001, 4.83173603354933e-001 },
 {-9.69376192276563e+000, -1.87044619079669e+001, -4.45512098360047e+000, -5.13235946253560e+000, -3.40458337393044e+000, -3.03890293628867e+000, -1.89572515248298e+000, -2.64054746555389e+000, -2.24880990709984e+000, -1.15003967853598e+000, -3.37596889642668e-001 },
 {9.89847182999984e-001, 5.41403148480754e-001, 7.62702134121496e-001, 4.69827527660535e-001, 4.30908751421107e-001, 4.22804768697289e-001, 4.01791480150743e-001, 2.90256065619808e-001, 5.57979146117635e-001, 7.85974410168584e-001, 6.47871285929092e-001 },
 {7.63252032701745e-001, 8.45272141242720e-001, 7.44098743203378e-001, 9.07031042220536e-001, 8.91414108576364e-001, 9.16895598154952e-001, 6.16410481584583e-001, 4.81827843667356e-001, 8.84542147443299e-001, 7.70383984070464e-001, 5.29803336363357e-001 },
 {9.59721746068706e-001, 8.10384199897474e-001, 8.25799270828863e-001, 6.70795694908685e-001, 4.78855200474739e-001, 4.77703413191306e-001, 4.18097770227775e-001, 1.92901805679434e-001, 5.85814817754331e-001, 8.95259639262059e-001, 7.58239977956077e-001 },
 {9.99996574018398e-001, 2.54544609081851e-001, 9.26907485814745e-001, 3.35536981684145e-001, 2.26623663476717e-001, 2.57032863586941e-001, 7.31496961384949e-001, 4.11374671093196e-001, 3.92995037498296e-001, 8.95198263807436e-001, 9.42537020122584e-001 },
 {9.93116880243747e-001, 7.97858920837225e-001, 8.99436919909333e-001, 8.33908506712800e-001, 5.68173116136370e-001, 6.40969256618972e-001, 6.95664431520928e-001, 7.69630729502784e-001, 6.39644031773279e-001, 5.20210906221231e-001, 4.74601890668653e-001 },
 {9.91964587529159e-001, 7.43034535664240e-001, 8.46023007928753e-001, 7.16623863181035e-001, 5.32267261397431e-001, 7.07492679094436e-001, 6.09229834289803e-001, 2.82690669065554e-001, 6.58427685436745e-001, 6.88238874072561e-001, 8.12044353449412e-001 },
 {8.93931583803335e-001, 3.86164267049182e-001, 4.18088680361379e-001, 2.80679985017165e-001, 1.06971825397689e-001, 3.16437543182357e-001, 2.18634163760002e-001, 5.13913671967973e-001, 6.00941887242068e-002, 7.61882943400386e-001, 7.62116833737508e-001 },
 {9.50624450071089e-001, 3.62778401078199e-001, 6.38623102388397e-001, 5.86191725203201e-001, 7.56009662953274e-001, 6.65432658331518e-001, 4.17487361171811e-001, 1.01481464311286e-002, 7.36440092674912e-001, 7.69778979948366e-001, 7.67800543731525e-001 },
 {9.99580311071409e-001, 5.11590369254986e-001, 9.58888732428447e-001, 6.28632807389987e-001, 4.42783121357582e-001, 4.56387867197174e-001, 7.81427074021605e-001, 6.81109490248889e-001, 5.75688780590915e-001, 8.41732143820638e-001, 6.69930777139429e-001 },
 {9.89749307584368e-001, 4.32717762899397e-001, 6.92639880405863e-001, 8.28821309595244e-001, 5.86052633088774e-001, 8.24381502049562e-001, 5.77786504241543e-001, 4.96160927251649e-001, 6.36588859396951e-001, 6.98337073880855e-001, 9.18374065666530e-001 },
 {9.80007957680977e-001, 2.66256904171591e-001, 7.99470991191438e-001, 6.46238189463037e-001, 4.14368883637091e-001, 4.79407682028294e-001, 3.15611150773824e-001, 4.81075157554953e-001, 5.07133963227815e-001, 5.88560850393341e-001, 8.68773910526562e-001 },
 {9.91421135044495e-001, 3.56409018164420e-001, 8.85263290453583e-001, 6.30108469051888e-001, 2.05147768845519e-001, 2.42459697425653e-001, 3.70133604264164e-001, 3.39500378311292e-001, 3.99558232621402e-001, 7.88774436774814e-001, 5.26138857370551e-001 } 
};

double Over2cc_1_RBF_11_18_2_Vector_SigmasInv2[18]={ -2.20739940016608e+000, -2.40014458656300e+000, -5.04766833938440e+000, -1.86033532722019e+000, -3.26714317489944e+000, -8.65341213660581e-004, -3.17291890582000e+000, -5.04766833938440e+000, -3.17291890582000e+000, -1.19009078904643e+000, -2.01918665263532e+000, -3.13756209031900e+000, -8.46209999385918e-001, -1.47423622085737e+000, -1.47811870520278e+000, -2.41062521845198e+000, -2.03296092929847e+000, -2.47794723158296e+000 };

double Over2cc_1_RBF_11_18_2_normalizer[18]={ -1.94103142876662e+000, -1.48060498249741e+000, 2.60808094712855e+000, -2.88185222006789e+000, 2.15523387136588e-001, -4.50841410140189e+001, 5.45713786861934e-002, 2.60808094712855e+000, 5.45713786861934e-002, -5.33885158575761e+000, -2.43119306501735e+000, -7.06085514173002e-003, -7.21444685391982e+000, -4.16124415596145e+000, -4.14677863488157e+000, -1.45664059886577e+000, -2.39380113300492e+000, -1.30514668696304e+000 };

double Over2cc_1_RBF_11_18_2_NormSqd(double* data,long length,int centerid)
{
  double sum = 0.0;
  long i;
	for(i=0; i<length; i++) {sum += (*(data+(centerid*length)+i)) * (*(data+(centerid*length)+i));}
  return sum;
}

void Over2cc_1_RBF_11_18_2_ComputeActivations(double* in,double* hid)
{
  double diff2;
  long i,j;
 	for(i=0; i<18; i++)
  {
    diff2=0.0;
    for(j=0;j<11; j++)
       diff2+=(Over2cc_1_RBF_11_18_2_radial_centers[i][j]-in[j])*(Over2cc_1_RBF_11_18_2_radial_centers[i][j]-in[j]);
    hid[i] = exp(Over2cc_1_RBF_11_18_2_normalizer[i] + diff2*Over2cc_1_RBF_11_18_2_Vector_SigmasInv2[i]);
  }
}

double Over2cc_1_RBF_11_18_2_max_input[11]={ 9.99958329432000e-001, 9.94505657234667e-001, 9.81000941145667e-001, 9.77249757356000e-001, 7.56346456271333e+000, 6.80611365125667e+000, 6.08511856610667e+000, 9.76903355877333e-001, 7.09083526106000e+000, 4.97958375536000e-001, 8.06335210109333e-001 };

double Over2cc_1_RBF_11_18_2_min_input[11]={ 9.07570890327000e-001, 9.44650005130667e-001, 8.06267137025000e-001, 8.22841769254000e-001, 5.86068628775333e+000, 5.13742515665000e+000, 4.01210318245333e+000, 7.31203984050667e-001, 4.93424538709667e+000, 3.13060595095333e-001, 3.12766281606667e-001 };

double Over2cc_1_RBF_11_18_2_input[11];
double Over2cc_1_RBF_11_18_2_hidden[18];
double Over2cc_1_RBF_11_18_2_output[2];

double Over2cc_1_RBF_11_18_2_MeanInputs[11]={ 9.95162114251585e-001, 9.73127748552063e-001, 9.40878102187135e-001, 9.25104787935739e-001, 6.80160489106444e+000, 6.13033404751014e+000, 5.15109253864092e+000, 8.47882026592947e-001, 6.21245045143614e+000, 4.40009626845691e-001, 6.49807676291053e-001 };

void Over2cc_1_RBF_11_18_2_FindMax(double* vec, double* max, long* maxIndex,int len)
{
  long i;
  *max = vec[0];
  *maxIndex = 0;
  for(i=1; i<len; i++)
  {
    if(vec[i]>*max)
    {
      *max = vec[i];
      *maxIndex = i;
    }
  }
}

void Over2cc_1_RBF_11_18_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over2cc_1_RBF_11_18_2_max_input[i]-Over2cc_1_RBF_11_18_2_min_input[i]);
	input[i] = minimum - delta*Over2cc_1_RBF_11_18_2_min_input[i]+ delta*input[i];
 }
}

void Over2cc_1_RBF_11_18_2_softmax(double* vec,int len)
{

  long i, j;
  double sum=0.0;
  for(i=0; i<len; i++)
  {
    if(vec[i]>200)
    {
      double max;
      long maxIndex;
      Over2cc_1_RBF_11_18_2_FindMax(vec, &max, &maxIndex,len);
      for(j=0; j<len; j++)
      {        if(j==maxIndex) vec[j] = 1.0;
        else vec[j] = 0.0;
      }
      return;
    }
    else
    {
      vec[i] = exp(vec[i]);
    }
    sum += vec[i];
  }
  if(sum==0)
  {
   long a = 1;
  }
  if(sum!=0.0)
  {
    for(i=0; i<len; i++) vec[i] = vec[i]/sum;
  }
  else for(i=0; i<len; i++) vec[i] = 1.0/(double)len;
}

void Over2cc_1_RBF_11_18_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
   }
}

void Over2cc_1_RBF_11_18_2_RunNeuralNet_Classification () 
{
  Over2cc_1_RBF_11_18_2_ComputeActivations(Over2cc_1_RBF_11_18_2_input,Over2cc_1_RBF_11_18_2_hidden);
  Over2cc_1_RBF_11_18_2_ComputeFeedForwardSignals((double*)Over2cc_1_RBF_11_18_2_hidden_output_wts,Over2cc_1_RBF_11_18_2_hidden,Over2cc_1_RBF_11_18_2_output,Over2cc_1_RBF_11_18_2_output_bias,18, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-LLLglcmImc2): ");
	scanf("%lg",&Over2cc_1_RBF_11_18_2_input[0]);
	printf("%s","Cont. Input-1(originalglcmIdmn): ");
	scanf("%lg",&Over2cc_1_RBF_11_18_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-LHHglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_1_RBF_11_18_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-HHHglcmIdn): ");
	scanf("%lg",&Over2cc_1_RBF_11_18_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-LLHglszmZoneEntropy): ");
	scanf("%lg",&Over2cc_1_RBF_11_18_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-HLLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_1_RBF_11_18_2_input[5]);
	printf("%s","Cont. Input-6(originalglrlmRunEntropy): ");
	scanf("%lg",&Over2cc_1_RBF_11_18_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-HHHglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_1_RBF_11_18_2_input[7]);
	printf("%s","Cont. Input-8(wavelet-LLHglcmSumEntropy): ");
	scanf("%lg",&Over2cc_1_RBF_11_18_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-HHLglcmInverseVariance): ");
	scanf("%lg",&Over2cc_1_RBF_11_18_2_input[9]);
	printf("%s","Cont. Input-10(originalshapeSphericity): ");
	scanf("%lg",&Over2cc_1_RBF_11_18_2_input[10]);
	for(cont_inps=0;cont_inps<11;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over2cc_1_RBF_11_18_2_input[cont_inps] == -9999)
	  Over2cc_1_RBF_11_18_2_input[cont_inps]=Over2cc_1_RBF_11_18_2_MeanInputs[cont_inps];
	}
    Over2cc_1_RBF_11_18_2_ScaleInputs(Over2cc_1_RBF_11_18_2_input,0,1,11);
	Over2cc_1_RBF_11_18_2_RunNeuralNet_Classification();
   //Output Activation is Softmax;
	Over2cc_1_RBF_11_18_2_softmax(Over2cc_1_RBF_11_18_2_output, 2);
	for(i=0;i<2;i++)
	{
      if(max<Over2cc_1_RBF_11_18_2_output[i])
      {
        max=Over2cc_1_RBF_11_18_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

