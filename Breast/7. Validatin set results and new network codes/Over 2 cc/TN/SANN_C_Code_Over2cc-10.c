//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over2cc_10_RBF_11_14_2_input_hidden_weights[168] =
{
9.99250461639186e-001, 7.21394768807926e-002, 6.90398295712862e-001, 3.93661550369487e-001, 
4.66763635487816e-001, 4.21718754124054e-001, 6.33987268506019e-001, 1.52452386869586e-001, 
6.00803812223607e-001, 8.05706702254359e-001, 8.02023458805568e-001, 9.92755383385262e-001, 
4.79586208583193e-001, 9.01458103483079e-001, 6.41278706914585e-001, 5.31310660996807e-001, 
5.29346075550714e-001, 3.39418980665412e-001, 8.21018922965107e-001, 6.72198186605529e-001, 
7.83869591455207e-001, 8.35202484501155e-001, 9.95897673240668e-001, 6.37359639947100e-001, 
8.48445486514376e-001, 8.97530739718715e-001, 5.56185744149366e-001, 6.27764424394213e-001, 
6.00880361960838e-001, 6.51551089664984e-001, 6.81258571386723e-001, 5.20510469407989e-001, 
6.35625959065962e-001, -9.69438148026694e+000, -1.87110667404945e+001, -4.46421181717017e+000, 
-5.14713895396064e+000, -3.18966806431508e+000, -2.83614235573196e+000, -1.73065389509128e+000, 
-2.69276289677406e+000, -2.04600653266477e+000, -1.45344827624239e+000, -4.40048261236468e-001, 
8.08406044651273e-001, 7.52573518720254e-001, 6.91335529694713e-001, 9.60445319422429e-001, 
7.72850163552610e-001, 8.03331966630862e-001, 4.52970480842170e-001, 3.89605841069054e-001, 
7.71986598879999e-001, 8.12682362212306e-001, 6.08270730629494e-001, 9.95435625743589e-001, 
7.69483646955560e-001, 8.53023779823785e-001, 7.81470397412060e-001, 5.73912964504802e-001, 
7.52359571959891e-001, 7.35809590855605e-001, 3.35647116746309e-001, 6.82879333635277e-001, 
8.81830406626516e-001, 3.72054662242259e-001, 9.97851682917187e-001, 5.66506470615408e-001, 
9.13569780970540e-001, 7.75832884106996e-001, 5.64227531982050e-001, 4.93931866249416e-001, 
5.66238121038290e-001, 8.06590775823428e-001, 6.61044413729932e-001, 5.61319719724660e-001, 
6.56350378566391e-001, 9.81783881276105e-001, 5.11476856281138e-001, 8.91985149826535e-001, 
7.09467949397589e-001, 9.24129889514612e-001, 7.43176558198169e-001, 6.52537005526734e-001, 
7.36351483451496e-001, 1.00000000000000e+000, 8.15209471623173e-001, 5.00723661439582e-001, 
2.49155621954611e-001, 9.55786389527077e-001, 7.71524198390957e-001, 9.26581370732940e-001, 
7.38858788158755e-001, 8.35677561060930e-001, 6.73484586747030e-001, 2.64215841368929e-001, 
6.12589852671169e-001, 8.36463079299268e-001, 0.00000000000000e+000, 9.52028361373928e-001, 
8.31075212072278e-001, 7.42667055881861e-001, 8.14785415343226e-001, 6.93949164239303e-001, 
7.82227968644527e-001, 5.86650619014431e-001, 1.56696661934599e-001, 6.16113051797591e-001, 
7.66666265737871e-001, 6.60271786854534e-001, 9.74522670854370e-001, 6.39445473079583e-001, 
6.44713473054541e-001, 9.59430708005025e-001, 1.00000000000000e+000, 1.00000000000000e+000, 
1.00000000000000e+000, 2.16889086419510e-001, 9.97483268839294e-001, 7.05683484404349e-001, 
6.24997761993440e-001, 8.93931583803335e-001, 3.86164267049182e-001, 4.18088680361379e-001, 
2.80679985017165e-001, 1.06971825397689e-001, 3.16437543182357e-001, 2.18634163760002e-001, 
5.13913671967973e-001, 6.00941887242068e-002, 7.61882943400386e-001, 7.62116833737508e-001, 
9.91964587529159e-001, 7.43034535664240e-001, 8.46023007928753e-001, 7.16623863181035e-001, 
5.32267261397431e-001, 7.07492679094436e-001, 6.09229834289803e-001, 2.82690669065554e-001, 
6.58427685436745e-001, 6.88238874072561e-001, 8.12044353449412e-001, 9.91421135044495e-001, 
3.56409018164420e-001, 8.85263290453583e-001, 6.30108469051888e-001, 2.05147768845519e-001, 
2.42459697425653e-001, 3.70133604264164e-001, 3.39500378311292e-001, 3.99558232621402e-001, 
7.88774436774814e-001, 5.26138857370551e-001, 7.04862510382358e-001, 4.01828734526822e-001, 
2.64182235025841e-001, 2.39948980736264e+001, 3.98180341190753e-001, 4.35118730480077e-001, 
2.64182235025841e-001, 6.44795225873601e-001, 8.98833274197124e-001, 3.29774489566164e-001, 
7.24218455385173e-001, 7.68680609267668e-001, 3.29774489566164e-001, 7.04862510382358e-001 
};

double Over2cc_10_RBF_11_14_2_hidden_output_wts[2][14]=
{
 {-2.13266963719360e+002, 2.28642577637055e-002, 1.37309279180952e-003, 1.63837155579891e-001, 2.94601521445048e-001, 9.42919799524930e-001, -7.56997850309726e-004, 5.28774083196107e+001, 3.03768575514597e+001, -1.60808546481266e-002, -8.80486881114672e+002, -2.60588801179686e+001, 3.78363753588880e-002, 1.02780844127652e+002 },
 {2.13267030462345e+002, -2.58506029320799e-002, -1.42053121374824e-003, -1.34369803137510e-001, -2.93113012337198e-001, -9.42603183636209e-001, 8.14908380215355e-004, -5.28753014299646e+001, -3.03651668548837e+001, 1.57222175538013e-002, 8.80498501522969e+002, 2.61261896296020e+001, -3.75964071536876e-002, -1.02795705630870e+002 }
};

double Over2cc_10_RBF_11_14_2_output_bias[2]={ 1.08950004685017e+000, -8.93032494016355e-002 };

double Over2cc_10_RBF_11_14_2_radial_centers[14][11]=
{
 {9.99250461639186e-001, 7.21394768807926e-002, 6.90398295712862e-001, 3.93661550369487e-001, 4.66763635487816e-001, 4.21718754124054e-001, 6.33987268506019e-001, 1.52452386869586e-001, 6.00803812223607e-001, 8.05706702254359e-001, 8.02023458805568e-001 },
 {9.92755383385262e-001, 4.79586208583193e-001, 9.01458103483079e-001, 6.41278706914585e-001, 5.31310660996807e-001, 5.29346075550714e-001, 3.39418980665412e-001, 8.21018922965107e-001, 6.72198186605529e-001, 7.83869591455207e-001, 8.35202484501155e-001 },
 {9.95897673240668e-001, 6.37359639947100e-001, 8.48445486514376e-001, 8.97530739718715e-001, 5.56185744149366e-001, 6.27764424394213e-001, 6.00880361960838e-001, 6.51551089664984e-001, 6.81258571386723e-001, 5.20510469407989e-001, 6.35625959065962e-001 },
 {-9.69438148026694e+000, -1.87110667404945e+001, -4.46421181717017e+000, -5.14713895396064e+000, -3.18966806431508e+000, -2.83614235573196e+000, -1.73065389509128e+000, -2.69276289677406e+000, -2.04600653266477e+000, -1.45344827624239e+000, -4.40048261236468e-001 },
 {8.08406044651273e-001, 7.52573518720254e-001, 6.91335529694713e-001, 9.60445319422429e-001, 7.72850163552610e-001, 8.03331966630862e-001, 4.52970480842170e-001, 3.89605841069054e-001, 7.71986598879999e-001, 8.12682362212306e-001, 6.08270730629494e-001 },
 {9.95435625743589e-001, 7.69483646955560e-001, 8.53023779823785e-001, 7.81470397412060e-001, 5.73912964504802e-001, 7.52359571959891e-001, 7.35809590855605e-001, 3.35647116746309e-001, 6.82879333635277e-001, 8.81830406626516e-001, 3.72054662242259e-001 },
 {9.97851682917187e-001, 5.66506470615408e-001, 9.13569780970540e-001, 7.75832884106996e-001, 5.64227531982050e-001, 4.93931866249416e-001, 5.66238121038290e-001, 8.06590775823428e-001, 6.61044413729932e-001, 5.61319719724660e-001, 6.56350378566391e-001 },
 {9.81783881276105e-001, 5.11476856281138e-001, 8.91985149826535e-001, 7.09467949397589e-001, 9.24129889514612e-001, 7.43176558198169e-001, 6.52537005526734e-001, 7.36351483451496e-001, 1.00000000000000e+000, 8.15209471623173e-001, 5.00723661439582e-001 },
 {2.49155621954611e-001, 9.55786389527077e-001, 7.71524198390957e-001, 9.26581370732940e-001, 7.38858788158755e-001, 8.35677561060930e-001, 6.73484586747030e-001, 2.64215841368929e-001, 6.12589852671169e-001, 8.36463079299268e-001, 0.00000000000000e+000 },
 {9.52028361373928e-001, 8.31075212072278e-001, 7.42667055881861e-001, 8.14785415343226e-001, 6.93949164239303e-001, 7.82227968644527e-001, 5.86650619014431e-001, 1.56696661934599e-001, 6.16113051797591e-001, 7.66666265737871e-001, 6.60271786854534e-001 },
 {9.74522670854370e-001, 6.39445473079583e-001, 6.44713473054541e-001, 9.59430708005025e-001, 1.00000000000000e+000, 1.00000000000000e+000, 1.00000000000000e+000, 2.16889086419510e-001, 9.97483268839294e-001, 7.05683484404349e-001, 6.24997761993440e-001 },
 {8.93931583803335e-001, 3.86164267049182e-001, 4.18088680361379e-001, 2.80679985017165e-001, 1.06971825397689e-001, 3.16437543182357e-001, 2.18634163760002e-001, 5.13913671967973e-001, 6.00941887242068e-002, 7.61882943400386e-001, 7.62116833737508e-001 },
 {9.91964587529159e-001, 7.43034535664240e-001, 8.46023007928753e-001, 7.16623863181035e-001, 5.32267261397431e-001, 7.07492679094436e-001, 6.09229834289803e-001, 2.82690669065554e-001, 6.58427685436745e-001, 6.88238874072561e-001, 8.12044353449412e-001 },
 {9.91421135044495e-001, 3.56409018164420e-001, 8.85263290453583e-001, 6.30108469051888e-001, 2.05147768845519e-001, 2.42459697425653e-001, 3.70133604264164e-001, 3.39500378311292e-001, 3.99558232621402e-001, 7.88774436774814e-001, 5.26138857370551e-001 } 
};

double Over2cc_10_RBF_11_14_2_Vector_SigmasInv2[14]={ -1.00637810532410e+000, -3.09662078863729e+000, -7.16411888619632e+000, -8.68424736233229e-004, -3.15362736559030e+000, -2.64091514374065e+000, -7.16411888619632e+000, -1.20261433932909e+000, -6.18887515060674e-001, -4.59764982618269e+000, -9.53302712357547e-001, -8.46209999385918e-001, -4.59764982618269e+000, -1.00637810532410e+000 };

double Over2cc_10_RBF_11_14_2_normalizer[14]={ -6.26104619009559e+000, -7.93014040279901e-002, 4.53395356236937e+000, -4.50645773675739e+001, 2.10289700570476e-002, -9.54824108712305e-001, 4.53395356236937e+000, -5.28127645479760e+000, -8.93508895993334e+000, 2.09448458855174e+000, -6.55903968558312e+000, -7.21444685391982e+000, 2.09448458855174e+000, -6.26104619009559e+000 };

double Over2cc_10_RBF_11_14_2_NormSqd(double* data,long length,int centerid)
{
  double sum = 0.0;
  long i;
	for(i=0; i<length; i++) {sum += (*(data+(centerid*length)+i)) * (*(data+(centerid*length)+i));}
  return sum;
}

void Over2cc_10_RBF_11_14_2_ComputeActivations(double* in,double* hid)
{
  double diff2;
  long i,j;
 	for(i=0; i<14; i++)
  {
    diff2=0.0;
    for(j=0;j<11; j++)
       diff2+=(Over2cc_10_RBF_11_14_2_radial_centers[i][j]-in[j])*(Over2cc_10_RBF_11_14_2_radial_centers[i][j]-in[j]);
    hid[i] = exp(Over2cc_10_RBF_11_14_2_normalizer[i] + diff2*Over2cc_10_RBF_11_14_2_Vector_SigmasInv2[i]);
  }
}

double Over2cc_10_RBF_11_14_2_max_input[11]={ 9.99958329432000e-001, 9.94505657234667e-001, 9.81000941145667e-001, 9.77249757356000e-001, 7.56346456271333e+000, 6.80611365125667e+000, 6.08511856610667e+000, 9.76903355877333e-001, 7.09083526106000e+000, 4.97958375536000e-001, 8.06335210109333e-001 };

double Over2cc_10_RBF_11_14_2_min_input[11]={ 9.07570890327000e-001, 9.44650005130667e-001, 8.06267137025000e-001, 8.22841769254000e-001, 5.86068628775333e+000, 5.13742515665000e+000, 4.01210318245333e+000, 7.31203984050667e-001, 4.93424538709667e+000, 3.13060595095333e-001, 3.12766281606667e-001 };

double Over2cc_10_RBF_11_14_2_input[11];
double Over2cc_10_RBF_11_14_2_hidden[14];
double Over2cc_10_RBF_11_14_2_output[2];

double Over2cc_10_RBF_11_14_2_MeanInputs[11]={ 9.95162114251585e-001, 9.73127748552063e-001, 9.40878102187135e-001, 9.25104787935739e-001, 6.80160489106444e+000, 6.13033404751014e+000, 5.15109253864092e+000, 8.47882026592947e-001, 6.21245045143614e+000, 4.40009626845691e-001, 6.49807676291053e-001 };

void Over2cc_10_RBF_11_14_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over2cc_10_RBF_11_14_2_max_input[i]-Over2cc_10_RBF_11_14_2_min_input[i]);
	input[i] = minimum - delta*Over2cc_10_RBF_11_14_2_min_input[i]+ delta*input[i];
 }
}

void Over2cc_10_RBF_11_14_2_Normalise(double out[],long length)
{
  long i, j;
  double sum = 0.0;
  for(i=0; i<length; i++)
  {
   if(out[i]>100)
   {
    out[i] = 1.0;
    j = i;
    for(i=0; i<length; i++)
    {
     if(i!=j) out[i] = 0.0;
    }
    break;
   }
   else out[i] = exp(out[i]);
  }
  for(i=0; i<length; i++)
  {
   sum += out[i];
  }
  for(i=0; i<length; i++)
  {
   out[i] = out[i]/sum;
  }
}

void Over2cc_10_RBF_11_14_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
   }
}

void Over2cc_10_RBF_11_14_2_RunNeuralNet_Classification () 
{
  Over2cc_10_RBF_11_14_2_ComputeActivations(Over2cc_10_RBF_11_14_2_input,Over2cc_10_RBF_11_14_2_hidden);
  Over2cc_10_RBF_11_14_2_ComputeFeedForwardSignals((double*)Over2cc_10_RBF_11_14_2_hidden_output_wts,Over2cc_10_RBF_11_14_2_hidden,Over2cc_10_RBF_11_14_2_output,Over2cc_10_RBF_11_14_2_output_bias,14, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-LLLglcmImc2): ");
	scanf("%lg",&Over2cc_10_RBF_11_14_2_input[0]);
	printf("%s","Cont. Input-1(originalglcmIdmn): ");
	scanf("%lg",&Over2cc_10_RBF_11_14_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-LHHglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_10_RBF_11_14_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-HHHglcmIdn): ");
	scanf("%lg",&Over2cc_10_RBF_11_14_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-LLHglszmZoneEntropy): ");
	scanf("%lg",&Over2cc_10_RBF_11_14_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-HLLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_10_RBF_11_14_2_input[5]);
	printf("%s","Cont. Input-6(originalglrlmRunEntropy): ");
	scanf("%lg",&Over2cc_10_RBF_11_14_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-HHHglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_10_RBF_11_14_2_input[7]);
	printf("%s","Cont. Input-8(wavelet-LLHglcmSumEntropy): ");
	scanf("%lg",&Over2cc_10_RBF_11_14_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-HHLglcmInverseVariance): ");
	scanf("%lg",&Over2cc_10_RBF_11_14_2_input[9]);
	printf("%s","Cont. Input-10(originalshapeSphericity): ");
	scanf("%lg",&Over2cc_10_RBF_11_14_2_input[10]);
	for(cont_inps=0;cont_inps<11;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over2cc_10_RBF_11_14_2_input[cont_inps] == -9999)
	  Over2cc_10_RBF_11_14_2_input[cont_inps]=Over2cc_10_RBF_11_14_2_MeanInputs[cont_inps];
	}
    Over2cc_10_RBF_11_14_2_ScaleInputs(Over2cc_10_RBF_11_14_2_input,0,1,11);
	Over2cc_10_RBF_11_14_2_RunNeuralNet_Classification();
   //Normalise output if output activation is not Softmax;
 	Over2cc_10_RBF_11_14_2_Normalise(Over2cc_10_RBF_11_14_2_output,2);
	for(i=0;i<2;i++)
	{
      if(max<Over2cc_10_RBF_11_14_2_output[i])
      {
        max=Over2cc_10_RBF_11_14_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

