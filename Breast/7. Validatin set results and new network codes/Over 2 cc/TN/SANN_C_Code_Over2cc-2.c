//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over2cc_2_RBF_11_19_2_input_hidden_weights[228] =
{
9.95435625743589e-001, 7.69483646955560e-001, 8.53023779823785e-001, 7.81470397412060e-001, 
5.73912964504802e-001, 7.52359571959891e-001, 7.35809590855605e-001, 3.35647116746309e-001, 
6.82879333635277e-001, 8.81830406626516e-001, 3.72054662242259e-001, 9.86890502283286e-001, 
4.40023132059419e-001, 7.64961843120871e-001, 5.39442309545390e-001, 4.77848484823495e-001, 
5.49399977017738e-001, 5.73909998691527e-001, 2.25001952551458e-001, 5.53392205306081e-001, 
8.81619979811725e-001, 8.21349141799033e-001, 9.98082129926070e-001, 3.83957430150584e-001, 
8.99351720673035e-001, 7.64407434370323e-001, 5.51476834454793e-001, 4.39534656306769e-001, 
5.13223136123102e-001, 7.57934128507698e-001, 5.42270147445390e-001, 7.35738915822125e-001, 
5.88529263395674e-001, 7.63252032701745e-001, 8.45272141242720e-001, 7.44098743203378e-001, 
9.07031042220536e-001, 8.91414108576364e-001, 9.16895598154952e-001, 6.16410481584583e-001, 
4.81827843667356e-001, 8.84542147443299e-001, 7.70383984070464e-001, 5.29803336363357e-001, 
9.65755043297561e-001, 4.05592110549176e-001, 3.01593862064650e-001, 4.19653176605920e-001, 
1.27951363813619e-001, 0.00000000000000e+000, 4.54664813182570e-002, 1.60204228943255e-001, 
1.98812454211351e-001, 7.53269431538835e-001, 6.93582886329963e-001, 9.73602922969919e-001, 
9.24348681165934e-001, 8.64966146472116e-001, 8.30169982710497e-001, 8.46754999555381e-001, 
8.45116574644097e-001, 7.11914333966884e-001, 7.24565935221810e-001, 9.10554260434246e-001, 
7.07285967365262e-001, 4.83173603354933e-001, 9.36080442689237e-001, 8.27853587865423e-001, 
6.91814926291277e-001, 9.20983977651421e-001, 9.55467732688149e-001, 8.96804145571065e-001, 
6.34317716275679e-001, 5.34031048992257e-001, 8.86403544564651e-001, 6.05026428628393e-001, 
8.44384461824461e-001, 9.97851682917187e-001, 5.66506470615408e-001, 9.13569780970540e-001, 
7.75832884106996e-001, 5.64227531982050e-001, 4.93931866249416e-001, 5.66238121038290e-001, 
8.06590775823428e-001, 6.61044413729932e-001, 5.61319719724660e-001, 6.56350378566391e-001, 
2.49155621954611e-001, 9.55786389527077e-001, 7.71524198390957e-001, 9.26581370732940e-001, 
7.38858788158755e-001, 8.35677561060930e-001, 6.73484586747030e-001, 2.64215841368929e-001, 
6.12589852671169e-001, 8.36463079299268e-001, 0.00000000000000e+000, 9.59721746068706e-001, 
8.10384199897474e-001, 8.25799270828863e-001, 6.70795694908685e-001, 4.78855200474739e-001, 
4.77703413191306e-001, 4.18097770227775e-001, 1.92901805679434e-001, 5.85814817754331e-001, 
8.95259639262059e-001, 7.58239977956077e-001, 9.99250461639186e-001, 7.21394768807926e-002, 
6.90398295712862e-001, 3.93661550369487e-001, 4.66763635487816e-001, 4.21718754124054e-001, 
6.33987268506019e-001, 1.52452386869586e-001, 6.00803812223607e-001, 8.05706702254359e-001, 
8.02023458805568e-001, 7.55842530775602e-001, 8.32030993058435e-001, 4.99306310819802e-001, 
9.79885918458559e-001, 8.77465664296055e-001, 1.01048103000642e+000, 6.97743037333814e-001, 
1.43493770769069e-001, 8.61470524041909e-001, 6.86398421372035e-001, 8.10290667476325e-001, 
9.55949582943758e-001, 7.50635916624539e-001, 7.80405614509281e-001, 8.49556633687102e-001, 
7.81140520042896e-001, 8.12017559302499e-001, 6.74118401279728e-001, 5.86675029606331e-001, 
8.83720695382314e-001, 7.03857255970480e-001, 5.89109709152668e-001, -9.69438148026694e+000, 
-1.87110667404945e+001, -4.46421181717017e+000, -5.14713895396064e+000, -3.18966806431508e+000, 
-2.83614235573196e+000, -1.73065389509128e+000, -2.69276289677406e+000, -2.04600653266477e+000, 
-1.45344827624239e+000, -4.40048261236468e-001, 9.74522670854370e-001, 6.39445473079583e-001, 
6.44713473054541e-001, 9.59430708005025e-001, 1.00000000000000e+000, 1.00000000000000e+000, 
1.00000000000000e+000, 2.16889086419510e-001, 9.97483268839294e-001, 7.05683484404349e-001, 
6.24997761993440e-001, 9.99277860670460e-001, 1.82600174292702e-001, 8.58553670159139e-001, 
7.18354946472897e-001, 7.37300722815967e-001, 6.49939056403879e-001, 8.71721008912781e-001, 
7.04208762723508e-001, 8.87199789505517e-001, 7.24083515269467e-001, 8.87736709716658e-001, 
8.93931583803335e-001, 3.86164267049182e-001, 4.18088680361379e-001, 2.80679985017165e-001, 
1.06971825397689e-001, 3.16437543182357e-001, 2.18634163760002e-001, 5.13913671967973e-001, 
6.00941887242068e-002, 7.61882943400386e-001, 7.62116833737508e-001, 9.89749307584368e-001, 
4.32717762899397e-001, 6.92639880405863e-001, 8.28821309595244e-001, 5.86052633088774e-001, 
8.24381502049562e-001, 5.77786504241543e-001, 4.96160927251649e-001, 6.36588859396951e-001, 
6.98337073880855e-001, 9.18374065666530e-001, 9.95646501939047e-001, 6.02414893273934e-001, 
8.24020238830841e-001, 8.13453760730053e-001, 5.35148497121901e-001, 5.46454720566808e-001, 
5.90958440276678e-001, 6.13975659649180e-001, 6.60742150639546e-001, 6.46629090520821e-001, 
7.71720921192352e-001, 4.94238057503362e-001, 4.41055188971548e-001, 3.01804042506091e-001, 
3.10058683743253e-001, 5.64007773807486e-001, 2.75339035890047e-001, 3.69028023267860e-001, 
2.69504709359259e-001, 8.46841717557367e-001, 4.41055188971548e-001, 4.42702111229906e-001, 
5.06938357748664e-001, 2.75339035890047e-001, 2.39650891250917e+001, 5.21102048658455e-001, 
5.91417547887782e-001, 5.64007773807486e-001, 4.06179065061823e-001, 2.69504709359259e-001 
};

double Over2cc_2_RBF_11_19_2_hidden_output_wts[2][19]=
{
 {1.41624727140200e+000, 4.78925122253649e+000, -4.41618601857230e-003, 4.73073158662043e-002, 2.37497246155127e+000, -5.16574265497487e-003, -2.63134728605830e-001, 1.36479720610558e-003, 2.21749111638348e-003, -2.28566980938861e+000, -5.02949611796674e+000, -7.98598714891149e+000, 1.13557573080969e-002, 1.54390915160978e-001, -1.29179967492798e+001, -2.60948343443513e+000, 2.12344321181667e+000, -9.86840767681058e-002, 1.09375301321239e-003 },
 {-1.41662160976495e+000, -4.78816202247907e+000, 4.41804467422919e-003, -4.72240528326907e-002, -2.29503697116000e+000, 5.15268051245501e-003, 2.63612595304989e-001, -1.37036512285063e-003, 4.83063100605408e-002, 2.28663787546791e+000, 5.02884730137569e+000, 7.94177923472722e+000, -1.13680681725583e-002, -1.53577260255359e-002, 1.29337094313804e+001, 2.62141486782190e+000, -2.25173628233526e+000, 9.87410504464529e-002, -1.09271439926784e-003 }
};

double Over2cc_2_RBF_11_19_2_output_bias[2]={ 9.87686637850772e-001, 1.26856290415761e-002 };

double Over2cc_2_RBF_11_19_2_radial_centers[19][11]=
{
 {9.95435625743589e-001, 7.69483646955560e-001, 8.53023779823785e-001, 7.81470397412060e-001, 5.73912964504802e-001, 7.52359571959891e-001, 7.35809590855605e-001, 3.35647116746309e-001, 6.82879333635277e-001, 8.81830406626516e-001, 3.72054662242259e-001 },
 {9.86890502283286e-001, 4.40023132059419e-001, 7.64961843120871e-001, 5.39442309545390e-001, 4.77848484823495e-001, 5.49399977017738e-001, 5.73909998691527e-001, 2.25001952551458e-001, 5.53392205306081e-001, 8.81619979811725e-001, 8.21349141799033e-001 },
 {9.98082129926070e-001, 3.83957430150584e-001, 8.99351720673035e-001, 7.64407434370323e-001, 5.51476834454793e-001, 4.39534656306769e-001, 5.13223136123102e-001, 7.57934128507698e-001, 5.42270147445390e-001, 7.35738915822125e-001, 5.88529263395674e-001 },
 {7.63252032701745e-001, 8.45272141242720e-001, 7.44098743203378e-001, 9.07031042220536e-001, 8.91414108576364e-001, 9.16895598154952e-001, 6.16410481584583e-001, 4.81827843667356e-001, 8.84542147443299e-001, 7.70383984070464e-001, 5.29803336363357e-001 },
 {9.65755043297561e-001, 4.05592110549176e-001, 3.01593862064650e-001, 4.19653176605920e-001, 1.27951363813619e-001, 0.00000000000000e+000, 4.54664813182570e-002, 1.60204228943255e-001, 1.98812454211351e-001, 7.53269431538835e-001, 6.93582886329963e-001 },
 {9.73602922969919e-001, 9.24348681165934e-001, 8.64966146472116e-001, 8.30169982710497e-001, 8.46754999555381e-001, 8.45116574644097e-001, 7.11914333966884e-001, 7.24565935221810e-001, 9.10554260434246e-001, 7.07285967365262e-001, 4.83173603354933e-001 },
 {9.36080442689237e-001, 8.27853587865423e-001, 6.91814926291277e-001, 9.20983977651421e-001, 9.55467732688149e-001, 8.96804145571065e-001, 6.34317716275679e-001, 5.34031048992257e-001, 8.86403544564651e-001, 6.05026428628393e-001, 8.44384461824461e-001 },
 {9.97851682917187e-001, 5.66506470615408e-001, 9.13569780970540e-001, 7.75832884106996e-001, 5.64227531982050e-001, 4.93931866249416e-001, 5.66238121038290e-001, 8.06590775823428e-001, 6.61044413729932e-001, 5.61319719724660e-001, 6.56350378566391e-001 },
 {2.49155621954611e-001, 9.55786389527077e-001, 7.71524198390957e-001, 9.26581370732940e-001, 7.38858788158755e-001, 8.35677561060930e-001, 6.73484586747030e-001, 2.64215841368929e-001, 6.12589852671169e-001, 8.36463079299268e-001, 0.00000000000000e+000 },
 {9.59721746068706e-001, 8.10384199897474e-001, 8.25799270828863e-001, 6.70795694908685e-001, 4.78855200474739e-001, 4.77703413191306e-001, 4.18097770227775e-001, 1.92901805679434e-001, 5.85814817754331e-001, 8.95259639262059e-001, 7.58239977956077e-001 },
 {9.99250461639186e-001, 7.21394768807926e-002, 6.90398295712862e-001, 3.93661550369487e-001, 4.66763635487816e-001, 4.21718754124054e-001, 6.33987268506019e-001, 1.52452386869586e-001, 6.00803812223607e-001, 8.05706702254359e-001, 8.02023458805568e-001 },
 {7.55842530775602e-001, 8.32030993058435e-001, 4.99306310819802e-001, 9.79885918458559e-001, 8.77465664296055e-001, 1.01048103000642e+000, 6.97743037333814e-001, 1.43493770769069e-001, 8.61470524041909e-001, 6.86398421372035e-001, 8.10290667476325e-001 },
 {9.55949582943758e-001, 7.50635916624539e-001, 7.80405614509281e-001, 8.49556633687102e-001, 7.81140520042896e-001, 8.12017559302499e-001, 6.74118401279728e-001, 5.86675029606331e-001, 8.83720695382314e-001, 7.03857255970480e-001, 5.89109709152668e-001 },
 {-9.69438148026694e+000, -1.87110667404945e+001, -4.46421181717017e+000, -5.14713895396064e+000, -3.18966806431508e+000, -2.83614235573196e+000, -1.73065389509128e+000, -2.69276289677406e+000, -2.04600653266477e+000, -1.45344827624239e+000, -4.40048261236468e-001 },
 {9.74522670854370e-001, 6.39445473079583e-001, 6.44713473054541e-001, 9.59430708005025e-001, 1.00000000000000e+000, 1.00000000000000e+000, 1.00000000000000e+000, 2.16889086419510e-001, 9.97483268839294e-001, 7.05683484404349e-001, 6.24997761993440e-001 },
 {9.99277860670460e-001, 1.82600174292702e-001, 8.58553670159139e-001, 7.18354946472897e-001, 7.37300722815967e-001, 6.49939056403879e-001, 8.71721008912781e-001, 7.04208762723508e-001, 8.87199789505517e-001, 7.24083515269467e-001, 8.87736709716658e-001 },
 {8.93931583803335e-001, 3.86164267049182e-001, 4.18088680361379e-001, 2.80679985017165e-001, 1.06971825397689e-001, 3.16437543182357e-001, 2.18634163760002e-001, 5.13913671967973e-001, 6.00941887242068e-002, 7.61882943400386e-001, 7.62116833737508e-001 },
 {9.89749307584368e-001, 4.32717762899397e-001, 6.92639880405863e-001, 8.28821309595244e-001, 5.86052633088774e-001, 8.24381502049562e-001, 5.77786504241543e-001, 4.96160927251649e-001, 6.36588859396951e-001, 6.98337073880855e-001, 9.18374065666530e-001 },
 {9.95646501939047e-001, 6.02414893273934e-001, 8.24020238830841e-001, 8.13453760730053e-001, 5.35148497121901e-001, 5.46454720566808e-001, 5.90958440276678e-001, 6.13975659649180e-001, 6.60742150639546e-001, 6.46629090520821e-001, 7.71720921192352e-001 } 
};

double Over2cc_2_RBF_11_19_2_Vector_SigmasInv2[19]={ -2.04690476132389e+000, -2.57030187230531e+000, -5.48933706812287e+000, -5.20094434278817e+000, -1.57180919262852e+000, -6.59529809432738e+000, -3.67156575550253e+000, -6.88394334353296e+000, -6.97213063385564e-001, -2.57030187230531e+000, -2.55121358075251e+000, -1.94562750497676e+000, -6.59529809432738e+000, -8.70586458043168e-004, -1.84129953392230e+000, -1.42949154755958e+000, -1.57180919262852e+000, -3.03064406235181e+000, -6.88394334353296e+000 };

double Over2cc_2_RBF_11_19_2_normalizer[19]={ -2.35620608426469e+000, -1.10388593589412e+000, 3.06942685369277e+000, 2.77260680197872e+000, -3.80876417869293e+000, 4.07894904641554e+000, 8.57385768858406e-001, 4.31453969264809e+000, -8.27966762938627e+000, -1.10388593589412e+000, -1.14488399228159e+000, -2.63529934879294e+000, 4.07894904641554e+000, -4.50509035325603e+001, -2.93842062295321e+000, -4.33076086273234e+000, -3.80876417869293e+000, -1.97750998960096e-001, 4.31453969264809e+000 };

double Over2cc_2_RBF_11_19_2_NormSqd(double* data,long length,int centerid)
{
  double sum = 0.0;
  long i;
	for(i=0; i<length; i++) {sum += (*(data+(centerid*length)+i)) * (*(data+(centerid*length)+i));}
  return sum;
}

void Over2cc_2_RBF_11_19_2_ComputeActivations(double* in,double* hid)
{
  double diff2;
  long i,j;
 	for(i=0; i<19; i++)
  {
    diff2=0.0;
    for(j=0;j<11; j++)
       diff2+=(Over2cc_2_RBF_11_19_2_radial_centers[i][j]-in[j])*(Over2cc_2_RBF_11_19_2_radial_centers[i][j]-in[j]);
    hid[i] = exp(Over2cc_2_RBF_11_19_2_normalizer[i] + diff2*Over2cc_2_RBF_11_19_2_Vector_SigmasInv2[i]);
  }
}

double Over2cc_2_RBF_11_19_2_max_input[11]={ 9.99958329432000e-001, 9.94505657234667e-001, 9.81000941145667e-001, 9.77249757356000e-001, 7.56346456271333e+000, 6.80611365125667e+000, 6.08511856610667e+000, 9.76903355877333e-001, 7.09083526106000e+000, 4.97958375536000e-001, 8.06335210109333e-001 };

double Over2cc_2_RBF_11_19_2_min_input[11]={ 9.07570890327000e-001, 9.44650005130667e-001, 8.06267137025000e-001, 8.22841769254000e-001, 5.86068628775333e+000, 5.13742515665000e+000, 4.01210318245333e+000, 7.31203984050667e-001, 4.93424538709667e+000, 3.13060595095333e-001, 3.12766281606667e-001 };

double Over2cc_2_RBF_11_19_2_input[11];
double Over2cc_2_RBF_11_19_2_hidden[19];
double Over2cc_2_RBF_11_19_2_output[2];

double Over2cc_2_RBF_11_19_2_MeanInputs[11]={ 9.95162114251585e-001, 9.73127748552063e-001, 9.40878102187135e-001, 9.25104787935739e-001, 6.80160489106444e+000, 6.13033404751014e+000, 5.15109253864092e+000, 8.47882026592947e-001, 6.21245045143614e+000, 4.40009626845691e-001, 6.49807676291053e-001 };

void Over2cc_2_RBF_11_19_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over2cc_2_RBF_11_19_2_max_input[i]-Over2cc_2_RBF_11_19_2_min_input[i]);
	input[i] = minimum - delta*Over2cc_2_RBF_11_19_2_min_input[i]+ delta*input[i];
 }
}

void Over2cc_2_RBF_11_19_2_Normalise(double out[],long length)
{
  long i, j;
  double sum = 0.0;
  for(i=0; i<length; i++)
  {
   if(out[i]>100)
   {
    out[i] = 1.0;
    j = i;
    for(i=0; i<length; i++)
    {
     if(i!=j) out[i] = 0.0;
    }
    break;
   }
   else out[i] = exp(out[i]);
  }
  for(i=0; i<length; i++)
  {
   sum += out[i];
  }
  for(i=0; i<length; i++)
  {
   out[i] = out[i]/sum;
  }
}

void Over2cc_2_RBF_11_19_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
   }
}

void Over2cc_2_RBF_11_19_2_RunNeuralNet_Classification () 
{
  Over2cc_2_RBF_11_19_2_ComputeActivations(Over2cc_2_RBF_11_19_2_input,Over2cc_2_RBF_11_19_2_hidden);
  Over2cc_2_RBF_11_19_2_ComputeFeedForwardSignals((double*)Over2cc_2_RBF_11_19_2_hidden_output_wts,Over2cc_2_RBF_11_19_2_hidden,Over2cc_2_RBF_11_19_2_output,Over2cc_2_RBF_11_19_2_output_bias,19, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-LLLglcmImc2): ");
	scanf("%lg",&Over2cc_2_RBF_11_19_2_input[0]);
	printf("%s","Cont. Input-1(originalglcmIdmn): ");
	scanf("%lg",&Over2cc_2_RBF_11_19_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-LHHglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_2_RBF_11_19_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-HHHglcmIdn): ");
	scanf("%lg",&Over2cc_2_RBF_11_19_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-LLHglszmZoneEntropy): ");
	scanf("%lg",&Over2cc_2_RBF_11_19_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-HLLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_2_RBF_11_19_2_input[5]);
	printf("%s","Cont. Input-6(originalglrlmRunEntropy): ");
	scanf("%lg",&Over2cc_2_RBF_11_19_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-HHHglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_2_RBF_11_19_2_input[7]);
	printf("%s","Cont. Input-8(wavelet-LLHglcmSumEntropy): ");
	scanf("%lg",&Over2cc_2_RBF_11_19_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-HHLglcmInverseVariance): ");
	scanf("%lg",&Over2cc_2_RBF_11_19_2_input[9]);
	printf("%s","Cont. Input-10(originalshapeSphericity): ");
	scanf("%lg",&Over2cc_2_RBF_11_19_2_input[10]);
	for(cont_inps=0;cont_inps<11;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over2cc_2_RBF_11_19_2_input[cont_inps] == -9999)
	  Over2cc_2_RBF_11_19_2_input[cont_inps]=Over2cc_2_RBF_11_19_2_MeanInputs[cont_inps];
	}
    Over2cc_2_RBF_11_19_2_ScaleInputs(Over2cc_2_RBF_11_19_2_input,0,1,11);
	Over2cc_2_RBF_11_19_2_RunNeuralNet_Classification();
   //Normalise output if output activation is not Softmax;
 	Over2cc_2_RBF_11_19_2_Normalise(Over2cc_2_RBF_11_19_2_output,2);
	for(i=0;i<2;i++)
	{
      if(max<Over2cc_2_RBF_11_19_2_output[i])
      {
        max=Over2cc_2_RBF_11_19_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

