//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over2cc_6_RBF_11_14_2_input_hidden_weights[168] =
{
8.08406044651273e-001, 7.52573518720254e-001, 6.91335529694713e-001, 9.60445319422429e-001, 
7.72850163552610e-001, 8.03331966630862e-001, 4.52970480842170e-001, 3.89605841069054e-001, 
7.71986598879999e-001, 8.12682362212306e-001, 6.08270730629494e-001, 9.98144336225133e-001, 
4.45218154169641e-001, 7.27222490670714e-001, 8.55498002897401e-001, 7.02803515631797e-001, 
7.48927236544876e-001, 8.51545232204543e-001, 5.50728448786835e-001, 7.88207883527433e-001, 
4.69218001230542e-001, 9.18594138717582e-001, 8.97755625077297e-001, 8.37505109669404e-001, 
9.05479932832031e-001, 8.42868741825459e-001, 9.49572846021101e-001, 9.66551460509017e-001, 
9.79346376588608e-001, 6.88015837010725e-001, 9.63429006198388e-001, 6.48783230206637e-001, 
9.68066162618564e-002, 9.97656428924783e-001, 6.68623703523053e-001, 6.47978579255395e-001, 
5.08923595436589e-001, 5.35019114606334e-001, 5.70814754238789e-001, 6.41405606029190e-001, 
1.68189482787199e-001, 5.22641746236121e-001, 8.01237652272450e-001, 9.20949655383093e-001, 
9.22130541146144e-001, 8.07629764705649e-001, 6.21714387882914e-001, 8.45792329395091e-001, 
9.48667668700405e-001, 8.68762879803827e-001, 6.95314023265851e-001, 1.53645224603851e-001, 
8.66143377813658e-001, 7.64024264724289e-001, 6.51665868008401e-001, 9.95403154175710e-001, 
6.96513805319995e-001, 9.06313272984686e-001, 6.62823282746174e-001, 8.61055898148440e-001, 
9.04813946529443e-001, 8.17176625398657e-001, 7.82976721675880e-001, 8.93842348213419e-001, 
5.42334041847400e-001, 1.84730031942251e-001, 9.29585302670063e-001, 8.95523382120562e-001, 
7.29914628880799e-001, 8.40228384975976e-001, 6.84067717476230e-001, 9.24446714651965e-001, 
6.60091202456555e-001, 5.41653895810066e-001, 6.49482413372623e-001, 8.87641137680756e-001, 
4.34995192694428e-001, 9.50624450071089e-001, 3.62778401078199e-001, 6.38623102388397e-001, 
5.86191725203201e-001, 7.56009662953274e-001, 6.65432658331518e-001, 4.17487361171811e-001, 
1.01481464311286e-002, 7.36440092674912e-001, 7.69778979948366e-001, 7.67800543731525e-001, 
9.68655622336545e-001, 7.47017198116481e-001, 7.43377262945826e-001, 7.44595235153148e-001, 
5.09945169299116e-001, 5.72404599244957e-001, 6.14694952922948e-001, 2.61321240423421e-001, 
5.31359286039883e-001, 7.76132662616704e-001, 4.94101694158170e-001, 9.82057284607894e-001, 
5.20131364107719e-001, 6.16050904717879e-001, 4.46880606840224e-001, 5.86370226507298e-001, 
7.25275238299410e-001, 5.54503957879083e-001, 0.00000000000000e+000, 6.32893822253879e-001, 
6.53418410814489e-001, 6.59256641221576e-001, 9.57875917815585e-001, 6.00732144930276e-001, 
8.01096571023741e-001, 8.10960487600865e-001, 7.90285107535964e-001, 8.29456565134957e-001, 
3.92410018380920e-001, 6.81317996178795e-001, 8.35562552607675e-001, 6.30294254989164e-001, 
6.46652884505085e-001, 9.93282830288637e-001, 8.13375322876979e-001, 9.29133975138268e-001, 
9.13733535047417e-001, 7.66234018339224e-001, 8.41585878831761e-001, 6.45910196636815e-001, 
8.33001311524395e-001, 8.89083949007698e-001, 2.55878411296102e-001, 6.91816217449532e-001, 
9.73602922969919e-001, 9.24348681165934e-001, 8.64966146472116e-001, 8.30169982710497e-001, 
8.46754999555381e-001, 8.45116574644097e-001, 7.11914333966884e-001, 7.24565935221810e-001, 
9.10554260434246e-001, 7.07285967365262e-001, 4.83173603354933e-001, 9.98408186007126e-001, 
4.97361418419366e-002, 8.63375882511850e-001, 6.21846677987745e-001, 4.12863249446368e-001, 
5.87714802450992e-001, 5.99888200196763e-001, 7.76907315919651e-001, 5.13264460123068e-001, 
4.06154512019315e-001, 8.27076652246073e-001, 4.36209524159222e-001, 6.14315849508813e-001, 
3.64277748207720e-001, 4.38161928375013e-001, 4.43479328543048e-001, 3.64277748207720e-001, 
4.36209524159222e-001, 3.64614407603314e-001, 5.14346448429269e-001, 3.64614407603314e-001, 
4.56421716368189e-001, 5.42379138693322e-001, 4.39339347940188e-001, 7.36224196876761e-001 
};

double Over2cc_6_RBF_11_14_2_hidden_output_wts[2][14]=
{
 {3.45385705545630e+000, -3.88193642568442e+001, 1.85224766799348e-001, -6.60062655132185e-001, -4.68975307300719e+000, -3.70548306493498e-001, -1.52320151632823e+000, -2.96248451998216e-001, 6.28022499385337e+000, 3.23368953086645e-001, -1.30094714495425e+000, 1.09263331428669e+001, 1.55488302257862e+000, 4.82229541002840e+000 },
 {-3.45383371156145e+000, 3.88058185443360e+001, -1.85217924235811e-001, 6.60186577955773e-001, 4.68997579361095e+000, 3.70547163051574e-001, 1.52327503025641e+000, 2.96250351044384e-001, -6.28071750340356e+000, -3.23371192124931e-001, 1.30088704078522e+000, -1.09246687897712e+001, -1.55488121941296e+000, -4.71993206979103e+000 }
};

double Over2cc_6_RBF_11_14_2_output_bias[2]={ 9.21701554747331e-001, 7.82593590724274e-002 };

double Over2cc_6_RBF_11_14_2_radial_centers[14][11]=
{
 {8.08406044651273e-001, 7.52573518720254e-001, 6.91335529694713e-001, 9.60445319422429e-001, 7.72850163552610e-001, 8.03331966630862e-001, 4.52970480842170e-001, 3.89605841069054e-001, 7.71986598879999e-001, 8.12682362212306e-001, 6.08270730629494e-001 },
 {9.98144336225133e-001, 4.45218154169641e-001, 7.27222490670714e-001, 8.55498002897401e-001, 7.02803515631797e-001, 7.48927236544876e-001, 8.51545232204543e-001, 5.50728448786835e-001, 7.88207883527433e-001, 4.69218001230542e-001, 9.18594138717582e-001 },
 {8.97755625077297e-001, 8.37505109669404e-001, 9.05479932832031e-001, 8.42868741825459e-001, 9.49572846021101e-001, 9.66551460509017e-001, 9.79346376588608e-001, 6.88015837010725e-001, 9.63429006198388e-001, 6.48783230206637e-001, 9.68066162618564e-002 },
 {9.97656428924783e-001, 6.68623703523053e-001, 6.47978579255395e-001, 5.08923595436589e-001, 5.35019114606334e-001, 5.70814754238789e-001, 6.41405606029190e-001, 1.68189482787199e-001, 5.22641746236121e-001, 8.01237652272450e-001, 9.20949655383093e-001 },
 {9.22130541146144e-001, 8.07629764705649e-001, 6.21714387882914e-001, 8.45792329395091e-001, 9.48667668700405e-001, 8.68762879803827e-001, 6.95314023265851e-001, 1.53645224603851e-001, 8.66143377813658e-001, 7.64024264724289e-001, 6.51665868008401e-001 },
 {9.95403154175710e-001, 6.96513805319995e-001, 9.06313272984686e-001, 6.62823282746174e-001, 8.61055898148440e-001, 9.04813946529443e-001, 8.17176625398657e-001, 7.82976721675880e-001, 8.93842348213419e-001, 5.42334041847400e-001, 1.84730031942251e-001 },
 {9.29585302670063e-001, 8.95523382120562e-001, 7.29914628880799e-001, 8.40228384975976e-001, 6.84067717476230e-001, 9.24446714651965e-001, 6.60091202456555e-001, 5.41653895810066e-001, 6.49482413372623e-001, 8.87641137680756e-001, 4.34995192694428e-001 },
 {9.50624450071089e-001, 3.62778401078199e-001, 6.38623102388397e-001, 5.86191725203201e-001, 7.56009662953274e-001, 6.65432658331518e-001, 4.17487361171811e-001, 1.01481464311286e-002, 7.36440092674912e-001, 7.69778979948366e-001, 7.67800543731525e-001 },
 {9.68655622336545e-001, 7.47017198116481e-001, 7.43377262945826e-001, 7.44595235153148e-001, 5.09945169299116e-001, 5.72404599244957e-001, 6.14694952922948e-001, 2.61321240423421e-001, 5.31359286039883e-001, 7.76132662616704e-001, 4.94101694158170e-001 },
 {9.82057284607894e-001, 5.20131364107719e-001, 6.16050904717879e-001, 4.46880606840224e-001, 5.86370226507298e-001, 7.25275238299410e-001, 5.54503957879083e-001, 0.00000000000000e+000, 6.32893822253879e-001, 6.53418410814489e-001, 6.59256641221576e-001 },
 {9.57875917815585e-001, 6.00732144930276e-001, 8.01096571023741e-001, 8.10960487600865e-001, 7.90285107535964e-001, 8.29456565134957e-001, 3.92410018380920e-001, 6.81317996178795e-001, 8.35562552607675e-001, 6.30294254989164e-001, 6.46652884505085e-001 },
 {9.93282830288637e-001, 8.13375322876979e-001, 9.29133975138268e-001, 9.13733535047417e-001, 7.66234018339224e-001, 8.41585878831761e-001, 6.45910196636815e-001, 8.33001311524395e-001, 8.89083949007698e-001, 2.55878411296102e-001, 6.91816217449532e-001 },
 {9.73602922969919e-001, 9.24348681165934e-001, 8.64966146472116e-001, 8.30169982710497e-001, 8.46754999555381e-001, 8.45116574644097e-001, 7.11914333966884e-001, 7.24565935221810e-001, 9.10554260434246e-001, 7.07285967365262e-001, 4.83173603354933e-001 },
 {9.98408186007126e-001, 4.97361418419366e-002, 8.63375882511850e-001, 6.21846677987745e-001, 4.12863249446368e-001, 5.87714802450992e-001, 5.99888200196763e-001, 7.76907315919651e-001, 5.13264460123068e-001, 4.06154512019315e-001, 8.27076652246073e-001 } 
};

double Over2cc_6_RBF_11_14_2_Vector_SigmasInv2[14]={ -2.62772381421401e+000, -1.32491056610161e+000, -3.76794641303150e+000, -2.60435825686090e+000, -2.54227918529039e+000, -3.76794641303150e+000, -2.62772381421401e+000, -3.76099150995104e+000, -1.88998567983438e+000, -3.76099150995104e+000, -2.40014458656300e+000, -1.69966781300487e+000, -2.59041771905455e+000, -9.22464858163150e-001 };

double Over2cc_6_RBF_11_14_2_normalizer[14]={ -9.82365363514516e-001, -4.74861709283947e+000, 9.99901370430755e-001, -1.03148975339487e+000, -1.16417889567930e+000, 9.99901370430755e-001, -9.82365363514516e-001, 9.89740049348212e-001, -2.79488348487429e+000, 9.89740049348212e-001, -1.48060498249741e+000, -3.37863381897598e+000, -1.06100907909655e+000, -6.73989736075859e+000 };

double Over2cc_6_RBF_11_14_2_NormSqd(double* data,long length,int centerid)
{
  double sum = 0.0;
  long i;
	for(i=0; i<length; i++) {sum += (*(data+(centerid*length)+i)) * (*(data+(centerid*length)+i));}
  return sum;
}

void Over2cc_6_RBF_11_14_2_ComputeActivations(double* in,double* hid)
{
  double diff2;
  long i,j;
 	for(i=0; i<14; i++)
  {
    diff2=0.0;
    for(j=0;j<11; j++)
       diff2+=(Over2cc_6_RBF_11_14_2_radial_centers[i][j]-in[j])*(Over2cc_6_RBF_11_14_2_radial_centers[i][j]-in[j]);
    hid[i] = exp(Over2cc_6_RBF_11_14_2_normalizer[i] + diff2*Over2cc_6_RBF_11_14_2_Vector_SigmasInv2[i]);
  }
}

double Over2cc_6_RBF_11_14_2_max_input[11]={ 9.99958329432000e-001, 9.94505657234667e-001, 9.81000941145667e-001, 9.77249757356000e-001, 7.56346456271333e+000, 6.80611365125667e+000, 6.08511856610667e+000, 9.76903355877333e-001, 7.09083526106000e+000, 4.97958375536000e-001, 8.06335210109333e-001 };

double Over2cc_6_RBF_11_14_2_min_input[11]={ 9.07570890327000e-001, 9.44650005130667e-001, 8.06267137025000e-001, 8.22841769254000e-001, 5.86068628775333e+000, 5.13742515665000e+000, 4.01210318245333e+000, 7.31203984050667e-001, 4.93424538709667e+000, 3.13060595095333e-001, 3.12766281606667e-001 };

double Over2cc_6_RBF_11_14_2_input[11];
double Over2cc_6_RBF_11_14_2_hidden[14];
double Over2cc_6_RBF_11_14_2_output[2];

double Over2cc_6_RBF_11_14_2_MeanInputs[11]={ 9.95162114251585e-001, 9.73127748552063e-001, 9.40878102187135e-001, 9.25104787935739e-001, 6.80160489106444e+000, 6.13033404751014e+000, 5.15109253864092e+000, 8.47882026592947e-001, 6.21245045143614e+000, 4.40009626845691e-001, 6.49807676291053e-001 };

void Over2cc_6_RBF_11_14_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over2cc_6_RBF_11_14_2_max_input[i]-Over2cc_6_RBF_11_14_2_min_input[i]);
	input[i] = minimum - delta*Over2cc_6_RBF_11_14_2_min_input[i]+ delta*input[i];
 }
}

void Over2cc_6_RBF_11_14_2_Normalise(double out[],long length)
{
  long i, j;
  double sum = 0.0;
  for(i=0; i<length; i++)
  {
   if(out[i]>100)
   {
    out[i] = 1.0;
    j = i;
    for(i=0; i<length; i++)
    {
     if(i!=j) out[i] = 0.0;
    }
    break;
   }
   else out[i] = exp(out[i]);
  }
  for(i=0; i<length; i++)
  {
   sum += out[i];
  }
  for(i=0; i<length; i++)
  {
   out[i] = out[i]/sum;
  }
}

void Over2cc_6_RBF_11_14_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
   }
}

void Over2cc_6_RBF_11_14_2_RunNeuralNet_Classification () 
{
  Over2cc_6_RBF_11_14_2_ComputeActivations(Over2cc_6_RBF_11_14_2_input,Over2cc_6_RBF_11_14_2_hidden);
  Over2cc_6_RBF_11_14_2_ComputeFeedForwardSignals((double*)Over2cc_6_RBF_11_14_2_hidden_output_wts,Over2cc_6_RBF_11_14_2_hidden,Over2cc_6_RBF_11_14_2_output,Over2cc_6_RBF_11_14_2_output_bias,14, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-LLLglcmImc2): ");
	scanf("%lg",&Over2cc_6_RBF_11_14_2_input[0]);
	printf("%s","Cont. Input-1(originalglcmIdmn): ");
	scanf("%lg",&Over2cc_6_RBF_11_14_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-LHHglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_6_RBF_11_14_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-HHHglcmIdn): ");
	scanf("%lg",&Over2cc_6_RBF_11_14_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-LLHglszmZoneEntropy): ");
	scanf("%lg",&Over2cc_6_RBF_11_14_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-HLLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_6_RBF_11_14_2_input[5]);
	printf("%s","Cont. Input-6(originalglrlmRunEntropy): ");
	scanf("%lg",&Over2cc_6_RBF_11_14_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-HHHglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_6_RBF_11_14_2_input[7]);
	printf("%s","Cont. Input-8(wavelet-LLHglcmSumEntropy): ");
	scanf("%lg",&Over2cc_6_RBF_11_14_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-HHLglcmInverseVariance): ");
	scanf("%lg",&Over2cc_6_RBF_11_14_2_input[9]);
	printf("%s","Cont. Input-10(originalshapeSphericity): ");
	scanf("%lg",&Over2cc_6_RBF_11_14_2_input[10]);
	for(cont_inps=0;cont_inps<11;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over2cc_6_RBF_11_14_2_input[cont_inps] == -9999)
	  Over2cc_6_RBF_11_14_2_input[cont_inps]=Over2cc_6_RBF_11_14_2_MeanInputs[cont_inps];
	}
    Over2cc_6_RBF_11_14_2_ScaleInputs(Over2cc_6_RBF_11_14_2_input,0,1,11);
	Over2cc_6_RBF_11_14_2_RunNeuralNet_Classification();
   //Normalise output if output activation is not Softmax;
 	Over2cc_6_RBF_11_14_2_Normalise(Over2cc_6_RBF_11_14_2_output,2);
	for(i=0;i<2;i++)
	{
      if(max<Over2cc_6_RBF_11_14_2_output[i])
      {
        max=Over2cc_6_RBF_11_14_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

