//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over2cc_7_MLP_22_18_2_input_hidden_weights[18][22]=
{
 {-3.51552476799872e-003, -8.98699886067091e-002, 1.15153497729583e-001, 7.92527934766186e-001, 4.76629414992851e-001, 9.83731706518252e-003, -8.94936506164841e-001, -4.10068383857239e-001, -6.63793812576924e-001, -4.91831632108408e-001, 1.51638225795214e-001, 1.01441543400315e-002, 5.67046227608169e-002, -1.63478922555182e-001, 4.47173984000339e-001, 1.19801254775115e-001, 1.01080709565465e+000, -1.20947403847688e-001, 3.95936948675471e-001, -2.01904950908187e-001, -2.61024273682194e-001, 6.20886156389405e-001 },
 {-1.31497665709310e+000, -1.48620092392034e+000, -2.86728985065473e+000, 1.15583248568823e+000, -1.16931596989748e-001, 1.65542215070668e+000, -2.57162826036494e+000, 1.61664068791614e+000, -2.53519356095437e+000, 2.14978210198869e-001, 6.65890304124784e-001, 4.25459987193227e+000, -1.96956943978715e-001, 1.21848295056295e+000, -1.57239163305410e+000, 1.16195693789935e+000, 3.93810155653587e+000, -2.45289409855160e+000, 2.94701824465737e+000, -5.48576269195737e-002, 5.86524494196556e-001, 3.10179029815825e+000 },
 {-6.59362790020143e-001, -6.33796848212373e-001, -1.91620230222119e+000, -9.22984509377852e-001, -1.04011232747115e+000, 1.05304006475102e+000, 4.25753249651087e-001, 1.86145272006484e+000, 9.86097855158845e-002, 1.14946971737043e+000, 1.43329799247851e-001, 2.50191302528834e+000, -1.92027975516341e-001, 9.79993015383054e-001, -1.78846782363076e+000, 4.43736048682560e-001, 1.03911837957640e-001, -1.16626683984448e+000, 9.13624166201185e-001, 4.31781627300612e-001, 8.17092641889847e-001, 6.05120882330245e-001 },
 {1.20491497595115e+000, 7.88802130133828e-001, 4.18715387924393e+000, 4.06878678904285e+000, 3.55707716481175e+000, -2.33354302772251e+000, -3.67000274496249e+000, -5.51029506232802e+000, -2.46395937278820e+000, -3.96041872391200e+000, -1.90625569332556e-001, -5.30152191413389e+000, 5.06358537749412e-001, -2.50908542853183e+000, 4.86616336489018e+000, -1.02247217141915e+000, 2.72399231160750e+000, 1.94236068701703e+000, -8.11099818821665e-001, -1.75032682297233e+000, -2.22799379634502e+000, 1.90465090678002e-001 },
 {8.39011847003534e-001, 4.30477297113838e-001, 3.95056405205638e+000, 4.94235955330242e+000, 4.01934246534975e+000, -2.31285126930840e+000, -4.89238561368255e+000, -5.86430186635567e+000, -3.67939362224735e+000, -4.49308806729254e+000, -3.31006118274545e-002, -4.76570626987033e+000, 4.76909782697606e-001, -2.51377146856738e+000, 4.99891501746305e+000, -8.59038034073799e-001, 4.20880292227097e+000, 1.34052384136463e+000, -1.85539175366070e-001, -2.14525732073135e+000, -2.40862802476357e+000, 9.94553231243520e-001 },
 {2.05440604337537e-001, 3.46483971860583e-001, -3.38485795193736e-001, -2.24285637585917e+000, -1.45117430847463e+000, 1.44777714654410e-001, 2.70851994203734e+000, 1.36940886467356e+000, 2.19443780581677e+000, 1.49464963996684e+000, -3.52784752786218e-001, 6.44656868426352e-003, -1.53650200867579e-001, 4.65813626892661e-001, -1.23099977896093e+000, -1.99861818751946e-001, -3.00083226209422e+000, 4.62944274689540e-001, -1.02804875433769e+000, 7.28235031952032e-001, 6.96900531130369e-001, -1.60303534757650e+000 },
 {3.88976700842484e-001, 2.50031133097235e-001, 1.31988641858682e+000, 1.17213731428705e+000, 1.08398600747295e+000, -7.54716572225359e-001, -1.00394959861470e+000, -1.71501356975511e+000, -7.01352112601825e-001, -1.17352615951028e+000, -8.73969078615535e-002, -1.70440876608937e+000, 1.53291514819859e-001, -8.05523990199508e-001, 1.43806676082893e+000, -3.37044143308352e-001, 7.15622455203536e-001, 6.29689099207794e-001, -3.25751822116999e-001, -5.46956574076861e-001, -6.84827144714477e-001, -6.56734227626449e-002 },
 {-1.29043994670205e+000, -1.19567872851428e+000, -3.95717515784768e+000, -2.01127235256332e+000, -2.25333772731271e+000, 2.32479079436755e+000, 1.06510141169376e+000, 4.26532333758762e+000, 4.33171254237735e-001, 2.52024037954433e+000, 4.81088172698411e-001, 5.30470696211574e+000, -3.58451480577382e-001, 2.12654204297809e+000, -3.74570700511458e+000, 1.19407660462873e+000, 1.54593140776680e-001, -2.28216600456560e+000, 1.89995970169335e+000, 1.15838649128773e+000, 1.69394192568909e+000, 1.44003311602818e+000 },
 {3.17825339300436e-002, 8.08779989159136e-002, 9.86671120725037e-001, 1.47628842601902e+000, 1.14211139246133e+000, -8.13098669606699e-001, -1.50765879307800e+000, -1.75330436925967e+000, -1.24728696365250e+000, -1.32454861745355e+000, 4.33992702304099e-002, -1.21305070435113e+000, 7.85148478545458e-002, -6.94847767776294e-001, 1.29288486211416e+000, -2.21941856893445e-001, 1.33476689701521e+000, 1.41755423210806e-001, 8.57991515053878e-002, -7.72500654674554e-001, -7.33675123129547e-001, 2.56826511937611e-001 },
 {5.96193287656606e-001, 2.26532872214929e-001, 2.72914408661937e+000, 3.79693445754379e+000, 2.96452421684205e+000, -1.47890090773926e+000, -3.84149311777118e+000, -4.08115714114004e+000, -2.80957828584080e+000, -3.25654716044269e+000, 7.34734245129648e-002, -3.09983578127896e+000, 3.18911896271261e-001, -1.78255424759672e+000, 3.61821069357637e+000, -4.70871732749192e-001, 3.47816835364664e+000, 8.91678981155419e-001, 1.63525082032158e-001, -1.47995443573929e+000, -1.75516565937648e+000, 1.09173232513015e+000 },
 {1.39208018438772e+000, 1.28279728445357e+000, 4.62236576603061e+000, 3.05422764267097e+000, 3.07847803953069e+000, -2.74373158841221e+000, -2.08283582706513e+000, -5.24491459837195e+000, -1.18603689482026e+000, -3.42068543616153e+000, -3.51094304307518e-001, -6.03564607274265e+000, 4.43885747098053e-001, -2.56278088724134e+000, 4.68534838817309e+000, -1.21151342954416e+000, 8.01042011821670e-001, 2.47924441272178e+000, -1.88627241498696e+000, -1.52293474696205e+000, -2.19291790431369e+000, -1.07840302831538e+000 },
 {-1.65572814932448e+000, -1.28189792818065e+000, -5.99595139127457e+000, -5.41044896918987e+000, -4.81136916812507e+000, 3.42252359719195e+000, 4.57222612150707e+000, 7.56567482602015e+000, 3.01087151964520e+000, 5.33319546009862e+000, 2.18890345655840e-001, 7.53872113207798e+000, -7.08008883776387e-001, 3.52855742661686e+000, -6.69936446549402e+000, 1.39755269949273e+000, -3.14958978436460e+000, -2.80790907307629e+000, 1.48722504680267e+000, 2.42500123120123e+000, 3.17595495132494e+000, 1.71016715584320e-001 },
 {-2.08324175563510e+000, -1.67599101044392e+000, -8.17628559999681e+000, -7.94004059990624e+000, -6.93717624273806e+000, 4.86711826676229e+000, 6.90996527455711e+000, 1.07328856013471e+001, 4.76197636266016e+000, 7.63623984443989e+000, 2.44384176557440e-001, 1.02360593851396e+001, -9.34091370557704e-001, 4.93630467407772e+000, -9.35904700484694e+000, 1.84400950156162e+000, -5.12030394829347e+000, -3.59179584682252e+000, 1.79094540824556e+000, 3.60547795662097e+000, 4.52352640498069e+000, -1.21504558303245e-001 },
 {-3.83749773431502e-001, -7.38849463217961e-002, -2.44416737940321e+000, -4.18487941835137e+000, -3.08426844352315e+000, 1.38343677414498e+000, 4.39973806472766e+000, 4.17153786538326e+000, 3.41419543247201e+000, 3.41988522494790e+000, -1.85139963610419e-001, 2.71110258287251e+000, -3.45269683215111e-001, 1.70307964724929e+000, -3.60880469543701e+000, 3.43182339992977e-001, -4.19996725139572e+000, -5.46967879267642e-001, -5.53626893928903e-001, 1.65293564041595e+000, 1.80417060512555e+000, -1.55169508964900e+000 },
 {-5.94368917893375e-001, -5.59604011461200e-001, -2.24983869668969e+000, -1.86670716022893e+000, -1.68878575611194e+000, 1.31331108244218e+000, 1.45692294181137e+000, 2.68390681286132e+000, 9.03466659905705e-001, 1.83992113092501e+000, 1.11200430976789e-001, 2.87345447354716e+000, -2.28304100857771e-001, 1.32738433427838e+000, -2.45220085038147e+000, 5.42392317652895e-001, -9.12039407784965e-001, -1.11385194468616e+000, 7.09861167687396e-001, 8.33132597004055e-001, 1.19430545849769e+000, 2.00148820352335e-001 },
 {1.41488636183565e+000, 1.37055515396711e+000, 4.14064582064431e+000, 1.40365690040527e+000, 1.88910679626934e+000, -2.51806577927947e+000, -2.47761379790532e-001, -4.16875728762307e+000, 2.61732236410032e-001, -2.30362221058572e+000, -6.52213619018010e-001, -5.78011171653717e+000, 2.87981459140852e-001, -2.19632221912701e+000, 3.57442833873196e+000, -1.42720176936882e+000, -1.23418808497969e+000, 2.61524145486020e+000, -2.41446413660652e+000, -1.00139943543013e+000, -1.65247150495455e+000, -2.13534609060574e+000 },
 {8.14459758792409e-003, 1.16504848328965e-001, -3.51120339953734e-001, -1.30547569762085e+000, -9.16593829736962e-001, 1.79827123249344e-001, 1.49026203332491e+000, 9.10444075661547e-001, 1.13426143652918e+000, 8.90172721766314e-001, -2.03974336792258e-001, 2.23476286480290e-001, -6.26977152420284e-002, 3.56441082615225e-001, -8.51401827060644e-001, -1.49001952021542e-001, -1.62903874790197e+000, 1.51224081031863e-001, -4.73498243946545e-001, 4.37012211406739e-001, 4.42298269448375e-001, -8.27030453140874e-001 },
 {1.31750754703767e+000, 1.02792897864684e+000, 4.65951183743238e+000, 3.88341710072547e+000, 3.56979921948559e+000, -2.70854181301675e+000, -3.23923152061114e+000, -5.88977179392938e+000, -2.08799498763633e+000, -4.00956185163957e+000, -2.85160348374183e-001, -6.01083820738285e+000, 5.06898157190095e-001, -2.73347236435816e+000, 5.08375503416814e+000, -1.19665668505512e+000, 2.07956680458397e+000, 2.27528294270502e+000, -1.34469273768857e+000, -1.82507820829383e+000, -2.35570903321762e+000, -3.71884449395009e-001 } 
};

double Over2cc_7_MLP_22_18_2_hidden_bias[18]={ 4.11534375845312e-001, 1.65992279859392e+000, 1.27272416922952e-001, 9.26152903821183e-001, 1.36054378618218e+000, -1.13598685674085e+000, 1.89432226857842e-001, 2.83645101517346e-001, 3.14874694476823e-001, 1.25819095700372e+000, 2.71144535652951e-002, -9.03961699590718e-001, -1.43573585485237e+000, -1.54450276154200e+000, -2.45925668765054e-001, -7.35505863193840e-001, -5.83414476039663e-001, 5.58302287304593e-001 };

double Over2cc_7_MLP_22_18_2_hidden_output_wts[2][18]=
{
 {8.54656962131559e-001, 6.44388633316160e+000, 1.43943675829272e+000, 2.08912447406513e+000, 4.32545838088384e+000, -3.46470302918961e+000, 4.98364918679633e-001, 1.60806199659218e+000, 1.85293145514901e+000, 3.34098655865402e+000, -1.01568498381325e+000, -1.57658950387324e+000, -3.30261977780933e+000, -4.69980307198986e+000, 5.86416495357868e-003, -2.96941586426863e+000, -1.62705103322282e+000, 1.18202991557497e+000 },
 {-9.56700170893559e-001, -6.36456102732869e+000, -1.37477983517679e+000, -2.62806395973393e+000, -4.30441002291312e+000, 3.43164216012985e+000, -5.02008526834593e-001, -1.56880532906919e+000, -1.26367885370262e+000, -3.60390283510801e+000, 1.12353536104477e+000, 1.74618893170136e+000, 3.04637113594383e+000, 4.79298772572957e+000, -4.52733009279182e-002, 3.14680227635357e+000, 1.52662772982935e+000, -1.41037491735462e+000 }
};

double Over2cc_7_MLP_22_18_2_output_bias[2]={ 9.40473369247953e-001, 7.62560978286880e-002 };

double Over2cc_7_MLP_22_18_2_max_input[22]={ 9.94225622500000e-001, 9.96754273526000e-001, 9.97102711270667e-001, 9.95170697016667e-001, 9.97911037399333e-001, 9.99977398435000e-001, 9.78343830095000e-001, 9.91579149548667e-001, 9.51627339487000e-001, 6.77785077092000e+000, 6.81794634845333e+000, 6.09698918942000e+000, 7.05260550610667e+000, 1.91273776273333e+000, 8.65563457626667e-001, 6.42679814845667e+000, 6.07940450162667e+000, 9.96854540307667e-001, 2.12815921118000e+000, 4.99555750214000e-001, 4.87575136096667e+000, 7.77973268702667e-001 };

double Over2cc_7_MLP_22_18_2_min_input[22]={ 9.51458841268667e-001, 9.57705102447333e-001, 9.38441273251000e-001, 9.33755227989000e-001, 9.57500458124000e-001, 8.14424454238667e-001, 8.66181001041000e-001, 8.57150687641000e-001, 7.33377997593000e-001, 5.36721515213000e+000, 5.21295757638667e+000, 4.52158193725667e+000, 5.46910956128333e+000, 1.01570920883333e+000, 5.96739362359667e-001, 4.23179759442333e+000, 3.90952828744333e+000, 6.35162254726333e-001, 1.04925532510333e+000, 2.44262934234000e-001, 3.00348783322667e+000, 3.12766281606667e-001 };

double Over2cc_7_MLP_22_18_2_input[22];
double Over2cc_7_MLP_22_18_2_hidden[18];
double Over2cc_7_MLP_22_18_2_output[2];

double Over2cc_7_MLP_22_18_2_MeanInputs[22]={ 9.86215974880607e-001, 9.79769865419318e-001, 9.77174969672753e-001, 9.72810897712386e-001, 9.83610133938442e-001, 9.91240682825940e-001, 9.24927041841446e-001, 9.38665182996753e-001, 8.66940461142569e-001, 5.95974044334588e+000, 6.07191804257450e+000, 5.28713197315846e+000, 6.21968357680817e+000, 1.06412944461019e+000, 7.31393955181164e-001, 5.55638946377131e+000, 4.93827896731921e+000, 8.93468219422401e-001, 1.17054459403813e+000, 4.40861350465457e-001, 3.91359149242479e+000, 6.50102625908682e-001 };

void Over2cc_7_MLP_22_18_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over2cc_7_MLP_22_18_2_max_input[i]-Over2cc_7_MLP_22_18_2_min_input[i]);
	input[i] = minimum - delta*Over2cc_7_MLP_22_18_2_min_input[i]+ delta*input[i];
 }
}

double Over2cc_7_MLP_22_18_2_logistic(double x)
{
  if(x > 100.0) x = 1.0;
  else if (x < -100.0) x = 0.0;
  else x = 1.0/(1.0+exp(-x));
  return x;
}

void Over2cc_7_MLP_22_18_2_Normalise(double out[],long length)
{
  long i, j;
  double sum = 0.0;
  for(i=0; i<length; i++)
  {
   if(out[i]>100)
   {
    out[i] = 1.0;
    j = i;
    for(i=0; i<length; i++)
    {
     if(i!=j) out[i] = 0.0;
    }
    break;
   }
   else out[i] = exp(out[i]);
  }
  for(i=0; i<length; i++)
  {
   sum += out[i];
  }
  for(i=0; i<length; i++)
  {
   out[i] = out[i]/sum;
  }
}

void Over2cc_7_MLP_22_18_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==1) V_OUT[row] = Over2cc_7_MLP_22_18_2_logistic(V_OUT[row]);
   }
}

void Over2cc_7_MLP_22_18_2_RunNeuralNet_Classification () 
{
  Over2cc_7_MLP_22_18_2_ComputeFeedForwardSignals((double*)Over2cc_7_MLP_22_18_2_input_hidden_weights,Over2cc_7_MLP_22_18_2_input,Over2cc_7_MLP_22_18_2_hidden,Over2cc_7_MLP_22_18_2_hidden_bias,22, 18,0);
  Over2cc_7_MLP_22_18_2_ComputeFeedForwardSignals((double*)Over2cc_7_MLP_22_18_2_hidden_output_wts,Over2cc_7_MLP_22_18_2_hidden,Over2cc_7_MLP_22_18_2_output,Over2cc_7_MLP_22_18_2_output_bias,18, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-LLLglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[0]);
	printf("%s","Cont. Input-1(wavelet-LHLglcmIdmn): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-HLHglcmIdmn): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-LHHglcmIdmn): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-HHLglcmIdmn): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-LLHglcmImc2): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[5]);
	printf("%s","Cont. Input-6(wavelet-HHHglcmIdn): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-HLHglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[7]);
	printf("%s","Cont. Input-8(wavelet-LLHglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-LHLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[9]);
	printf("%s","Cont. Input-10(wavelet-HLLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[10]);
	printf("%s","Cont. Input-11(wavelet-HHLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[11]);
	printf("%s","Cont. Input-12(wavelet-LLHglrlmRunEntropy): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[12]);
	printf("%s","Cont. Input-13(wavelet-LLHglrlmLongRunEmphasis): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[13]);
	printf("%s","Cont. Input-14(originalglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[14]);
	printf("%s","Cont. Input-15(wavelet-LHHglszmZoneEntropy): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[15]);
	printf("%s","Cont. Input-16(wavelet-LLLglcmDifferenceEntropy): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[16]);
	printf("%s","Cont. Input-17(wavelet-LLLglcmMCC): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[17]);
	printf("%s","Cont. Input-18(originalglrlmLongRunEmphasis): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[18]);
	printf("%s","Cont. Input-19(wavelet-HHLglcmInverseVariance): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[19]);
	printf("%s","Cont. Input-20(originalglcmDifferenceEntropy): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[20]);
	printf("%s","Cont. Input-21(originalshapeSphericity): ");
	scanf("%lg",&Over2cc_7_MLP_22_18_2_input[21]);
	for(cont_inps=0;cont_inps<22;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over2cc_7_MLP_22_18_2_input[cont_inps] == -9999)
	  Over2cc_7_MLP_22_18_2_input[cont_inps]=Over2cc_7_MLP_22_18_2_MeanInputs[cont_inps];
	}
    Over2cc_7_MLP_22_18_2_ScaleInputs(Over2cc_7_MLP_22_18_2_input,0,1,22);
	Over2cc_7_MLP_22_18_2_RunNeuralNet_Classification();
   //Normalise output if output activation is not Softmax;
 	Over2cc_7_MLP_22_18_2_Normalise(Over2cc_7_MLP_22_18_2_output,2);
	for(i=0;i<2;i++)
	{
      if(max<Over2cc_7_MLP_22_18_2_output[i])
      {
        max=Over2cc_7_MLP_22_18_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

