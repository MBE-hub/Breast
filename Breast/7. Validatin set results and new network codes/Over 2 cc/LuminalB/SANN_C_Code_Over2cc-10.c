//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over2cc_10_MLP_22_11_2_input_hidden_weights[11][22]=
{
 {8.25575232531824e-001, 1.07591884922423e+000, 4.14069801374122e+000, 1.30634622953712e+000, 2.03976375855720e+000, -2.17835767427449e+000, -5.69227648452790e-001, -3.87575258651221e+000, -5.80640206708325e-002, -2.60172500930544e+000, -6.84520118022200e-001, -5.59388235055544e+000, 4.00084404499593e-002, -2.13787333604686e+000, 3.34312203688340e+000, -1.90651270816411e+000, -4.82543388425993e-001, 2.49940173146764e+000, -1.97667610287820e+000, -8.61083927680786e-001, -1.90010640154757e+000, -2.25742589814964e+000 },
 {6.97103427586428e-001, 5.13918034819383e-001, 3.32021948888527e+000, 4.17685611888425e+000, 3.05121689524895e+000, -3.05082777608243e+000, -4.21097568358677e+000, -5.95296601740226e+000, -3.35902215777460e+000, -3.92577860484404e+000, -1.59259988959205e-001, -4.95384545175986e+000, 3.07632573057553e-001, -2.36769676057204e+000, 4.32309424453328e+000, -6.87688476052311e-001, 2.64916619917599e+000, 7.43428495908837e-001, -6.62433274415288e-001, -2.35130440995911e+000, -2.41674409694576e+000, 3.91715970142669e-001 },
 {2.38879228679806e+000, 1.95641054250435e+000, 9.50340576181153e+000, 7.93012523404583e+000, 7.03967639397292e+000, -6.51945226439091e+000, -7.05542255520350e+000, -1.28399965961415e+001, -4.92200489567540e+000, -8.67585470262268e+000, -9.19742614956329e-001, -1.31618005048918e+001, 6.59872498381957e-001, -5.82360691133942e+000, 1.04571361856530e+001, -2.70984839053661e+000, 3.75305266634915e+000, 4.24577796179302e+000, -3.04295490511647e+000, -4.15958134718081e+000, -5.52862389552515e+000, -1.21088511131607e+000 },
 {1.98086153227026e+000, 2.17078090796783e+000, 9.06861398779026e+000, 4.84951772131868e+000, 5.46375804660851e+000, -5.49284247705063e+000, -3.72855009757315e+000, -1.02070850968129e+001, -2.09807586366633e+000, -6.76082985850843e+000, -1.28798609395168e+000, -1.24066521214928e+001, 3.21665431238905e-001, -5.11402622494955e+000, 8.53715189751804e+000, -3.49802984673891e+000, 9.50646235028611e-001, 4.89178210938927e+000, -3.77634661370126e+000, -2.91720498950656e+000, -4.66167658861687e+000, -3.41549738888125e+000 },
 {6.74150165039019e-001, -6.82750049551093e-001, -1.70102923216903e+000, 1.55410698320223e+000, 3.08040527765738e-001, 1.61493342946480e+000, -1.67044325945570e+000, 1.16771715418734e+000, -1.15972896207388e+000, 3.26686011666743e-001, 8.60607571111865e-001, 3.01357028554153e+000, 3.38525691008626e-001, 7.70521679190184e-001, -1.81631281839803e-001, 2.09646548215564e+000, 2.40182352153594e+000, -8.94890111404587e-001, 1.76267629536127e+000, 3.55263659341714e-001, 7.50494908820075e-001, 3.69142518789323e+000 },
 {5.68399879438642e-001, 1.15621284703827e+000, 3.91752162816307e+000, 4.51593039994334e-001, 1.53525856755052e+000, -2.14208498035627e+000, 2.21325110629412e-001, -3.38077935150306e+000, 5.13369079788874e-001, -2.03258921111412e+000, -8.11737032551943e-001, -5.32409210248270e+000, -2.13667821862412e-002, -1.93223996277623e+000, 2.82448708115308e+000, -2.09518123434234e+000, -1.15510092323813e+000, 2.47885065408276e+000, -2.22233931769050e+000, -6.99634683936597e-001, -1.66593550951084e+000, -3.05727046027760e+000 },
 {3.13226054292091e+000, 2.10881702834789e+000, 1.01874431632080e+001, 9.21321065337257e+000, 8.03218925486850e+000, -6.31166043274828e+000, -8.12635679241904e+000, -1.36373674994726e+001, -5.45746501445392e+000, -9.30234065121584e+000, -5.92228252471972e-001, -1.34020066762873e+001, 9.60975464462999e-001, -6.18549230753346e+000, 1.17268259276212e+001, -2.15581256649975e+000, 4.98758846843715e+000, 4.83679833876960e+000, -2.88279246240102e+000, -4.26912166748931e+000, -5.66763455525311e+000, -1.60409216079049e-001 },
 {-4.67807529504900e-001, -1.24773359220761e+000, -3.76083656677937e+000, 1.18416704337543e+000, -7.71752452536878e-001, 1.40921618389241e+000, -2.10363675473250e+000, 1.88796172654298e+000, -2.11276784196997e+000, 1.03616990914004e+000, 9.89014923951812e-001, 4.90773886905816e+000, 1.59644215915986e-001, 1.54908187092452e+000, -1.81304130969215e+000, 2.50041502680389e+000, 2.68980225693075e+000, -2.92914224579235e+000, 2.54533768040156e+000, -1.47079433525105e-001, 1.15876366244863e+000, 4.01147053588902e+000 },
 {3.89436933359955e+000, 2.20358381597982e+000, 1.23758834176243e+001, 1.29533632830980e+001, 1.05885868259308e+001, -8.37148543106441e+000, -1.20817728444451e+001, -1.80442744974902e+001, -8.38747227149091e+000, -1.25275845295377e+001, -6.52725825803526e-001, -1.67495923289005e+001, 1.19192526778883e+000, -7.86815821393190e+000, 1.51319630080126e+001, -2.17616828206095e+000, 7.65974464270676e+000, 5.32845691051907e+000, -3.01151713518383e+000, -6.08631907837482e+000, -7.50986959250158e+000, 1.26572526110474e+000 },
 {2.09521559900119e+000, 1.64804375565039e+000, 7.57626732498806e+000, 5.97304288605526e+000, 5.50998185754354e+000, -4.68400349199786e+000, -5.07974286251677e+000, -9.68091115176338e+000, -3.31558398702199e+000, -6.58456536525644e+000, -6.72199160588215e-001, -1.01386264099496e+001, 5.85008901153724e-001, -4.45924151773009e+000, 8.19766925665308e+000, -2.07256145439162e+000, 2.68361004926450e+000, 3.73911108889086e+000, -2.47760226751585e+000, -2.96915418566778e+000, -4.15576768041402e+000, -1.01853075733941e+000 },
 {-2.72847102489237e+000, -1.52311928200999e+000, -8.33280282311526e+000, -8.87190719333656e+000, -7.22624685000195e+000, 5.49727398863228e+000, 8.17259793965985e+000, 1.21022732822642e+001, 5.65374478450750e+000, 8.34329432308237e+000, 3.01741712623005e-001, 1.10688069156850e+001, -9.55961871830365e-001, 5.30877112690898e+000, -1.02481830253987e+001, 1.26125534957502e+000, -5.33357850535657e+000, -3.59696806237429e+000, 1.93177885875767e+000, 3.99780836788059e+000, 4.95055789341309e+000, -1.04015099661826e+000 } 
};

double Over2cc_10_MLP_22_11_2_hidden_bias[11]={ -3.59525037319334e-001, 1.32747531137602e-001, 3.73945120218058e-001, -4.46071196259665e-001, 1.76521336671016e+000, -8.15308113824363e-001, 1.29504767602170e+000, 1.07872751592367e+000, 1.86988272865258e+000, 5.05805627127156e-001, -1.46118465905523e+000 };

double Over2cc_10_MLP_22_11_2_hidden_output_wts[2][11]=
{
 {-4.02442600512173e+000, 4.36077405722681e+000, 2.25600876496572e+000, -4.69349095791484e+000, 6.59611934907835e+000, -6.35390764051332e+000, 2.96756949110252e+000, 9.71183190386948e+000, 8.78788782546077e+000, 3.76167321339433e-001, -5.90380348525272e+000 },
 {4.78823592358039e+000, -3.61663678139770e+000, -1.13738045354025e+000, 4.29236915977815e+000, -5.55894363093162e+000, 5.03363114885710e+000, -3.61207844455097e+000, -8.61520072208525e+000, -7.63932651559270e+000, -4.46838764146542e-001, 5.74706643231891e+000 }
};

double Over2cc_10_MLP_22_11_2_output_bias[2]={ 6.06222647989174e+000, -1.81467663325833e+000 };

double Over2cc_10_MLP_22_11_2_max_input[22]={ 9.94225622500000e-001, 9.96754273526000e-001, 9.97102711270667e-001, 9.95170697016667e-001, 9.97911037399333e-001, 9.99977398435000e-001, 9.78343830095000e-001, 9.91579149548667e-001, 9.51627339487000e-001, 6.77785077092000e+000, 6.81794634845333e+000, 6.09698918942000e+000, 7.05260550610667e+000, 1.91273776273333e+000, 8.65563457626667e-001, 6.42679814845667e+000, 6.07940450162667e+000, 9.96854540307667e-001, 2.12815921118000e+000, 4.99555750214000e-001, 4.87575136096667e+000, 7.77973268702667e-001 };

double Over2cc_10_MLP_22_11_2_min_input[22]={ 9.51458841268667e-001, 9.57705102447333e-001, 9.38441273251000e-001, 9.33755227989000e-001, 9.57500458124000e-001, 8.14424454238667e-001, 8.66181001041000e-001, 8.57150687641000e-001, 7.33377997593000e-001, 5.36721515213000e+000, 5.21295757638667e+000, 4.52158193725667e+000, 5.46910956128333e+000, 1.01570920883333e+000, 5.96739362359667e-001, 4.23179759442333e+000, 3.90952828744333e+000, 6.35162254726333e-001, 1.04925532510333e+000, 2.44262934234000e-001, 3.00348783322667e+000, 3.12766281606667e-001 };

double Over2cc_10_MLP_22_11_2_input[22];
double Over2cc_10_MLP_22_11_2_hidden[11];
double Over2cc_10_MLP_22_11_2_output[2];

double Over2cc_10_MLP_22_11_2_MeanInputs[22]={ 9.86215974880607e-001, 9.79769865419318e-001, 9.77174969672753e-001, 9.72810897712386e-001, 9.83610133938442e-001, 9.91240682825940e-001, 9.24927041841446e-001, 9.38665182996753e-001, 8.66940461142569e-001, 5.95974044334588e+000, 6.07191804257450e+000, 5.28713197315846e+000, 6.21968357680817e+000, 1.06412944461019e+000, 7.31393955181164e-001, 5.55638946377131e+000, 4.93827896731921e+000, 8.93468219422401e-001, 1.17054459403813e+000, 4.40861350465457e-001, 3.91359149242479e+000, 6.50102625908682e-001 };

void Over2cc_10_MLP_22_11_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over2cc_10_MLP_22_11_2_max_input[i]-Over2cc_10_MLP_22_11_2_min_input[i]);
	input[i] = minimum - delta*Over2cc_10_MLP_22_11_2_min_input[i]+ delta*input[i];
 }
}

double Over2cc_10_MLP_22_11_2_logistic(double x)
{
  if(x > 100.0) x = 1.0;
  else if (x < -100.0) x = 0.0;
  else x = 1.0/(1.0+exp(-x));
  return x;
}

void Over2cc_10_MLP_22_11_2_Normalise(double out[],long length)
{
  long i, j;
  double sum = 0.0;
  for(i=0; i<length; i++)
  {
   if(out[i]>100)
   {
    out[i] = 1.0;
    j = i;
    for(i=0; i<length; i++)
    {
     if(i!=j) out[i] = 0.0;
    }
    break;
   }
   else out[i] = exp(out[i]);
  }
  for(i=0; i<length; i++)
  {
   sum += out[i];
  }
  for(i=0; i<length; i++)
  {
   out[i] = out[i]/sum;
  }
}

void Over2cc_10_MLP_22_11_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==1) V_OUT[row] = Over2cc_10_MLP_22_11_2_logistic(V_OUT[row]);
   }
}

void Over2cc_10_MLP_22_11_2_RunNeuralNet_Classification () 
{
  Over2cc_10_MLP_22_11_2_ComputeFeedForwardSignals((double*)Over2cc_10_MLP_22_11_2_input_hidden_weights,Over2cc_10_MLP_22_11_2_input,Over2cc_10_MLP_22_11_2_hidden,Over2cc_10_MLP_22_11_2_hidden_bias,22, 11,0);
  Over2cc_10_MLP_22_11_2_ComputeFeedForwardSignals((double*)Over2cc_10_MLP_22_11_2_hidden_output_wts,Over2cc_10_MLP_22_11_2_hidden,Over2cc_10_MLP_22_11_2_output,Over2cc_10_MLP_22_11_2_output_bias,11, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-LLLglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[0]);
	printf("%s","Cont. Input-1(wavelet-LHLglcmIdmn): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-HLHglcmIdmn): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-LHHglcmIdmn): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-HHLglcmIdmn): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-LLHglcmImc2): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[5]);
	printf("%s","Cont. Input-6(wavelet-HHHglcmIdn): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-HLHglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[7]);
	printf("%s","Cont. Input-8(wavelet-LLHglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-LHLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[9]);
	printf("%s","Cont. Input-10(wavelet-HLLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[10]);
	printf("%s","Cont. Input-11(wavelet-HHLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[11]);
	printf("%s","Cont. Input-12(wavelet-LLHglrlmRunEntropy): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[12]);
	printf("%s","Cont. Input-13(wavelet-LLHglrlmLongRunEmphasis): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[13]);
	printf("%s","Cont. Input-14(originalglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[14]);
	printf("%s","Cont. Input-15(wavelet-LHHglszmZoneEntropy): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[15]);
	printf("%s","Cont. Input-16(wavelet-LLLglcmDifferenceEntropy): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[16]);
	printf("%s","Cont. Input-17(wavelet-LLLglcmMCC): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[17]);
	printf("%s","Cont. Input-18(originalglrlmLongRunEmphasis): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[18]);
	printf("%s","Cont. Input-19(wavelet-HHLglcmInverseVariance): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[19]);
	printf("%s","Cont. Input-20(originalglcmDifferenceEntropy): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[20]);
	printf("%s","Cont. Input-21(originalshapeSphericity): ");
	scanf("%lg",&Over2cc_10_MLP_22_11_2_input[21]);
	for(cont_inps=0;cont_inps<22;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over2cc_10_MLP_22_11_2_input[cont_inps] == -9999)
	  Over2cc_10_MLP_22_11_2_input[cont_inps]=Over2cc_10_MLP_22_11_2_MeanInputs[cont_inps];
	}
    Over2cc_10_MLP_22_11_2_ScaleInputs(Over2cc_10_MLP_22_11_2_input,0,1,22);
	Over2cc_10_MLP_22_11_2_RunNeuralNet_Classification();
   //Normalise output if output activation is not Softmax;
 	Over2cc_10_MLP_22_11_2_Normalise(Over2cc_10_MLP_22_11_2_output,2);
	for(i=0;i<2;i++)
	{
      if(max<Over2cc_10_MLP_22_11_2_output[i])
      {
        max=Over2cc_10_MLP_22_11_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

