//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over2cc_4_MLP_22_13_2_input_hidden_weights[13][22]=
{
 {1.19664064757257e+000, 1.04961782619819e+000, 5.34791801161341e+000, 5.31351852103912e+000, 4.75476768238459e+000, -3.23879957603507e+000, -4.70035924884371e+000, -7.27212057897874e+000, -3.26606425746190e+000, -5.23736864124783e+000, -5.99819046447871e-002, -6.38753454458602e+000, 8.48958109295938e-001, -3.44570486676826e+000, 6.11115858751201e+000, -1.71414898631945e+000, 3.62378314490742e+000, 2.22953999331967e+000, -1.04227043504592e+000, -2.33327810863403e+000, -3.06093469867286e+000, -3.72918913923691e-003 },
 {8.50308784568903e-001, 7.55676270896509e-001, 2.43000724202794e+000, 1.06359822904814e+000, 1.15774144817006e+000, -1.34992897987804e+000, -3.01291668969317e-001, -2.48274454046447e+000, -1.28403322904965e-001, -1.28915435551969e+000, -3.90373058505821e-001, -3.39079455681612e+000, -7.07018713039782e-002, -1.10336352221489e+000, 2.15666607955401e+000, -5.09759361525467e-001, -3.58333168113706e-001, 1.49538472582200e+000, -1.24868380748339e+000, -5.93210956745992e-001, -8.84116388424272e-001, -1.04766919680016e+000 },
 {2.89629786853265e-002, 5.96250567946178e-002, 6.14165245843569e-001, 1.25542212401844e+000, 1.00778415284294e+000, -4.15139553998500e-001, -1.29333124601967e+000, -1.06604482131578e+000, -8.87143750892096e-001, -1.04599001454524e+000, 1.62371293758400e-001, -4.29206888921702e-001, 3.09104815887849e-001, -5.61736595012768e-001, 1.02227240061424e+000, -2.65466070489264e-001, 1.39740642291807e+000, 6.49561690445270e-003, 2.07121269154366e-001, -4.46206216991325e-001, -4.76073166814237e-001, 4.41269329298379e-001 },
 {-1.99713741101693e+000, -1.70222001657687e+000, -8.93455952529931e+000, -8.93846804218332e+000, -7.98918116049990e+000, 5.30827034425352e+000, 7.99322026963530e+000, 1.20716342206008e+001, 5.55458944097110e+000, 8.77502463311131e+000, 1.29011079633834e-001, 1.04897274421481e+001, -1.41249210534201e+000, 5.76328899956818e+000, -1.01902515498926e+001, 2.76187219830424e+000, -6.25971579082848e+000, -3.58283827678431e+000, 1.61354728159582e+000, 3.82115917709247e+000, 5.10851064979152e+000, -2.02838903499614e-001 },
 {-3.36124604224768e-001, -3.63584073168992e-001, -9.02660316513782e-001, -3.21989826363441e-001, -3.57652384974067e-001, 6.21266980386523e-001, -3.70395951233325e-002, 8.22477802356955e-001, -6.63863015005974e-002, 3.78175938429680e-001, 9.78016927706700e-002, 1.33745696382207e+000, -1.34770259277602e-002, 3.86771993204947e-001, -8.18097441042886e-001, 9.80591431227135e-002, 3.14881399865156e-001, -5.80636569869038e-001, 5.59891664125761e-001, 3.02258622018497e-001, 3.67875113493131e-001, 4.59421270902073e-001 },
 {1.11012309282725e+000, 1.07409176290505e+000, 2.61848821902251e+000, 2.36059742840856e-001, 5.29943715381663e-001, -1.42442872568415e+000, 1.00945362278629e+000, -2.08375569933503e+000, 7.67883924568562e-001, -5.45249057856251e-001, -5.73303143157987e-001, -3.92937764354637e+000, -3.30349044893881e-001, -8.76952203947825e-001, 1.85717158589514e+000, -2.65770954754463e-001, -1.94624804388478e+000, 1.96572842330841e+000, -1.88269636996841e+000, -3.94668897695264e-001, -7.05359579738648e-001, -1.84715698377196e+000 },
 {-1.65744822620199e+000, -1.58309258572670e+000, -5.78444789494803e+000, -3.88632425719657e+000, -3.77670642270178e+000, 3.44149017712673e+000, 2.56777067025644e+000, 6.71113839868845e+000, 1.67892100607082e+000, 4.17121393999101e+000, 4.70185008958783e-001, 7.59585559701798e+000, -3.78744666562056e-001, 3.11482910750528e+000, -5.82039346734196e+000, 1.42313021328888e+000, -1.10888267146552e+000, -3.09040731639676e+000, 2.24436610874310e+000, 2.05032803376154e+000, 2.70182888065373e+000, 1.44667092219453e+000 },
 {-3.84509352590586e-001, -4.28462566117000e-001, -9.83103142275400e-001, -2.05319852831981e-001, -2.84458892368402e-001, 6.14281082436896e-001, -2.96268567449367e-001, 8.03949697241423e-001, -2.79699242664076e-001, 2.61692247361352e-001, 1.74874037512323e-001, 1.48367926223266e+000, 3.90218811630984e-002, 3.53382267888410e-001, -8.49049397350038e-001, 1.29982245722057e-001, 6.24591716746057e-001, -6.80153371466015e-001, 7.52034678513358e-001, 2.65742488355626e-001, 2.85855690394453e-001, 6.82203945003025e-001 },
 {3.31795560777650e-001, 1.36966655706164e-001, 2.15184441688522e+000, 2.96572825730007e+000, 2.55808258116310e+000, -1.15016122809890e+000, -3.12614220336568e+000, -3.42942521117539e+000, -2.26726945276123e+000, -2.87867320679983e+000, 9.59491285339405e-002, -2.02814476677670e+000, 5.34134740168659e-001, -1.69798367002432e+000, 2.76597675290703e+000, -9.45316726582725e-001, 3.00359578406836e+000, 5.97622393436864e-001, 2.80208641583905e-001, -9.99092959293124e-001, -1.43144935099783e+000, 8.50798667474172e-001 },
 {-4.38471961152760e-001, -6.50779969066922e-001, -5.12433868032258e-002, 2.18348014015227e+000, 1.58311698394756e+000, 9.75666174268763e-002, -3.16032195718633e+000, -1.28178487445089e+000, -2.31922918121383e+000, -1.87563796589785e+000, 3.85955657522421e-001, 9.90438629584964e-001, 5.84057282622034e-001, -6.85630785476892e-001, 8.80281489009544e-001, -5.41316454487390e-001, 3.53858074437401e+000, -8.07033189448209e-001, 1.44086106678768e+000, -4.36059576939686e-001, -7.10650569483742e-001, 1.85931692354862e+000 },
 {-1.59662265691363e-001, -1.68103158974200e-001, 2.37352879137150e-001, 1.20032931479769e+000, 8.69249342105915e-001, -2.07283166434718e-001, -1.49983408979132e+000, -8.24345739794061e-001, -1.07118440697010e+000, -1.00252338872460e+000, 2.03781260217779e-001, 1.41866367214345e-001, 3.46186546785877e-001, -4.71440174098260e-001, 6.90079342559279e-001, -2.64858638939523e-001, 1.62317403978245e+000, -2.75432176091365e-001, 5.16220856946522e-001, -3.85457165168781e-001, -5.14618032445408e-001, 7.58132361218152e-001 },
 {-6.68830857165015e-001, -7.60028520495608e-001, -1.22225365414790e+000, 6.62416490318609e-001, 3.01074369969230e-001, 7.36100757076280e-001, -1.63000310851772e+000, 5.31792183491928e-001, -1.24647297214197e+000, -4.39764348372736e-001, 3.85366228419616e-001, 2.19711557461842e+000, 3.21380874097266e-001, 1.69490005441595e-001, -6.03258146538054e-001, -4.06047387323594e-002, 2.21206626117899e+000, -1.24687688350832e+000, 1.45313215965743e+000, 7.41887583669286e-002, 5.32220010393916e-002, 1.56343905106946e+000 },
 {-1.98059616949534e-001, -1.86412059861223e-002, -7.83151553903070e-001, -8.56611685882961e-001, -7.28223003791533e-001, 3.61273730739852e-001, 8.68276962433139e-001, 1.18385345448765e+000, 6.73244015776097e-001, 8.38173278830438e-001, 1.55016821988624e-002, 8.57207238013181e-001, -1.04958042097276e-001, 5.50736627635867e-001, -8.66089115661077e-001, 3.35221770382612e-001, -6.95786961870154e-001, -2.57609392180308e-001, 7.07196754610971e-002, 2.11759491255370e-001, 4.56198754623414e-001, -1.40014790814409e-001 } 
};

double Over2cc_4_MLP_22_13_2_hidden_bias[13]={ 1.16727770148416e+000, -3.42623848892621e-001, 4.90223634263576e-001, -2.09899120990351e+000, 3.00411595139249e-001, -9.81452089030101e-001, 4.88837502232753e-002, 3.96932878111578e-001, 1.27326670606717e+000, 1.66313079865697e+000, 6.77683069843037e-001, 1.11237722986624e+000, -4.09478556503422e-001 };

double Over2cc_4_MLP_22_13_2_hidden_output_wts[2][13]=
{
 {1.88437508556830e+000, -1.25271397005855e+000, 1.05098523806512e+000, -3.31826690301136e+000, 7.82669112446689e-001, -2.97383487681011e+000, 9.33711835248594e-001, 1.01743050592155e+000, 2.71623796023282e+000, 3.97325471353339e+000, 1.57847285067955e+000, 2.88726585282485e+000, -5.97723749299186e-001 },
 {-1.79340376593181e+000, 1.09334909375771e+000, -7.06236929608452e-001, 3.34431457083343e+000, -9.26766862757423e-001, 2.67948242559029e+000, -1.00113918452161e+000, -1.31444045622103e+000, -2.92129080908033e+000, -4.23591888837104e+000, -1.42443686107576e+000, -3.03915402858055e+000, 9.73813339160088e-001 }
};

double Over2cc_4_MLP_22_13_2_output_bias[2]={ 9.46218093631361e-001, -5.77228146724190e-001 };

double Over2cc_4_MLP_22_13_2_max_input[22]={ 9.94225622500000e-001, 9.96754273526000e-001, 9.97102711270667e-001, 9.95170697016667e-001, 9.97911037399333e-001, 9.99977398435000e-001, 9.78343830095000e-001, 9.91579149548667e-001, 9.51627339487000e-001, 6.77785077092000e+000, 6.81794634845333e+000, 6.09698918942000e+000, 7.05260550610667e+000, 1.91273776273333e+000, 8.65563457626667e-001, 6.42679814845667e+000, 6.07940450162667e+000, 9.96854540307667e-001, 2.12815921118000e+000, 4.99555750214000e-001, 4.87575136096667e+000, 7.77973268702667e-001 };

double Over2cc_4_MLP_22_13_2_min_input[22]={ 9.51458841268667e-001, 9.57705102447333e-001, 9.38441273251000e-001, 9.33755227989000e-001, 9.57500458124000e-001, 8.14424454238667e-001, 8.66181001041000e-001, 8.57150687641000e-001, 7.33377997593000e-001, 5.36721515213000e+000, 5.21295757638667e+000, 4.52158193725667e+000, 5.46910956128333e+000, 1.01570920883333e+000, 5.96739362359667e-001, 4.23179759442333e+000, 3.90952828744333e+000, 6.35162254726333e-001, 1.04925532510333e+000, 2.44262934234000e-001, 3.00348783322667e+000, 3.12766281606667e-001 };

double Over2cc_4_MLP_22_13_2_input[22];
double Over2cc_4_MLP_22_13_2_hidden[13];
double Over2cc_4_MLP_22_13_2_output[2];

double Over2cc_4_MLP_22_13_2_MeanInputs[22]={ 9.86215974880607e-001, 9.79769865419318e-001, 9.77174969672753e-001, 9.72810897712386e-001, 9.83610133938442e-001, 9.91240682825940e-001, 9.24927041841446e-001, 9.38665182996753e-001, 8.66940461142569e-001, 5.95974044334588e+000, 6.07191804257450e+000, 5.28713197315846e+000, 6.21968357680817e+000, 1.06412944461019e+000, 7.31393955181164e-001, 5.55638946377131e+000, 4.93827896731921e+000, 8.93468219422401e-001, 1.17054459403813e+000, 4.40861350465457e-001, 3.91359149242479e+000, 6.50102625908682e-001 };

void Over2cc_4_MLP_22_13_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over2cc_4_MLP_22_13_2_max_input[i]-Over2cc_4_MLP_22_13_2_min_input[i]);
	input[i] = minimum - delta*Over2cc_4_MLP_22_13_2_min_input[i]+ delta*input[i];
 }
}

double Over2cc_4_MLP_22_13_2_logistic(double x)
{
  if(x > 100.0) x = 1.0;
  else if (x < -100.0) x = 0.0;
  else x = 1.0/(1.0+exp(-x));
  return x;
}

void Over2cc_4_MLP_22_13_2_Normalise(double out[],long length)
{
  long i, j;
  double sum = 0.0;
  for(i=0; i<length; i++)
  {
   if(out[i]>100)
   {
    out[i] = 1.0;
    j = i;
    for(i=0; i<length; i++)
    {
     if(i!=j) out[i] = 0.0;
    }
    break;
   }
   else out[i] = exp(out[i]);
  }
  for(i=0; i<length; i++)
  {
   sum += out[i];
  }
  for(i=0; i<length; i++)
  {
   out[i] = out[i]/sum;
  }
}

void Over2cc_4_MLP_22_13_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==1) V_OUT[row] = Over2cc_4_MLP_22_13_2_logistic(V_OUT[row]);
   }
}

void Over2cc_4_MLP_22_13_2_RunNeuralNet_Classification () 
{
  Over2cc_4_MLP_22_13_2_ComputeFeedForwardSignals((double*)Over2cc_4_MLP_22_13_2_input_hidden_weights,Over2cc_4_MLP_22_13_2_input,Over2cc_4_MLP_22_13_2_hidden,Over2cc_4_MLP_22_13_2_hidden_bias,22, 13,0);
  Over2cc_4_MLP_22_13_2_ComputeFeedForwardSignals((double*)Over2cc_4_MLP_22_13_2_hidden_output_wts,Over2cc_4_MLP_22_13_2_hidden,Over2cc_4_MLP_22_13_2_output,Over2cc_4_MLP_22_13_2_output_bias,13, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-LLLglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[0]);
	printf("%s","Cont. Input-1(wavelet-LHLglcmIdmn): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-HLHglcmIdmn): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-LHHglcmIdmn): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-HHLglcmIdmn): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-LLHglcmImc2): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[5]);
	printf("%s","Cont. Input-6(wavelet-HHHglcmIdn): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-HLHglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[7]);
	printf("%s","Cont. Input-8(wavelet-LLHglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-LHLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[9]);
	printf("%s","Cont. Input-10(wavelet-HLLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[10]);
	printf("%s","Cont. Input-11(wavelet-HHLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[11]);
	printf("%s","Cont. Input-12(wavelet-LLHglrlmRunEntropy): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[12]);
	printf("%s","Cont. Input-13(wavelet-LLHglrlmLongRunEmphasis): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[13]);
	printf("%s","Cont. Input-14(originalglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[14]);
	printf("%s","Cont. Input-15(wavelet-LHHglszmZoneEntropy): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[15]);
	printf("%s","Cont. Input-16(wavelet-LLLglcmDifferenceEntropy): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[16]);
	printf("%s","Cont. Input-17(wavelet-LLLglcmMCC): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[17]);
	printf("%s","Cont. Input-18(originalglrlmLongRunEmphasis): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[18]);
	printf("%s","Cont. Input-19(wavelet-HHLglcmInverseVariance): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[19]);
	printf("%s","Cont. Input-20(originalglcmDifferenceEntropy): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[20]);
	printf("%s","Cont. Input-21(originalshapeSphericity): ");
	scanf("%lg",&Over2cc_4_MLP_22_13_2_input[21]);
	for(cont_inps=0;cont_inps<22;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over2cc_4_MLP_22_13_2_input[cont_inps] == -9999)
	  Over2cc_4_MLP_22_13_2_input[cont_inps]=Over2cc_4_MLP_22_13_2_MeanInputs[cont_inps];
	}
    Over2cc_4_MLP_22_13_2_ScaleInputs(Over2cc_4_MLP_22_13_2_input,0,1,22);
	Over2cc_4_MLP_22_13_2_RunNeuralNet_Classification();
   //Normalise output if output activation is not Softmax;
 	Over2cc_4_MLP_22_13_2_Normalise(Over2cc_4_MLP_22_13_2_output,2);
	for(i=0;i<2;i++)
	{
      if(max<Over2cc_4_MLP_22_13_2_output[i])
      {
        max=Over2cc_4_MLP_22_13_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

