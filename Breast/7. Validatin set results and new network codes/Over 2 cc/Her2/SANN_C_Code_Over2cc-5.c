//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over2cc_5_MLP_21_8_2_input_hidden_weights[8][21]=
{
 {-7.55585868962939e+001, 5.91042168448941e+001, 7.34682345199666e+001, -3.96328420196954e+001, -3.78975670319394e+001, 3.03736747285366e+001, -1.83052471377510e+001, -4.62428240380842e+001, -8.89790362371779e-001, 9.95514736568575e+001, 1.37664851913751e+000, 5.55660691013100e+001, -5.07389718839945e+001, -3.05772578132055e+000, 2.49957828902284e+001, 3.77662721487102e+001, -9.98073158423160e+001, 2.90411660257356e+001, 1.34669046761992e+002, -1.45242913948525e+001, -4.79376370041372e+001 },
 {-6.74150695048226e+001, 5.94052695767912e+001, 6.95383468008023e+001, -4.17887798744223e+001, -1.45926066012907e+001, 1.32789806049726e+001, -7.50002724819211e+000, -2.50056551820369e+001, -6.18660185220254e+000, 8.88810273084770e+001, -9.46865568479706e+000, 4.64651218875758e+001, -4.74392014450896e+001, -1.28099003789996e+001, 2.10916910900649e+001, 8.91343131831034e+000, -7.25651880020883e+001, 2.65216778242080e+001, 1.09604889637578e+002, -2.14555818564023e+001, -4.03160145646428e+001 },
 {-5.62732867660955e+001, 5.02350607030838e+001, 5.94287325506325e+001, -3.53295684541331e+001, -1.25068194325866e+001, 1.26289313969909e+001, -7.17770262810946e+000, -2.04812948479313e+001, -3.47962713924983e+000, 7.62318674492942e+001, -7.02828447370047e+000, 3.95065380135768e+001, -3.73583428344337e+001, -9.86027469370037e+000, 1.85234147523586e+001, 7.56727441570315e+000, -6.09739733691883e+001, 2.30475653940280e+001, 9.68043407360084e+001, -1.64078839117675e+001, -3.27631432739151e+001 },
 {-5.78806354112065e+001, 5.60136443700654e+001, 6.75566280749463e+001, -4.06338053765967e+001, -1.56003107060434e+000, 5.36521106804092e+000, 3.87480905825615e-001, -8.02438973774606e+000, -8.17017506254520e+000, 8.17651608686207e+001, -1.63032073307395e+001, 3.85037818253173e+001, -3.98278030022442e+001, -1.44074178148576e+001, 2.07298849228253e+001, -6.87558262816477e+000, -4.91943152709031e+001, 2.29437405861350e+001, 8.92147542666535e+001, -2.17142500721367e+001, -3.11109345844988e+001 },
 {-6.02190163394096e+001, 5.44399756582694e+001, 6.51801589719892e+001, -3.99084324616131e+001, -9.02046431914829e+000, 9.07221724704220e+000, -4.13207205659225e+000, -1.64466146069793e+001, -6.79156873817800e+000, 8.16593212429997e+001, -1.28599018943109e+001, 4.06508791937389e+001, -4.11148319794168e+001, -1.30781087037180e+001, 1.95944919288727e+001, 1.27976583090113e+000, -5.89837133239421e+001, 2.35839879498914e+001, 9.54114544106827e+001, -2.03154906480314e+001, -3.43153561823963e+001 },
 {-7.02285872439486e+001, 5.89862794866165e+001, 6.83005797001993e+001, -4.04033508497609e+001, -2.27269966437564e+001, 1.87041498281235e+001, -1.25017159039642e+001, -3.44107691298523e+001, -3.88936368759838e+000, 9.01407328771938e+001, -3.99680478455300e+000, 4.97905905582628e+001, -4.94240390317966e+001, -1.03916588792085e+001, 2.08748218354169e+001, 1.93920833110240e+001, -8.43068643208777e+001, 2.77229181906789e+001, 1.19706997279374e+002, -1.96264940213313e+001, -4.38530791384142e+001 },
 {-7.28115515805539e+001, 6.06661800439857e+001, 7.04411901806835e+001, -4.20209240697442e+001, -2.44975441715849e+001, 1.94714820630708e+001, -1.38731380802628e+001, -3.65069274429431e+001, -4.26366751886668e+000, 9.31410440534050e+001, -3.96462427321378e+000, 5.14770282090926e+001, -5.12236762423111e+001, -1.02830189242660e+001, 2.13240192833519e+001, 2.06549016061271e+001, -8.81924072531843e+001, 2.81136546028281e+001, 1.23779739901069e+002, -2.05127032564915e+001, -4.57551894435817e+001 },
 {-6.15514912951394e+001, 5.21726354021059e+001, 6.19119206132589e+001, -3.83612549796791e+001, -1.72276118292738e+001, 1.32156611037072e+001, -1.00791644353374e+001, -2.54007729173230e+001, -4.65544150061925e+000, 8.03258911745215e+001, -8.40308202407657e+000, 4.26318822966481e+001, -4.16756266077624e+001, -1.09351124698837e+001, 1.84224054572200e+001, 9.94307665963390e+000, -6.86128703718368e+001, 2.43971376510094e+001, 1.01649636427828e+002, -1.82047225197885e+001, -3.76019952935709e+001 } 
};

double Over2cc_5_MLP_21_8_2_hidden_bias[8]={ 8.38505159804924e+000, 3.32872154344443e+000, 3.68546329905490e+000, 1.10830589473944e+000, 1.77861612498625e+000, 5.23798366803442e+000, 5.15680821413338e+000, 2.96059076934037e+000 };

double Over2cc_5_MLP_21_8_2_hidden_output_wts[2][8]=
{
 {2.42471877396457e+001, -2.38786701139835e+000, -5.98691738691331e+000, -9.60308213084120e+000, -4.45015658830525e+000, 6.13052112849166e+000, 1.77030308605356e+001, 9.30709612053038e+000 },
 {-2.47956869920631e+001, -8.98262825833186e-001, 4.98771307897782e+000, 4.34714691915521e+000, 1.65768230643227e+000, -7.95071710659398e+000, -1.90388115692855e+001, -1.01508040306050e+001 }
};

double Over2cc_5_MLP_21_8_2_output_bias[2]={ 2.09370995881528e-002, -1.50174961805014e-002 };

double Over2cc_5_MLP_21_8_2_max_input[21]={ 9.94225622500000e-001, 9.98205853844333e-001, 9.96754273526000e-001, 9.99958012914333e-001, 9.94505657234667e-001, 9.87686168724000e-001, 9.98278127930000e-001, 9.95170697016667e-001, 9.99977398435000e-001, 9.76060123067333e-001, 9.81017347897333e-001, 1.40417965636667e+000, 9.51627339487000e-001, 8.65563457626667e-001, 6.46031687483333e+000, 9.96854540307667e-001, 6.71294571244000e+000, 4.99555750214000e-001, 8.21654401930000e-001, 7.77973268702667e-001, 8.87391385084667e-001 };

double Over2cc_5_MLP_21_8_2_min_input[21]={ 9.51458841268667e-001, 9.52721802638333e-001, 9.57705102447333e-001, 9.07570890327000e-001, 9.43359485176000e-001, 9.10429029488667e-001, 9.43173352577333e-001, 9.33755227989000e-001, 8.14424454238667e-001, 8.71982414223667e-001, 8.56874668825000e-001, 1.02462806683000e+000, 7.33377997593000e-001, 5.96739362359667e-001, 4.45016599139000e+000, 6.35162254726333e-001, 4.48663980817333e+000, 2.44262934234000e-001, 4.33984373328333e-001, 3.12766281606667e-001, 4.64379424052333e-001 };

double Over2cc_5_MLP_21_8_2_input[21];
double Over2cc_5_MLP_21_8_2_hidden[8];
double Over2cc_5_MLP_21_8_2_output[2];

double Over2cc_5_MLP_21_8_2_MeanInputs[21]={ 9.86215974880607e-001, 9.82580240878453e-001, 9.79769865419318e-001, 9.94294379312090e-001, 9.73150089825902e-001, 9.66227464441086e-001, 9.81998966214847e-001, 9.72810897712386e-001, 9.91240682825940e-001, 9.29932763713648e-001, 9.33069803359037e-001, 1.06187684347659e+000, 8.66940461142569e-001, 7.31393955181164e-001, 5.13171062654525e+000, 8.93468219422401e-001, 5.66245517208056e+000, 4.40861350465457e-001, 6.49529047198333e-001, 6.50102625908682e-001, 6.44693150319109e-001 };

void Over2cc_5_MLP_21_8_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over2cc_5_MLP_21_8_2_max_input[i]-Over2cc_5_MLP_21_8_2_min_input[i]);
	input[i] = minimum - delta*Over2cc_5_MLP_21_8_2_min_input[i]+ delta*input[i];
 }
}

double Over2cc_5_MLP_21_8_2_logistic(double x)
{
  if(x > 100.0) x = 1.0;
  else if (x < -100.0) x = 0.0;
  else x = 1.0/(1.0+exp(-x));
  return x;
}

void Over2cc_5_MLP_21_8_2_Normalise(double out[],long length)
{
  long i, j;
  double sum = 0.0;
  for(i=0; i<length; i++)
  {
   if(out[i]>100)
   {
    out[i] = 1.0;
    j = i;
    for(i=0; i<length; i++)
    {
     if(i!=j) out[i] = 0.0;
    }
    break;
   }
   else out[i] = exp(out[i]);
  }
  for(i=0; i<length; i++)
  {
   sum += out[i];
  }
  for(i=0; i<length; i++)
  {
   out[i] = out[i]/sum;
  }
}

void Over2cc_5_MLP_21_8_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==0) V_OUT[row] = Over2cc_5_MLP_21_8_2_logistic(V_OUT[row]);
      if(layer==1) V_OUT[row] = Over2cc_5_MLP_21_8_2_logistic(V_OUT[row]);
   }
}

void Over2cc_5_MLP_21_8_2_RunNeuralNet_Classification () 
{
  Over2cc_5_MLP_21_8_2_ComputeFeedForwardSignals((double*)Over2cc_5_MLP_21_8_2_input_hidden_weights,Over2cc_5_MLP_21_8_2_input,Over2cc_5_MLP_21_8_2_hidden,Over2cc_5_MLP_21_8_2_hidden_bias,21, 8,0);
  Over2cc_5_MLP_21_8_2_ComputeFeedForwardSignals((double*)Over2cc_5_MLP_21_8_2_hidden_output_wts,Over2cc_5_MLP_21_8_2_hidden,Over2cc_5_MLP_21_8_2_output,Over2cc_5_MLP_21_8_2_output_bias,8, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-LLLglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[0]);
	printf("%s","Cont. Input-1(wavelet-HLLglcmIdmn): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-LHLglcmIdmn): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-LLLglcmImc2): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[3]);
	printf("%s","Cont. Input-4(originalglcmIdmn): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[4]);
	printf("%s","Cont. Input-5(originalglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[5]);
	printf("%s","Cont. Input-6(wavelet-HHHglcmIdmn): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-LHHglcmIdmn): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[7]);
	printf("%s","Cont. Input-8(wavelet-LLHglcmImc2): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-HHLglcmIdn): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[9]);
	printf("%s","Cont. Input-10(wavelet-LHLglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[10]);
	printf("%s","Cont. Input-11(wavelet-LLLglrlmLongRunEmphasis): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[11]);
	printf("%s","Cont. Input-12(wavelet-LLHglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[12]);
	printf("%s","Cont. Input-13(originalglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[13]);
	printf("%s","Cont. Input-14(originalglrlmRunEntropy): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[14]);
	printf("%s","Cont. Input-15(wavelet-LLLglcmMCC): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[15]);
	printf("%s","Cont. Input-16(wavelet-HLHglszmZoneEntropy): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[16]);
	printf("%s","Cont. Input-17(wavelet-HHLglcmInverseVariance): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[17]);
	printf("%s","Cont. Input-18(wavelet-LHLglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[18]);
	printf("%s","Cont. Input-19(originalshapeSphericity): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[19]);
	printf("%s","Cont. Input-20(wavelet-HLLglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over2cc_5_MLP_21_8_2_input[20]);
	for(cont_inps=0;cont_inps<21;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over2cc_5_MLP_21_8_2_input[cont_inps] == -9999)
	  Over2cc_5_MLP_21_8_2_input[cont_inps]=Over2cc_5_MLP_21_8_2_MeanInputs[cont_inps];
	}
    Over2cc_5_MLP_21_8_2_ScaleInputs(Over2cc_5_MLP_21_8_2_input,0,1,21);
	Over2cc_5_MLP_21_8_2_RunNeuralNet_Classification();
   //Normalise output if output activation is not Softmax;
 	Over2cc_5_MLP_21_8_2_Normalise(Over2cc_5_MLP_21_8_2_output,2);
	for(i=0;i<2;i++)
	{
      if(max<Over2cc_5_MLP_21_8_2_output[i])
      {
        max=Over2cc_5_MLP_21_8_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

