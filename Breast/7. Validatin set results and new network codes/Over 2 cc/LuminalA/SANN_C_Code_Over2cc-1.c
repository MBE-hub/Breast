//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over2cc_1_MLP_21_11_2_input_hidden_weights[11][21]=
{
 {2.10824776980950e+000, 6.95875378950773e-001, 8.16884843105732e-001, 9.32713092050453e-001, -9.67289846917299e-001, -1.43032797830731e+000, 4.54687930737499e+000, -2.22464343762359e+000, -1.34098100816534e+000, -3.57589626003803e+000, -8.61167539982355e-002, -1.86374856514736e+000, -5.57098310984011e-001, -6.47640733668311e-001, -1.73840046790330e+000, 1.90527366701419e-001, -1.24240543533986e-002, -4.09298619130300e-001, 2.52507585189190e+000, -6.51601812154963e-001, 1.38200684741562e+000 },
 {9.64745894521356e-001, 1.54653940992022e+000, 1.18774547915707e+000, 2.88465892178301e-002, -4.45330715101603e-001, -4.69103145517702e-001, 1.54624718776192e+000, -9.67250350962928e-001, 5.02524438747321e-001, -5.13615884528653e-001, -1.88579827103180e-001, -5.61701635676090e-002, -1.74260841906752e-001, 2.96417362525810e-001, -6.17412220707879e-002, 3.22703934155835e-001, -4.00699951184064e-001, -1.95146971656524e-001, 1.25059876794090e+000, 9.50698706248105e-001, 1.66540894620011e+000 },
 {6.51461700538205e-001, -5.06633648294304e+000, -3.19612326668855e+000, -9.38406659008899e-001, 6.55499249762552e+000, -6.74177798571198e+000, -6.44197641001557e+000, -4.12983257443338e+000, -4.76519554676461e+000, 8.20667317749894e+000, -3.00375597001700e+000, -2.26941267978776e+000, -7.84939962005575e-001, -1.81671167495404e-001, 8.70972478069908e+000, -4.00792441379642e+000, -5.38334363372287e+000, -2.88260925280280e+000, 9.76027243989988e+000, 2.77893048902515e+000, 2.17484476463096e+000 },
 {-2.36598669918905e+000, -1.42057744548583e+001, 4.57831839493834e+000, 9.82900021525020e+000, 1.40072402641301e+001, 1.59203523583587e+000, -3.96264361300586e+000, -5.49768888063197e+000, -1.00217896126392e+001, 9.30770503210976e+000, -2.43915065539154e+000, -5.36310766874923e+000, 8.84864728094464e+000, -2.03349931334212e+000, 1.65804602110897e+000, -4.79870747622643e+000, -5.23649447064603e+000, -7.82589070333794e+000, 7.06050912116800e+000, -4.90057161065096e+000, -2.05130035881243e+000 },
 {-1.64857820294024e+000, -2.29502749254934e+000, -4.19020411058826e+000, 1.06724511439467e+001, 9.36180088289013e+000, 1.25029001735032e+001, -1.55101156524483e+001, -6.63051005286047e-001, -3.16361327226614e+000, -6.51964993861236e+000, 2.99063504987609e+000, 1.95631729756958e+000, 1.02004807510523e+001, -3.79357179606385e+000, 6.90988801409862e-002, -1.17254695167733e+001, 6.17492296837117e+000, 4.92548126921993e+000, -1.30047781225730e+000, -4.63019250449330e+000, -4.04595861932054e+000 },
 {-1.77726447479859e+000, -2.14621981009107e+000, -6.00392808270856e-001, 1.94173049179087e+000, 3.20802202119410e+000, 2.74326671018908e+000, -2.48555411939618e+000, -1.36097016091637e+000, -7.12600426735074e-001, 1.42771521026739e-001, -1.46240072287276e+000, -5.56051873030709e-001, 2.87360731062016e+000, -1.15803091675405e+000, -8.89853035227737e-001, -2.17071271655834e+000, -1.58769237841904e+000, -2.21325783909732e+000, 1.14062772444110e+000, 1.16208383649573e+000, 2.76420162070544e+000 },
 {-2.73945818886625e+000, -1.31132166750380e+001, 2.40375084618733e+000, 2.10961677870900e+001, 2.24937758079852e+001, 5.28223172683978e+000, -1.48841881189091e+001, -8.91455562225252e+000, -9.39679030649321e+000, -1.12203392005053e+001, -5.31469746823063e+000, -1.15387906126321e+001, 1.06601570642814e+001, -1.30985472173169e+000, -1.60166922449151e+001, -2.34630102247396e+001, -2.26636435181113e+000, -2.06608869227428e+001, 2.31557065875071e+001, 1.90679803832653e-001, 5.86383897677354e+000 },
 {1.54109821796665e+001, -5.79063451964547e+000, 4.10457939396792e+000, 1.59355878648987e+000, -5.41121448750507e+000, -1.10374099483397e+000, 1.04803496984805e+001, 6.74522646975033e+000, -3.05358693149451e+000, -3.27299592557126e+000, 3.97523225978671e+000, -1.86480578285472e+000, -1.95033927673435e+000, 9.17742088146027e+000, -5.86893980069595e+000, 3.54439822630576e+000, 8.30386665155103e+000, 4.84689577885673e+000, 4.99917195531576e+000, -5.88921422820885e+000, -1.26313608674595e+001 },
 {-6.68612255138225e-001, 4.58673330521494e+000, -2.38498868210776e+000, -8.60318735030980e+000, -9.09322621850373e+000, -3.56397433717665e+000, 1.69357939572735e+000, 3.80335796497846e+000, 3.13143152583093e+000, 4.02838398474213e+000, 1.65877228021857e+000, 3.82169153142618e+000, -5.00509614022159e+000, -9.00416026357650e-001, 4.60630043828071e+000, 5.71360824177813e+000, 9.35496396415713e-001, 7.02902563225766e+000, -9.64717573120785e+000, -6.99330804881521e-001, -5.25544832820326e+000 },
 {9.80925823178924e-001, -3.41159512216623e+000, 5.00888194046583e+000, 4.49901254601434e+000, 4.08892128453152e+000, 3.09858750347841e+000, 2.34389908542234e+000, -5.93416805509769e+000, -2.13249610855305e+000, -8.33421396383123e+000, -4.36743550441451e-001, -5.03603564228721e+000, -1.04787734365111e+000, 1.22215347796568e+000, -7.94762571721262e+000, -3.81905506440269e+000, 1.29879345431049e+000, -9.76114215898316e+000, 6.07187948732171e+000, -5.67259404565918e-001, 6.53905239579269e+000 },
 {1.11844455942170e+000, 8.89101165028918e+000, -4.02174515361824e+000, -1.25096660539799e+001, -1.40034276440959e+001, 3.48525535376613e-002, 7.66616112647107e+000, 4.39422187930374e+000, 9.65656188560897e+000, -1.47012018647709e-001, 2.81640413005398e+000, 6.85284156340408e+000, -1.02646481549615e+001, 3.43343342594254e+000, 1.62548915926521e+000, 1.05320334211387e+001, 4.44574685386716e+000, 8.83640884540485e+000, -1.37836611262975e+001, 1.14691871467802e+000, -2.14551971691523e+000 } 
};

double Over2cc_1_MLP_21_11_2_hidden_bias[11]={ -9.62463731483946e-001, 1.24073344338699e+000, 2.32607870143048e+000, 7.41248891970295e-001, -6.90982370258381e-001, 1.67971826398609e+000, 5.81599823058613e+000, -1.37761127199523e+001, -2.96312987633911e+000, 2.03565086541465e+000, -3.36233849353368e+000 };

double Over2cc_1_MLP_21_11_2_hidden_output_wts[2][11]=
{
 {1.68084566536630e+000, 1.34143998425933e+000, -1.17489364316057e+001, -1.28676119818737e+001, 1.78500177858645e+001, -3.39063633153696e+000, 9.73776917261970e+000, 1.35744748300147e+001, 1.48293554314451e+000, 6.67843773582139e+000, 1.17426885803785e+001 },
 {-1.69274680173232e+000, -1.37318438772652e+000, 1.18216190816522e+001, 1.28384962353331e+001, -1.78932839330580e+001, 3.39088646067247e+000, -9.81887350426086e+000, -1.35821575978108e+001, -1.50370901083001e+000, -6.68874655045660e+000, -1.17800831678217e+001 }
};

double Over2cc_1_MLP_21_11_2_output_bias[2]={ -1.10413829018539e+000, 1.05763388810821e+000 };

double Over2cc_1_MLP_21_11_2_max_input[21]={ 9.93742576210667e-001, 9.99958012914333e-001, 9.94505657234667e-001, 9.97911037399333e-001, 9.76060123067333e-001, 9.78343830095000e-001, 9.91579149548667e-001, 6.77785077092000e+000, 6.66811095787333e+000, 8.16193723420333e+000, 1.91273776273333e+000, 6.33810119641000e+000, 8.65563457626667e-001, 6.42679814845667e+000, 6.07940450162667e+000, 6.71294571244000e+000, 2.12815921118000e+000, 4.87575136096667e+000, 8.04382375677000e-001, 8.54444860002000e+000, 8.26662481002000e-001 };

double Over2cc_1_MLP_21_11_2_min_input[21]={ 9.51458841268667e-001, 9.07570890327000e-001, 9.43359485176000e-001, 9.57500458124000e-001, 8.71982414223667e-001, 8.66181001041000e-001, 8.57150687641000e-001, 5.36721515213000e+000, 5.22524445697333e+000, 5.97876681594000e+000, 1.02051201356667e+000, 4.56879527201667e+000, 5.96739362359667e-001, 4.23179759442333e+000, 3.90952828744333e+000, 4.48663980817333e+000, 1.04925532510333e+000, 3.00348783322667e+000, 4.33984373328333e-001, 5.03036583603667e+000, 4.64379424052333e-001 };

double Over2cc_1_MLP_21_11_2_input[21];
double Over2cc_1_MLP_21_11_2_hidden[11];
double Over2cc_1_MLP_21_11_2_output[2];

double Over2cc_1_MLP_21_11_2_MeanInputs[21]={ 9.85925319502545e-001, 9.93889935415147e-001, 9.73395078479475e-001, 9.83474386539525e-001, 9.29897029128594e-001, 9.24557242264224e-001, 9.36731548254260e-001, 5.95963414834500e+000, 5.90187736871728e+000, 6.79743135428297e+000, 1.06615020177476e+000, 5.54382743484284e+000, 7.26865610979191e-001, 5.55666591830829e+000, 4.92455485253533e+000, 5.66009858700317e+000, 1.17518848137024e+000, 3.89025162913842e+000, 6.45871514958439e-001, 6.65096713129370e+000, 6.39174558792419e-001 };

void Over2cc_1_MLP_21_11_2_FindMax(double* vec, double* max, long* maxIndex,int len)
{
  long i;
  *max = vec[0];
  *maxIndex = 0;
  for(i=1; i<len; i++)
  {
    if(vec[i]>*max)
    {
      *max = vec[i];
      *maxIndex = i;
    }
  }
}

void Over2cc_1_MLP_21_11_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over2cc_1_MLP_21_11_2_max_input[i]-Over2cc_1_MLP_21_11_2_min_input[i]);
	input[i] = minimum - delta*Over2cc_1_MLP_21_11_2_min_input[i]+ delta*input[i];
 }
}

void Over2cc_1_MLP_21_11_2_softmax(double* vec,int len)
{

  long i, j;
  double sum=0.0;
  for(i=0; i<len; i++)
  {
    if(vec[i]>200)
    {
      double max;
      long maxIndex;
      Over2cc_1_MLP_21_11_2_FindMax(vec, &max, &maxIndex,len);
      for(j=0; j<len; j++)
      {        if(j==maxIndex) vec[j] = 1.0;
        else vec[j] = 0.0;
      }
      return;
    }
    else
    {
      vec[i] = exp(vec[i]);
    }
    sum += vec[i];
  }
  if(sum==0)
  {
   long a = 1;
  }
  if(sum!=0.0)
  {
    for(i=0; i<len; i++) vec[i] = vec[i]/sum;
  }
  else for(i=0; i<len; i++) vec[i] = 1.0/(double)len;
}

void Over2cc_1_MLP_21_11_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==0) V_OUT[row] = tanh(V_OUT[row]);
   }
}

void Over2cc_1_MLP_21_11_2_RunNeuralNet_Classification () 
{
  Over2cc_1_MLP_21_11_2_ComputeFeedForwardSignals((double*)Over2cc_1_MLP_21_11_2_input_hidden_weights,Over2cc_1_MLP_21_11_2_input,Over2cc_1_MLP_21_11_2_hidden,Over2cc_1_MLP_21_11_2_hidden_bias,21, 11,0);
  Over2cc_1_MLP_21_11_2_ComputeFeedForwardSignals((double*)Over2cc_1_MLP_21_11_2_hidden_output_wts,Over2cc_1_MLP_21_11_2_hidden,Over2cc_1_MLP_21_11_2_output,Over2cc_1_MLP_21_11_2_output_bias,11, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-LLLglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[0]);
	printf("%s","Cont. Input-1(wavelet-LLLglcmImc2): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[1]);
	printf("%s","Cont. Input-2(originalglcmIdmn): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-HHLglcmIdmn): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-HHLglcmIdn): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-HHHglcmIdn): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[5]);
	printf("%s","Cont. Input-6(wavelet-HLHglrlmShortRunEmphasis): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-LHLgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[7]);
	printf("%s","Cont. Input-8(wavelet-LHHgldmDependenceEntropy): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-LLLglszmZoneEntropy): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[9]);
	printf("%s","Cont. Input-10(wavelet-LLHglrlmLongRunEmphasis): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[10]);
	printf("%s","Cont. Input-11(wavelet-LHLglszmZoneEntropy): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[11]);
	printf("%s","Cont. Input-12(originalglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[12]);
	printf("%s","Cont. Input-13(wavelet-LHHglszmZoneEntropy): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[13]);
	printf("%s","Cont. Input-14(wavelet-LLLglcmDifferenceEntropy): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[14]);
	printf("%s","Cont. Input-15(wavelet-HLHglszmZoneEntropy): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[15]);
	printf("%s","Cont. Input-16(originalglrlmLongRunEmphasis): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[16]);
	printf("%s","Cont. Input-17(originalglcmDifferenceEntropy): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[17]);
	printf("%s","Cont. Input-18(wavelet-LHLglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[18]);
	printf("%s","Cont. Input-19(wavelet-LHHglcmJointEntropy): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[19]);
	printf("%s","Cont. Input-20(wavelet-HLLglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over2cc_1_MLP_21_11_2_input[20]);
	for(cont_inps=0;cont_inps<21;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over2cc_1_MLP_21_11_2_input[cont_inps] == -9999)
	  Over2cc_1_MLP_21_11_2_input[cont_inps]=Over2cc_1_MLP_21_11_2_MeanInputs[cont_inps];
	}
    Over2cc_1_MLP_21_11_2_ScaleInputs(Over2cc_1_MLP_21_11_2_input,0,1,21);
	Over2cc_1_MLP_21_11_2_RunNeuralNet_Classification();
   //Output Activation is Softmax;
	Over2cc_1_MLP_21_11_2_softmax(Over2cc_1_MLP_21_11_2_output, 2);
	for(i=0;i<2;i++)
	{
      if(max<Over2cc_1_MLP_21_11_2_output[i])
      {
        max=Over2cc_1_MLP_21_11_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

