//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over1cc_8_MLP_22_9_2_input_hidden_weights[9][22]=
{
 {-3.75443203756556e-001, -6.28069086187072e+000, 5.32944000127325e+000, 8.56879893171031e-001, 4.43007304783664e-001, -3.45163414741235e+000, 5.33348017929520e-001, 1.14249459180752e+000, -1.82287069899169e+000, 2.55032546892744e+000, 1.72533714180048e+000, 1.97008029871470e+000, 1.27121567873664e+000, -5.93767198002774e+000, 3.25357956848925e+000, 5.48606953076694e+000, -2.20150978651217e+000, -4.75449980658623e+000, 1.50920030163738e+000, -2.98976286866807e+000, -6.71486841641244e-001, 7.55722260729614e+000 },
 {5.25730540082952e+000, 1.58703741096612e+001, -1.16905424272126e+001, 4.94203310715024e+000, -2.76310099427400e+000, 8.15763611480849e+000, 4.65693841570353e+000, -5.73125014113551e+000, -1.25636769074205e-001, -1.16989140753752e-001, -7.31091316263183e+000, 1.18816562871816e+000, -8.90856656564310e-001, 4.70520114390485e+000, -3.54737484799284e+000, -8.00546416341733e+000, -1.61031492575330e+000, 7.05995138583417e+000, -5.79264533247574e-001, 5.02811354269392e+000, -6.34172104303227e+000, -1.83002573055906e+001 },
 {-4.33436366827212e-002, 5.68524826402687e+000, -3.34495798268595e+000, 3.53436078226554e+000, 3.69736265718016e-001, 3.01657296871674e+000, 3.72521526505263e+000, -9.79193119083503e-001, -7.65408325821256e-001, 1.84389596511702e+000, -2.77521123409124e+000, 1.20864480524283e+000, 1.84339652132090e-001, 1.18448112129898e+000, -3.38026364579999e-001, 8.90453853306809e-001, -2.77211648175266e-001, 2.28407713895986e+000, 9.21524186086641e-001, 8.63194342222785e-001, 1.11512654507393e+000, -2.80919526283408e+000 },
 {1.40833623440398e-001, -6.22563252495255e+000, 5.51231468745683e+000, -1.75012097771116e+000, 4.02540553440937e+000, -3.22982177571915e+000, -1.83848410967394e+000, 1.91433372815028e+000, 1.23766614364749e+000, -2.18561643174456e-001, 3.76549379935439e+000, 5.44484477938935e-001, 1.32573877434793e+000, -1.91135474825974e+000, 1.49213934555608e+000, 3.27800853344829e+000, 2.63603337614351e+000, -3.08370427271704e+000, 1.67347985807632e+000, -2.02210544642383e+000, 3.09056728086994e+000, 1.10593797789418e+001 },
 {1.87429837816080e+000, 3.68325427398033e+000, -2.76034459477224e+000, -1.45201680719424e+000, 6.82886871145719e-001, 1.59524983810533e+000, -9.97293395349298e-001, -3.27818975695066e+000, 1.73608052837853e+000, -5.15559614526439e-001, -2.87134648444899e-001, 1.03501501799879e+000, 1.58294421563740e+000, 7.57692874195529e-001, -1.19306119538761e+000, -6.32231226998585e-001, 1.16803219620384e+000, 1.24357555965727e+000, 2.50674599082789e+000, -3.05157146520964e-001, 1.14598948582425e+000, -7.01678739099222e-001 },
 {2.41100333646005e+000, 1.01552214989404e+001, -8.05744418855529e+000, 1.81129119239175e+000, -1.92892977823574e+000, 5.03315862774412e+000, 1.25436266243921e+000, -3.71694787084207e+000, 6.87781856073665e-001, -1.14522025783852e+000, -4.36275713422102e+000, -3.83273831799059e-001, -1.08336511141000e+000, 3.98547888624192e+000, -3.37118692323943e+000, -6.64600854572743e+000, 7.16202431083577e-002, 5.29394892502301e+000, -9.38728775466928e-001, 3.78545804053298e+000, -3.13935722312871e+000, -1.24030544176393e+001 },
 {-2.06985048191818e+000, -7.53554593087646e+000, 7.44581589757583e+000, -4.54131644172126e-001, 2.26651461244601e+000, -3.03048933431451e+000, -6.26053153154797e-001, 3.67041549045594e+000, 5.56185377801916e-001, 1.56951346531223e+000, 4.33987147474940e+000, 5.25480769278375e-001, 1.63383443329021e+000, -2.51866220894630e+000, 3.04895302756497e+000, 5.38339441338413e+000, 1.28561468488513e+000, -2.43471021043255e+000, 1.50145106624914e+000, -1.89737458643829e+000, 3.80036185694731e+000, 9.88574899364182e+000 },
 {1.09181104309087e+001, 1.34082485903888e+001, -1.15256867510990e+001, -7.90812741076322e+000, -1.48051103408685e+000, 9.90416011295245e+000, -2.85065564423597e+000, -8.47864361940407e+000, 4.47709865378437e+000, -1.93936404515651e+000, -1.31001770032249e+000, -4.54444787229100e-001, 1.80116237647350e-001, 1.11822938004110e+001, -4.03399907241339e+000, -7.76222030488664e+000, 1.82056375063884e+000, 8.11419481175468e+000, 1.72204709242326e+000, 1.34661783253560e+000, -2.07464907321352e+000, -1.34192500004570e+001 },
 {-3.25561547344744e+000, -1.56909534997584e+001, 9.02127009327035e+000, -1.09894360134754e+001, -3.56427354646987e-001, -8.01852248477628e+000, -9.66381655744892e+000, 4.64068117343003e+000, 2.78127266481104e+000, -2.86959166564240e-001, 6.88298695872683e+000, -2.13146873801494e+000, 2.49503943537642e+000, -7.66968953363909e+000, 5.67377247901812e+000, 8.48031643702747e+000, -2.28494365561826e+000, -6.70556971127665e+000, 2.91398774970281e+000, -5.32144154253522e+000, 5.82074063040806e+000, 1.74304103455531e+001 } 
};

double Over1cc_8_MLP_22_9_2_hidden_bias[9]={ -1.94810152123549e+000, 2.75273022535734e+000, 1.36951060360722e+000, 1.43835987531494e+000, 1.23919686391492e+000, 1.79119889096748e+000, -6.84974005490050e-001, 3.03577149976551e+000, -5.88476981839278e+000 };

double Over1cc_8_MLP_22_9_2_hidden_output_wts[2][9]=
{
 {-3.69921562720381e+000, 2.47926436663972e+000, 6.67981859290099e+000, 1.82548103587040e+000, 2.31902207276461e+000, 3.02791305086914e+000, -8.85294611810617e-001, 5.74052225166782e+000, 6.48011285061771e+000 },
 {3.53226028868137e+000, -2.47136795870162e+000, -6.34599597368325e+000, 2.13318911819814e-001, -4.48411573962247e+000, -1.18250204480057e+000, -9.10652068039560e-002, -6.17179313093991e+000, -6.57838670793724e+000 }
};

double Over1cc_8_MLP_22_9_2_output_bias[2]={ 3.77223978065440e+000, -2.17772031106241e+000 };

double Over1cc_8_MLP_22_9_2_max_input[22]={ 9.98205853844333e-001, 9.96754273526000e-001, 9.88273973642000e-001, 9.94484586788000e-001, 9.99979798185333e-001, 9.76060123067333e-001, 9.52733284084000e-001, 9.87684635119000e-001, 9.69573341435000e-001, 6.72263999322000e+000, 8.81938425504667e-001, 8.16193723420333e+000, 6.46031687483333e+000, 9.99252106464333e-001, 6.62255613583333e+000, 6.07940450162667e+000, 9.99999999999667e-001, 8.72043766244000e-001, 7.02255299145000e+000, 8.60739480852333e-001, 9.99345923680333e-001, 8.17330004459667e-001 };

double Over1cc_8_MLP_22_9_2_min_input[22]={ 9.52721802638333e-001, 9.43198268998333e-001, 9.25222052145667e-001, 9.22866729721667e-001, 8.14424454238667e-001, 8.49220519646333e-001, 8.08604996355667e-001, 8.10756773806000e-001, 8.12308146372000e-001, 4.59045323467000e+000, 5.74665956678667e-001, 5.22152556633667e+000, 3.66723035187000e+000, 6.35162254726333e-001, 4.08859126770667e+000, 3.25406740473667e+000, 6.17261118161667e-001, 3.89274609002333e-001, 3.28371146222667e+000, 3.66051471635667e-001, 5.87309286467000e-001, 3.12766281606667e-001 };

double Over1cc_8_MLP_22_9_2_input[22];
double Over1cc_8_MLP_22_9_2_hidden[9];
double Over1cc_8_MLP_22_9_2_output[2];

double Over1cc_8_MLP_22_9_2_MeanInputs[22]={ 9.80081546290821e-001, 9.77345870442747e-001, 9.68445460061317e-001, 9.69594031300026e-001, 9.93469783945517e-001, 9.23805996676869e-001, 8.90373090064010e-001, 9.35958806202452e-001, 9.23526263532740e-001, 5.80275234155330e+000, 7.46144412954567e-001, 6.68959782437721e+000, 5.11767729635330e+000, 9.09573969608779e-001, 5.44660949009885e+000, 4.89997422250522e+000, 8.92540199766663e-001, 6.94392499061394e-001, 5.23787381832914e+000, 6.48195949112430e-001, 8.41600640048571e-001, 6.59646113367811e-001 };

void Over1cc_8_MLP_22_9_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over1cc_8_MLP_22_9_2_max_input[i]-Over1cc_8_MLP_22_9_2_min_input[i]);
	input[i] = minimum - delta*Over1cc_8_MLP_22_9_2_min_input[i]+ delta*input[i];
 }
}

double Over1cc_8_MLP_22_9_2_logistic(double x)
{
  if(x > 100.0) x = 1.0;
  else if (x < -100.0) x = 0.0;
  else x = 1.0/(1.0+exp(-x));
  return x;
}

void Over1cc_8_MLP_22_9_2_Normalise(double out[],long length)
{
  long i, j;
  double sum = 0.0;
  for(i=0; i<length; i++)
  {
   if(out[i]>100)
   {
    out[i] = 1.0;
    j = i;
    for(i=0; i<length; i++)
    {
     if(i!=j) out[i] = 0.0;
    }
    break;
   }
   else out[i] = exp(out[i]);
  }
  for(i=0; i<length; i++)
  {
   sum += out[i];
  }
  for(i=0; i<length; i++)
  {
   out[i] = out[i]/sum;
  }
}

void Over1cc_8_MLP_22_9_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==0) V_OUT[row] = tanh(V_OUT[row]);
      if(layer==1) V_OUT[row] = Over1cc_8_MLP_22_9_2_logistic(V_OUT[row]);
   }
}

void Over1cc_8_MLP_22_9_2_RunNeuralNet_Classification () 
{
  Over1cc_8_MLP_22_9_2_ComputeFeedForwardSignals((double*)Over1cc_8_MLP_22_9_2_input_hidden_weights,Over1cc_8_MLP_22_9_2_input,Over1cc_8_MLP_22_9_2_hidden,Over1cc_8_MLP_22_9_2_hidden_bias,22, 9,0);
  Over1cc_8_MLP_22_9_2_ComputeFeedForwardSignals((double*)Over1cc_8_MLP_22_9_2_hidden_output_wts,Over1cc_8_MLP_22_9_2_hidden,Over1cc_8_MLP_22_9_2_output,Over1cc_8_MLP_22_9_2_output_bias,9, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-HLLglcmIdmn): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[0]);
	printf("%s","Cont. Input-1(wavelet-LHLglcmIdmn): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-LLLglrlmRunLengthNonUniformityNormalized): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-LHHglcmIdmn): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-LLHglcmImc2): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-HHLglcmIdn): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[5]);
	printf("%s","Cont. Input-6(originalglcmIdn): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-LHLglrlmShortRunEmphasis): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[7]);
	printf("%s","Cont. Input-8(originalglrlmRunLengthNonUniformityNormalized): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-LHHgldmDependenceEntropy): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[9]);
	printf("%s","Cont. Input-10(originalglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[10]);
	printf("%s","Cont. Input-11(wavelet-LLLglszmZoneEntropy): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[11]);
	printf("%s","Cont. Input-12(originalglrlmRunEntropy): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[12]);
	printf("%s","Cont. Input-13(wavelet-LLLglcmMCC): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[13]);
	printf("%s","Cont. Input-14(wavelet-LHLglszmZoneEntropy): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[14]);
	printf("%s","Cont. Input-15(wavelet-LLLglcmDifferenceEntropy): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[15]);
	printf("%s","Cont. Input-16(wavelet-LLHglcmMCC): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[16]);
	printf("%s","Cont. Input-17(wavelet-LHHglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[17]);
	printf("%s","Cont. Input-18(originalglcmSumEntropy): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[18]);
	printf("%s","Cont. Input-19(wavelet-LHLglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[19]);
	printf("%s","Cont. Input-20(wavelet-HLLglcmImc2): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[20]);
	printf("%s","Cont. Input-21(originalshapeSphericity): ");
	scanf("%lg",&Over1cc_8_MLP_22_9_2_input[21]);
	for(cont_inps=0;cont_inps<22;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over1cc_8_MLP_22_9_2_input[cont_inps] == -9999)
	  Over1cc_8_MLP_22_9_2_input[cont_inps]=Over1cc_8_MLP_22_9_2_MeanInputs[cont_inps];
	}
    Over1cc_8_MLP_22_9_2_ScaleInputs(Over1cc_8_MLP_22_9_2_input,0,1,22);
	Over1cc_8_MLP_22_9_2_RunNeuralNet_Classification();
   //Normalise output if output activation is not Softmax;
 	Over1cc_8_MLP_22_9_2_Normalise(Over1cc_8_MLP_22_9_2_output,2);
	for(i=0;i<2;i++)
	{
      if(max<Over1cc_8_MLP_22_9_2_output[i])
      {
        max=Over1cc_8_MLP_22_9_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

