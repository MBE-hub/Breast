//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over1cc_6_MLP_22_8_2_input_hidden_weights[8][22]=
{
 {5.44426497616268e-001, -2.75523612432660e+000, 2.46663783105011e+000, -3.64278601584495e-001, 1.00014016354951e+000, -1.57276854379529e+000, -1.54071677574950e+000, 4.38418523860893e-001, 7.23223879537054e-001, -3.59214642610152e-001, 1.75756138783082e+000, 5.92529742882651e-001, 8.27690942113342e-001, -1.92565868189375e+000, 8.41734807513430e-001, 1.40214423413308e+000, 6.43027961892356e-001, -1.89695779239990e+000, 1.16623789434270e+000, -9.64990936154024e-001, 8.28799389333020e-001, 5.12337505780858e+000 },
 {6.62794326623394e-001, 7.58879629720417e+000, -6.96488178875603e+000, 1.27013343232947e+000, -3.34364905871038e+000, 3.78825783715793e+000, 2.05891789091636e+000, -2.72256840800344e+000, -1.05541995833936e+000, -4.35100516762984e-001, -4.43391963977516e+000, -7.57785192070338e-001, -1.62460402137848e+000, 3.12737362496592e+000, -2.46953978330289e+000, -4.66691345888116e+000, -1.69653490842181e+000, 3.66806271518924e+000, -1.92309794536131e+000, 2.37300508333434e+000, -3.29954966093773e+000, -1.19125478337300e+001 },
 {7.57580636923716e-001, 2.80801473258550e+000, -1.58161789586985e+000, 2.72148544640025e+000, 6.20722198836218e-003, 1.77238333197798e+000, 2.50506523868770e+000, -9.80551417716092e-001, -9.82137053081994e-001, 5.23029197079352e-001, -1.21121731691231e+000, 1.03250577824265e+000, -4.16625025080849e-001, 1.16704327236615e+000, -6.66198195302680e-001, -1.03406068153972e+000, 1.51785620626143e-001, 4.88826027506517e-001, -5.81459861549639e-001, 3.16968909263521e-001, -1.50026648914574e+000, -3.21496739255348e+000 },
 {-1.17606727705376e+000, -7.79297999386347e+000, 5.83049049180758e+000, -2.70389868833667e+000, 2.75551413861175e+000, -3.39080698457075e+000, 1.26581721059070e+000, 3.89794858652864e+000, -7.30553266682115e-001, 1.73899944017353e+000, 4.11050231742140e+000, 5.08481518853522e-001, 7.52593277901322e-001, -6.43019318933319e-001, 3.32335237044637e+000, 5.17495624684520e+000, 1.42628306406982e-001, -3.35835023790016e+000, 3.78698418681356e-001, -2.95637208436597e+000, 2.15342817712447e+000, 1.00051408426323e+001 },
 {-7.42227495813250e+000, -1.09123452446877e+001, 1.06204345122092e+001, -5.91253707151818e-001, 2.41148877349290e+000, -6.35019520068510e+000, 3.01893736432298e+000, 5.14169052562135e+000, -2.83736798386490e+000, 2.92598832061725e+000, 2.21356916261930e+000, 2.08507120003007e+000, -1.07120757899636e+000, -7.24469022154450e+000, 3.74678393597500e+000, 5.69827438468968e+000, 9.09844063853885e-001, -7.67241977964857e+000, -2.99957441027389e+000, -2.19238721934030e+000, 4.65687202895524e-001, 8.22238347096057e+000 },
 {-1.17024252990026e+000, -7.93757015274643e+000, 4.08269826926816e+000, -5.11748538608930e+000, 1.19540479457088e+000, -7.69849366496582e+000, -4.02377446256564e+000, -1.07164525594139e-001, 1.03080244557209e+000, -2.73880746233041e+000, 6.04181348395125e+000, -3.41594597449249e-001, 1.97126486768565e+000, -2.16718669821746e+000, -5.24780124490461e-001, 3.12459100572417e+000, 3.14597985864917e+000, -3.18430383168494e+000, 2.35996861860304e+000, -2.74144894681956e+000, 5.14334403001622e+000, 8.57182171607464e+000 },
 {1.03165148815801e+000, 5.69545198573800e+000, -3.35886048989853e+000, 4.07919070553261e+000, -1.04036362876205e-001, 3.36086949982301e+000, 4.64589064151242e+000, -1.25367395380745e+000, -1.46579816613951e+000, 1.06552999965555e+000, -2.43786722671569e+000, 1.28745796877686e+000, -1.01747505409102e+000, 3.04159043893037e+000, -1.41116642953741e+000, -2.64435138079342e+000, 5.16778789181707e-001, 2.26833262882143e+000, -1.27394676960071e+000, 2.12904833581099e+000, -2.67182757799195e+000, -7.28439537223747e+000 },
 {-1.05229368849892e+000, -6.87554798453215e+000, 3.58180639860033e+000, -2.91912638655633e+000, 1.72223099142229e+000, -3.29832036325915e+000, -1.15225320909595e-001, 2.46461291408370e+000, -6.98370027513621e-001, 6.68540359229171e-001, 3.30232744978733e+000, 2.99874392663615e-001, 3.41865255604818e-001, -1.00541948208777e+000, 2.09673443242848e+000, 3.68247701211967e+000, -6.22887665171310e-001, -3.08810428484966e+000, 2.22690801447290e-001, -2.94047786270882e+000, 1.65045401120609e+000, 8.63421492272008e+000 } 
};

double Over1cc_6_MLP_22_8_2_hidden_bias[8]={ 9.07227382305376e-001, -5.56324893886602e-001, 8.77985885692572e-001, -5.45961214737916e-001, -1.71877331132716e+000, -1.30534804352237e+000, 1.72049313227211e+000, -6.08927101826944e-001 };

double Over1cc_6_MLP_22_8_2_hidden_output_wts[2][8]=
{
 {6.05085184062712e+000, -1.28256489619235e+000, -5.36006173498712e-001, -5.66460629036018e+000, -7.73539895643781e+000, 6.74598752747719e+000, -5.03298611417676e-001, -2.66364492942818e+000 },
 {-6.06662750770965e+000, 1.25835833567701e+000, 4.61871488606078e-001, 5.56417750711567e+000, 7.70318066400272e+000, -6.71701171744144e+000, 5.06265634563488e-001, 2.65304205996029e+000 }
};

double Over1cc_6_MLP_22_8_2_output_bias[2]={ 1.73601068864282e+000, -1.70354260071145e+000 };

double Over1cc_6_MLP_22_8_2_max_input[22]={ 9.98205853844333e-001, 9.96754273526000e-001, 9.88273973642000e-001, 9.94484586788000e-001, 9.99979798185333e-001, 9.76060123067333e-001, 9.52733284084000e-001, 9.87684635119000e-001, 9.69573341435000e-001, 6.72263999322000e+000, 8.81938425504667e-001, 8.16193723420333e+000, 6.46031687483333e+000, 9.99252106464333e-001, 6.62255613583333e+000, 6.07940450162667e+000, 9.99999999999667e-001, 8.72043766244000e-001, 7.02255299145000e+000, 8.60739480852333e-001, 9.99345923680333e-001, 8.17330004459667e-001 };

double Over1cc_6_MLP_22_8_2_min_input[22]={ 9.52721802638333e-001, 9.43198268998333e-001, 9.25222052145667e-001, 9.22866729721667e-001, 8.14424454238667e-001, 8.49220519646333e-001, 8.08604996355667e-001, 8.10756773806000e-001, 8.12308146372000e-001, 4.59045323467000e+000, 5.74665956678667e-001, 5.22152556633667e+000, 3.66723035187000e+000, 6.35162254726333e-001, 4.08859126770667e+000, 3.25406740473667e+000, 6.17261118161667e-001, 3.89274609002333e-001, 3.28371146222667e+000, 3.66051471635667e-001, 5.87309286467000e-001, 3.12766281606667e-001 };

double Over1cc_6_MLP_22_8_2_input[22];
double Over1cc_6_MLP_22_8_2_hidden[8];
double Over1cc_6_MLP_22_8_2_output[2];

double Over1cc_6_MLP_22_8_2_MeanInputs[22]={ 9.80081546290821e-001, 9.77345870442747e-001, 9.68445460061317e-001, 9.69594031300026e-001, 9.93469783945517e-001, 9.23805996676869e-001, 8.90373090064010e-001, 9.35958806202452e-001, 9.23526263532740e-001, 5.80275234155330e+000, 7.46144412954567e-001, 6.68959782437721e+000, 5.11767729635330e+000, 9.09573969608779e-001, 5.44660949009885e+000, 4.89997422250522e+000, 8.92540199766663e-001, 6.94392499061394e-001, 5.23787381832914e+000, 6.48195949112430e-001, 8.41600640048571e-001, 6.59646113367811e-001 };

void Over1cc_6_MLP_22_8_2_FindMax(double* vec, double* max, long* maxIndex,int len)
{
  long i;
  *max = vec[0];
  *maxIndex = 0;
  for(i=1; i<len; i++)
  {
    if(vec[i]>*max)
    {
      *max = vec[i];
      *maxIndex = i;
    }
  }
}

void Over1cc_6_MLP_22_8_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over1cc_6_MLP_22_8_2_max_input[i]-Over1cc_6_MLP_22_8_2_min_input[i]);
	input[i] = minimum - delta*Over1cc_6_MLP_22_8_2_min_input[i]+ delta*input[i];
 }
}

void Over1cc_6_MLP_22_8_2_softmax(double* vec,int len)
{

  long i, j;
  double sum=0.0;
  for(i=0; i<len; i++)
  {
    if(vec[i]>200)
    {
      double max;
      long maxIndex;
      Over1cc_6_MLP_22_8_2_FindMax(vec, &max, &maxIndex,len);
      for(j=0; j<len; j++)
      {        if(j==maxIndex) vec[j] = 1.0;
        else vec[j] = 0.0;
      }
      return;
    }
    else
    {
      vec[i] = exp(vec[i]);
    }
    sum += vec[i];
  }
  if(sum==0)
  {
   long a = 1;
  }
  if(sum!=0.0)
  {
    for(i=0; i<len; i++) vec[i] = vec[i]/sum;
  }
  else for(i=0; i<len; i++) vec[i] = 1.0/(double)len;
}

void Over1cc_6_MLP_22_8_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==0) V_OUT[row] = tanh(V_OUT[row]);
   }
}

void Over1cc_6_MLP_22_8_2_RunNeuralNet_Classification () 
{
  Over1cc_6_MLP_22_8_2_ComputeFeedForwardSignals((double*)Over1cc_6_MLP_22_8_2_input_hidden_weights,Over1cc_6_MLP_22_8_2_input,Over1cc_6_MLP_22_8_2_hidden,Over1cc_6_MLP_22_8_2_hidden_bias,22, 8,0);
  Over1cc_6_MLP_22_8_2_ComputeFeedForwardSignals((double*)Over1cc_6_MLP_22_8_2_hidden_output_wts,Over1cc_6_MLP_22_8_2_hidden,Over1cc_6_MLP_22_8_2_output,Over1cc_6_MLP_22_8_2_output_bias,8, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-HLLglcmIdmn): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[0]);
	printf("%s","Cont. Input-1(wavelet-LHLglcmIdmn): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-LLLglrlmRunLengthNonUniformityNormalized): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-LHHglcmIdmn): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-LLHglcmImc2): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-HHLglcmIdn): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[5]);
	printf("%s","Cont. Input-6(originalglcmIdn): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-LHLglrlmShortRunEmphasis): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[7]);
	printf("%s","Cont. Input-8(originalglrlmRunLengthNonUniformityNormalized): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-LHHgldmDependenceEntropy): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[9]);
	printf("%s","Cont. Input-10(originalglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[10]);
	printf("%s","Cont. Input-11(wavelet-LLLglszmZoneEntropy): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[11]);
	printf("%s","Cont. Input-12(originalglrlmRunEntropy): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[12]);
	printf("%s","Cont. Input-13(wavelet-LLLglcmMCC): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[13]);
	printf("%s","Cont. Input-14(wavelet-LHLglszmZoneEntropy): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[14]);
	printf("%s","Cont. Input-15(wavelet-LLLglcmDifferenceEntropy): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[15]);
	printf("%s","Cont. Input-16(wavelet-LLHglcmMCC): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[16]);
	printf("%s","Cont. Input-17(wavelet-LHHglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[17]);
	printf("%s","Cont. Input-18(originalglcmSumEntropy): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[18]);
	printf("%s","Cont. Input-19(wavelet-LHLglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[19]);
	printf("%s","Cont. Input-20(wavelet-HLLglcmImc2): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[20]);
	printf("%s","Cont. Input-21(originalshapeSphericity): ");
	scanf("%lg",&Over1cc_6_MLP_22_8_2_input[21]);
	for(cont_inps=0;cont_inps<22;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over1cc_6_MLP_22_8_2_input[cont_inps] == -9999)
	  Over1cc_6_MLP_22_8_2_input[cont_inps]=Over1cc_6_MLP_22_8_2_MeanInputs[cont_inps];
	}
    Over1cc_6_MLP_22_8_2_ScaleInputs(Over1cc_6_MLP_22_8_2_input,0,1,22);
	Over1cc_6_MLP_22_8_2_RunNeuralNet_Classification();
   //Output Activation is Softmax;
	Over1cc_6_MLP_22_8_2_softmax(Over1cc_6_MLP_22_8_2_output, 2);
	for(i=0;i<2;i++)
	{
      if(max<Over1cc_6_MLP_22_8_2_output[i])
      {
        max=Over1cc_6_MLP_22_8_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

