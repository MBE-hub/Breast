//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over1cc_7_MLP_22_17_2_input_hidden_weights[17][22]=
{
 {2.21457547881423e+000, 3.48986307983000e+000, -3.28807984947118e+000, -2.03660914063439e+000, -3.10905695646275e+000, 3.37616432153079e+000, 1.24917007485289e+000, -3.20913399486714e+000, -8.90918598893253e-001, -9.45085807877828e-001, -3.93356504946762e+000, -1.48354494930950e-001, 4.00207280359394e+000, 7.99968758744030e-001, -5.84645235523324e-001, -4.43001720957707e+000, 1.79604317089494e+000, 6.04881866056753e+000, 5.07733380973009e+000, 5.19972264035790e+000, 8.28649425438217e-001, -8.36795943666169e+000 },
 {6.99694000361633e-001, 3.39120162877409e+000, -2.49855623356366e+000, 9.15851757990383e-001, -1.20407769390729e+000, 1.86824830533026e+000, 8.90147519806670e-001, -1.05842121015662e+000, -6.81002612694628e-002, 3.96677872704378e-002, -1.57806858187393e+000, 9.66894811196347e-003, -4.20717634311508e-001, 8.22609890456115e-001, -7.82691707842853e-001, -1.49057639411182e+000, -7.26652046762342e-001, 1.61061640748929e+000, -5.07684668687861e-001, 1.14484127437449e+000, -1.34229744584266e+000, -4.87373568693224e+000 },
 {2.09251267591029e-001, 3.57603817124712e+000, -2.40717388800955e+000, 9.90176567059308e-001, -1.28432414604540e+000, 2.10443295331259e+000, 1.75005473005571e+000, 1.42408389375722e-001, 2.20626411775755e-001, 3.09372070326037e-001, -1.41226278819253e+000, -5.91245020062917e-001, -1.31643166649510e+000, 2.21295130738078e+000, -7.59049980046085e-001, -1.11178054970420e+000, -5.83704040542102e-001, 1.61256887437263e+000, -1.74518690936740e+000, 9.36925909194808e-001, -1.01042452840801e+000, -5.91543865600097e+000 },
 {6.64844608507699e-001, 3.20220998689075e+000, -2.40542626165447e+000, 9.36119787761800e-001, -1.34556238537947e+000, 1.90266103310855e+000, 1.29907113944027e+000, -4.95017219284778e-001, -7.13892666796477e-002, 2.73580138328713e-001, -1.44512101982922e+000, -9.08835614575024e-002, -9.14156893580863e-001, 1.02203816721412e+000, -6.79843180522365e-001, -8.13414509098068e-001, -9.64226091748792e-001, 1.08235620814291e+000, -1.20334885397297e+000, 8.18940126187237e-001, -1.19390426174788e+000, -4.89762076232029e+000 },
 {1.10648130348224e+000, 7.35034865397329e+000, -5.37785764629392e+000, 2.68307463300002e+000, -3.07025129191176e+000, 3.88372230648138e+000, 1.93030265899906e+000, -2.85172219922874e+000, -6.64427814449933e-001, 1.68555042092067e-001, -4.08875640948187e+000, 1.50214793731105e-001, -6.65942110503980e-001, 9.72120093508638e-001, -1.67267458537495e+000, -3.74818785357053e+000, -1.98793879271272e+000, 3.46210342603681e+000, -5.90782039088691e-001, 2.43695318562740e+000, -3.44362723346660e+000, -1.05631745460702e+001 },
 {-2.19976958686872e-001, 1.71494428071834e+000, -2.15192600152173e+000, -6.23708526477080e-001, -5.13244607907656e-001, 1.09884634476825e+000, -4.31126612662682e-002, -7.05461271407344e-001, 1.82772957374584e-001, -7.63041148703046e-001, -9.24938991187861e-001, -7.01485282621249e-001, -1.25090928876037e-001, 1.97159718416158e+000, -1.06891520638531e+000, -1.21905381921129e+000, 2.62524552527613e-001, 1.42122947884387e+000, 2.25661716902179e-003, 6.13635131082915e-001, 7.32399728169551e-001, -2.67984321683280e+000 },
 {6.44598316848342e-001, 3.99062005379128e+000, -2.78857353000042e+000, 1.17377885835057e+000, -1.53707103533863e+000, 2.31166893148633e+000, 1.47691784231504e+000, -8.06583185236459e-001, -3.06643085103100e-002, 3.46777104430253e-001, -1.68850209050162e+000, -7.44312083088508e-002, -6.28849492514983e-001, 1.46030703948346e+000, -7.00978874859548e-001, -1.46961806162498e+000, -8.82395508718538e-001, 1.87893688540890e+000, -8.79589888836889e-001, 1.23558993468707e+000, -1.39261793711195e+000, -5.95652805314127e+000 },
 {1.28984174315431e-001, 4.62511051363399e+000, -3.56946162770193e+000, 9.27530149666761e-001, -2.59697685247382e+000, 2.71855674194258e+000, 1.53768997264587e+000, -1.07738729913025e+000, -1.70906024439904e-001, 2.77393189846486e-001, -2.27439106210262e+000, -3.48193404634692e-001, -6.97283495589245e-001, 2.10226194402779e+000, -9.96534549646750e-001, -2.15407215523521e+000, -1.38411644873165e+000, 2.48390854292561e+000, -9.33511653475138e-001, 1.52056308891330e+000, -1.60237324892501e+000, -8.31312329073592e+000 },
 {9.02773715846290e-001, 4.97601505831193e+000, -4.00037513941675e+000, 1.86005837501898e+000, -2.30759979836636e+000, 2.52361398325167e+000, 1.00609288681503e+000, -2.76996267537199e+000, -7.81023854079345e-001, -1.34584691516721e-002, -3.07089174822018e+000, 3.67443284252949e-001, 2.24354711307421e-002, 9.08683328869556e-002, -1.25215910826627e+000, -3.23441482059564e+000, -1.45755649614381e+000, 2.49801066872222e+000, 2.62166109675890e-001, 1.98180871127021e+000, -2.78557100163488e+000, -7.18818760569667e+000 },
 {7.06861811095690e-001, 4.42136432147932e+000, -3.18848086728797e+000, 1.21194961861059e+000, -1.77252095235985e+000, 2.51227477073150e+000, 1.45925077629877e+000, -1.02671504453871e+000, -7.36705177634256e-002, 3.01043974397880e-001, -1.98997927920178e+000, -5.01305403240037e-002, -5.91439987211986e-001, 1.57918868738280e+000, -8.70735035860033e-001, -1.82461461858582e+000, -9.93859384987393e-001, 2.17165437875203e+000, -7.09650518131375e-001, 1.44241579923727e+000, -1.62428863675780e+000, -6.66042669496845e+000 },
 {1.13870511574129e+000, 6.66523840403458e+000, -4.53343539532041e+000, 5.06530694758702e+000, -6.91615964643106e-001, 2.46547822880630e+000, 3.87768015981143e-001, -4.39683998578926e+000, -1.20471771762832e+000, -5.32084124874623e-001, -5.85023337658159e+000, 7.90866365252964e-001, 1.92283122229065e+000, -1.15132183658559e+000, -1.40833075223564e+000, -8.14299118758793e+000, 1.11021036486886e+000, 5.43502573304118e+000, 3.19887265483476e+000, 4.37829279812312e+000, -5.43445749550639e+000, -6.42366772065556e+000 },
 {1.98289274987714e+000, 2.95498816592603e+000, -1.53840716576564e+000, 2.58480503813204e+000, -2.51935562485168e-001, 2.56247964777910e+000, 2.34527376547956e+000, 1.27705065275663e+000, -1.82979655391154e-001, 1.39370670587678e+000, -9.31466993585498e-001, 2.00016837016707e-001, -2.69829615775439e+000, -1.59619889510988e+000, 4.11864022909403e-001, 2.53826607695241e+000, -3.00136946638585e+000, -1.81190572112942e+000, -3.28895323418531e+000, -5.28656897065207e-001, -1.17793207764364e+000, -2.62921355558523e+000 },
 {3.81774911248241e-001, 3.18664573069525e+000, 9.23297096190622e-001, 2.70503383910333e+000, 1.08070440811704e+000, 4.37851182360241e-001, 3.80656321161729e+000, 1.42131468110629e+000, 1.59683705186860e-001, 1.85883205910635e-001, -2.05671414690179e+000, -1.24289285698590e+000, -5.17037186466037e+000, -7.75038066257602e-001, -2.45506920193358e+000, 2.09977360783014e+000, 9.66323804635029e-001, -2.81283645459654e+000, -6.37269283578766e+000, -1.02987295042128e-001, -1.53919017886356e+000, -2.54932618931916e+000 },
 {4.41456649198377e+000, 5.48750249557627e+000, -9.57822562877374e+000, -3.93403367657495e+000, 5.19380770905285e-002, 4.58306039218815e+000, -2.40193417249324e-001, -4.94032054435050e+000, -1.28926339889689e+000, -4.85063073272144e+000, -4.38644455837289e+000, -3.62927980401680e+000, 1.23061182655472e+000, 5.16649141034812e+000, -3.41454323778870e+000, -6.42863624930501e+000, 3.92798816945172e+000, 4.99951156703571e+000, 3.82391084395427e+000, 1.09752165628627e+000, 3.38373776483827e+000, -4.77223976277926e+000 },
 {3.26655834144649e-001, 2.70885276663203e+000, -2.64677281541387e+000, 3.59295565887734e-002, -1.23909986175680e+000, 1.31169449893146e+000, -1.18218641799786e-003, -1.38803067261781e+000, -2.38234539009892e-002, -5.44840568022452e-001, -1.40355560881813e+000, -3.17291252697353e-001, -3.20372428591063e-001, 9.51415972613534e-001, -1.22244396522000e+000, -2.02725362722024e+000, -5.15013809406106e-001, 1.44721825531711e+000, -3.70258360026217e-001, 1.04974705099522e+000, -1.03250461142506e+000, -4.38025663495045e+000 },
 {1.03399047405870e+000, 3.43653246975291e+000, -4.26478133028202e+000, -9.90528847654424e-001, -9.18250579036056e-001, 2.44006567190690e+000, -1.78817737821589e-001, -1.68135412824044e+000, 1.51369730134562e-001, -1.65061308599770e+000, -1.57726852192671e+000, -8.57832323395992e-001, 1.08211674664050e-001, 2.69922650150929e+000, -1.56894841661089e+000, -2.74234546501373e+000, -3.29207982697458e-001, 2.36732316691581e+000, 4.04349233988901e-001, 1.38878196393108e+000, 2.03195380439180e-002, -4.47233785700670e+000 },
 {1.25691252819393e+000, 3.48392003605432e+000, -2.28697318089147e+000, 1.54846261692808e+000, -7.19722378782368e-001, 2.42242904962340e+000, 1.76117588756804e+000, 1.54178885911044e-001, 2.20579160308683e-001, 9.21363530759539e-001, -1.12429858927127e+000, -1.52322643348503e-002, -1.88587311790219e+000, -4.11031879342624e-002, -4.70656713313953e-001, 5.01357468858740e-001, -1.72331679442026e+000, 7.46084788786118e-002, -2.41468243693215e+000, 2.54595598008270e-001, -1.10778547037163e+000, -4.36885980632359e+000 } 
};

double Over1cc_7_MLP_22_17_2_hidden_bias[17]={ -7.80642334612845e-002, -1.34245484293249e-001, -2.98353251849763e-001, -3.78391702186391e-001, -4.43643692113323e-001, 2.15188388697879e-001, -1.90229162177673e-001, -9.94732054973274e-001, -2.66334288726651e-001, -2.76201770807686e-001, 2.74318510368399e+000, -1.84767426852543e-001, 6.91260337616776e-001, 3.50684702146772e+000, -1.36301942699525e-001, 7.19416747156036e-001, -1.82858747962875e-001 };

double Over1cc_7_MLP_22_17_2_hidden_output_wts[2][17]=
{
 {3.08511080443316e+000, -6.43432042679421e-001, -1.22778887903563e+000, -1.15805432057517e+000, 1.21300374739101e+000, 6.40326310668696e-001, -5.24414063897673e-001, -1.34113474550151e+000, 4.79136152644194e-001, -3.14682241639296e-001, 2.97193512522372e+000, -2.42921370884239e+000, -4.21778960413465e+000, 5.43454095446035e+000, 3.08461658617375e-001, 2.78403957970739e+000, -2.46246048325913e+000 },
 {-3.04746616037083e+000, 6.49729811519978e-001, 1.21310948525669e+000, 1.16775807497098e+000, -1.21596666898509e+000, -6.46931608296544e-001, 5.69985329294066e-001, 1.36619173602318e+000, -4.30941399115846e-001, 3.48314264911185e-001, -2.98899260683573e+000, 2.36733342543217e+000, 4.22076772297400e+000, -5.44285400672020e+000, -3.09875663298737e-001, -2.72676059700167e+000, 2.47372753259255e+000 }
};

double Over1cc_7_MLP_22_17_2_output_bias[2]={ 1.76780007525312e-001, -1.88714784050305e-001 };

double Over1cc_7_MLP_22_17_2_max_input[22]={ 9.98205853844333e-001, 9.96754273526000e-001, 9.88273973642000e-001, 9.94484586788000e-001, 9.99979798185333e-001, 9.76060123067333e-001, 9.52733284084000e-001, 9.87684635119000e-001, 9.69573341435000e-001, 6.72263999322000e+000, 8.81938425504667e-001, 8.16193723420333e+000, 6.46031687483333e+000, 9.99252106464333e-001, 6.62255613583333e+000, 6.07940450162667e+000, 9.99999999999667e-001, 8.72043766244000e-001, 7.02255299145000e+000, 8.60739480852333e-001, 9.99345923680333e-001, 8.17330004459667e-001 };

double Over1cc_7_MLP_22_17_2_min_input[22]={ 9.52721802638333e-001, 9.43198268998333e-001, 9.25222052145667e-001, 9.22866729721667e-001, 8.14424454238667e-001, 8.49220519646333e-001, 8.08604996355667e-001, 8.10756773806000e-001, 8.12308146372000e-001, 4.59045323467000e+000, 5.74665956678667e-001, 5.22152556633667e+000, 3.66723035187000e+000, 6.35162254726333e-001, 4.08859126770667e+000, 3.25406740473667e+000, 6.17261118161667e-001, 3.89274609002333e-001, 3.28371146222667e+000, 3.66051471635667e-001, 5.87309286467000e-001, 3.12766281606667e-001 };

double Over1cc_7_MLP_22_17_2_input[22];
double Over1cc_7_MLP_22_17_2_hidden[17];
double Over1cc_7_MLP_22_17_2_output[2];

double Over1cc_7_MLP_22_17_2_MeanInputs[22]={ 9.80081546290821e-001, 9.77345870442747e-001, 9.68445460061317e-001, 9.69594031300026e-001, 9.93469783945517e-001, 9.23805996676869e-001, 8.90373090064010e-001, 9.35958806202452e-001, 9.23526263532740e-001, 5.80275234155330e+000, 7.46144412954567e-001, 6.68959782437721e+000, 5.11767729635330e+000, 9.09573969608779e-001, 5.44660949009885e+000, 4.89997422250522e+000, 8.92540199766663e-001, 6.94392499061394e-001, 5.23787381832914e+000, 6.48195949112430e-001, 8.41600640048571e-001, 6.59646113367811e-001 };

void Over1cc_7_MLP_22_17_2_FindMax(double* vec, double* max, long* maxIndex,int len)
{
  long i;
  *max = vec[0];
  *maxIndex = 0;
  for(i=1; i<len; i++)
  {
    if(vec[i]>*max)
    {
      *max = vec[i];
      *maxIndex = i;
    }
  }
}

void Over1cc_7_MLP_22_17_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over1cc_7_MLP_22_17_2_max_input[i]-Over1cc_7_MLP_22_17_2_min_input[i]);
	input[i] = minimum - delta*Over1cc_7_MLP_22_17_2_min_input[i]+ delta*input[i];
 }
}

void Over1cc_7_MLP_22_17_2_softmax(double* vec,int len)
{

  long i, j;
  double sum=0.0;
  for(i=0; i<len; i++)
  {
    if(vec[i]>200)
    {
      double max;
      long maxIndex;
      Over1cc_7_MLP_22_17_2_FindMax(vec, &max, &maxIndex,len);
      for(j=0; j<len; j++)
      {        if(j==maxIndex) vec[j] = 1.0;
        else vec[j] = 0.0;
      }
      return;
    }
    else
    {
      vec[i] = exp(vec[i]);
    }
    sum += vec[i];
  }
  if(sum==0)
  {
   long a = 1;
  }
  if(sum!=0.0)
  {
    for(i=0; i<len; i++) vec[i] = vec[i]/sum;
  }
  else for(i=0; i<len; i++) vec[i] = 1.0/(double)len;
}

void Over1cc_7_MLP_22_17_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==0) V_OUT[row] = exp(V_OUT[row]);
   }
}

void Over1cc_7_MLP_22_17_2_RunNeuralNet_Classification () 
{
  Over1cc_7_MLP_22_17_2_ComputeFeedForwardSignals((double*)Over1cc_7_MLP_22_17_2_input_hidden_weights,Over1cc_7_MLP_22_17_2_input,Over1cc_7_MLP_22_17_2_hidden,Over1cc_7_MLP_22_17_2_hidden_bias,22, 17,0);
  Over1cc_7_MLP_22_17_2_ComputeFeedForwardSignals((double*)Over1cc_7_MLP_22_17_2_hidden_output_wts,Over1cc_7_MLP_22_17_2_hidden,Over1cc_7_MLP_22_17_2_output,Over1cc_7_MLP_22_17_2_output_bias,17, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-HLLglcmIdmn): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[0]);
	printf("%s","Cont. Input-1(wavelet-LHLglcmIdmn): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-LLLglrlmRunLengthNonUniformityNormalized): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-LHHglcmIdmn): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-LLHglcmImc2): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-HHLglcmIdn): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[5]);
	printf("%s","Cont. Input-6(originalglcmIdn): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-LHLglrlmShortRunEmphasis): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[7]);
	printf("%s","Cont. Input-8(originalglrlmRunLengthNonUniformityNormalized): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-LHHgldmDependenceEntropy): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[9]);
	printf("%s","Cont. Input-10(originalglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[10]);
	printf("%s","Cont. Input-11(wavelet-LLLglszmZoneEntropy): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[11]);
	printf("%s","Cont. Input-12(originalglrlmRunEntropy): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[12]);
	printf("%s","Cont. Input-13(wavelet-LLLglcmMCC): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[13]);
	printf("%s","Cont. Input-14(wavelet-LHLglszmZoneEntropy): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[14]);
	printf("%s","Cont. Input-15(wavelet-LLLglcmDifferenceEntropy): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[15]);
	printf("%s","Cont. Input-16(wavelet-LLHglcmMCC): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[16]);
	printf("%s","Cont. Input-17(wavelet-LHHglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[17]);
	printf("%s","Cont. Input-18(originalglcmSumEntropy): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[18]);
	printf("%s","Cont. Input-19(wavelet-LHLglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[19]);
	printf("%s","Cont. Input-20(wavelet-HLLglcmImc2): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[20]);
	printf("%s","Cont. Input-21(originalshapeSphericity): ");
	scanf("%lg",&Over1cc_7_MLP_22_17_2_input[21]);
	for(cont_inps=0;cont_inps<22;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over1cc_7_MLP_22_17_2_input[cont_inps] == -9999)
	  Over1cc_7_MLP_22_17_2_input[cont_inps]=Over1cc_7_MLP_22_17_2_MeanInputs[cont_inps];
	}
    Over1cc_7_MLP_22_17_2_ScaleInputs(Over1cc_7_MLP_22_17_2_input,0,1,22);
	Over1cc_7_MLP_22_17_2_RunNeuralNet_Classification();
   //Output Activation is Softmax;
	Over1cc_7_MLP_22_17_2_softmax(Over1cc_7_MLP_22_17_2_output, 2);
	for(i=0;i<2;i++)
	{
      if(max<Over1cc_7_MLP_22_17_2_output[i])
      {
        max=Over1cc_7_MLP_22_17_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

