//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over1cc_10_MLP_22_7_2_input_hidden_weights[7][22]=
{
 {1.40710708526088e+000, 6.79630378669064e+000, -6.36683362899302e+000, 1.01548969525583e+000, -2.38597967039734e+000, 3.09851428539253e+000, 1.99229982072497e+000, -2.21432580315472e+000, -9.23381128622787e-001, 5.37133478001634e-003, -3.62629475327896e+000, -3.83143155222416e-001, -1.67297083422733e+000, 2.41292018368858e+000, -2.06964601356071e+000, -2.91950519176724e+000, -1.62958395755204e+000, 2.81205485860703e+000, -1.84640640496838e+000, 1.38986134248337e+000, -2.60988780983120e+000, -9.94864853058005e+000 },
 {-1.77885763117210e+000, -1.21380613681012e+001, 4.72914499881050e+000, -7.07409881852395e+000, 3.95506196663264e+000, -7.41911168646477e+000, 1.00067470675119e+000, 6.19991627214902e+000, -1.14448553498365e+000, 2.92343042222136e-001, 6.64695859101423e+000, -7.76157379316832e-001, -1.03354718861273e+000, 4.10113098005107e+000, 2.26895326952919e+000, 6.29996904728111e+000, 5.70052348612748e-001, -4.33497153387846e+000, -2.02325532640224e+000, -5.27335748285282e+000, 5.50157796366057e+000, 1.27939268319562e+001 },
 {2.73014031287878e+000, 9.74371041509178e+000, -7.30421538419994e+000, 3.89538771574529e+000, -1.53213952846162e+000, 4.48447302157939e+000, 2.79412690345609e+000, -3.23793736481531e+000, -9.23447768414708e-001, -3.49631306272928e-001, -5.47044623964758e+000, 4.47463187293566e-001, -1.30718138998182e+000, 2.07282326657860e+000, -2.30920229519507e+000, -5.14330005370114e+000, -1.75565958324640e+000, 3.38643928976955e+000, -1.02104696061190e+000, 3.01283650942201e+000, -4.94611006972926e+000, -9.97094084004516e+000 },
 {-4.42692139265326e+000, -7.74448720502850e+000, 1.15518305931570e+001, 4.28738975749247e+000, 8.59311737997772e-001, -8.53379952832124e+000, 2.57205668641702e-001, 5.48475612124729e+000, -1.21319075194309e+000, 8.37298077936828e+000, 3.15593309366428e+000, 3.55939912497893e+000, -2.84876488254216e+000, -4.99303646648554e+000, 4.08851110203100e+000, 9.85080678675154e+000, -3.48156071881441e+000, -6.05175698679975e+000, -4.74620785374648e+000, -4.42079365633801e+000, -5.28337373909535e+000, 7.81067514241072e+000 },
 {-1.50815123949243e+000, -6.69272520030862e+000, 7.46009277442441e+000, -8.15424072357635e-001, 2.62192835562163e+000, -5.80137273883697e+000, -3.15140131830168e+000, -1.49529078249178e+000, 9.48739250906485e-002, -3.36090290837524e+000, 1.00490214434323e+000, 5.80541338422725e-001, 2.37623537358867e+000, -1.03351775182796e+000, -9.05910316962007e-001, 4.53114217037140e-001, 6.23582778959723e+000, -5.22638168035364e+000, 3.28413111429784e+000, -1.60794243362710e+000, 3.60663209851252e+000, 1.28903999241725e+001 },
 {4.62521562062052e-001, 3.31994552896363e+000, -2.84873935551164e+000, 7.51432551296854e-001, -1.27157035338979e+000, 1.77992615763574e+000, 1.29580168029094e+000, -8.89805311675886e-001, -4.59867760846733e-001, 1.37676692392776e-001, -1.79008598968699e+000, -2.68004498667035e-001, -8.03749535333961e-001, 1.57252248951017e+000, -9.44323531057974e-001, -1.54320261799922e+000, -6.37866932367570e-001, 1.72809177429695e+000, -9.74237552241269e-001, 9.26317538313418e-001, -1.19699275906976e+000, -5.19157533736620e+000 },
 {-3.91496269066710e-001, 3.81436870512337e+000, 2.15428302154246e+000, 4.15179886100591e+000, 9.94188167065154e-001, -2.02004360412307e+000, 4.63946536711532e+000, -7.21220578789861e-001, 4.71110034795014e-001, 8.13272793545687e-001, -3.49776106057604e+000, -1.58085526476845e+000, -4.17583871651684e+000, -1.96078120887518e+000, -4.52852612090824e+000, 2.57722535984572e+000, 2.54234423446174e+000, -1.78506009986891e+000, -5.08032020851154e+000, -1.14229166031298e+000, -1.12957767015920e+000, -2.44056900349247e+000 } 
};

double Over1cc_10_MLP_22_7_2_hidden_bias[7]={ 7.26211014469023e-002, -4.51388000645924e-002, 2.02779876263483e+000, -3.18259123581673e+000, -8.91905692506496e-002, -1.22970126221151e-001, 1.22327940295716e+000 };

double Over1cc_10_MLP_22_7_2_hidden_output_wts[2][7]=
{
 {-2.70329894448790e+000, -5.58846104889171e+000, 4.70258505227806e+000, -2.95525912029327e+000, 4.59251086710850e+000, -2.27808441303343e+000, -2.08211996582095e+000 },
 {2.68127205612438e+000, 5.56875446178621e+000, -4.63578327672744e+000, 3.02989685479991e+000, -4.57741274273431e+000, 2.35752490503716e+000, 2.12648815003895e+000 }
};

double Over1cc_10_MLP_22_7_2_output_bias[2]={ 2.01999178691726e+000, -1.93365325484809e+000 };

double Over1cc_10_MLP_22_7_2_max_input[22]={ 9.98205853844333e-001, 9.96754273526000e-001, 9.88273973642000e-001, 9.94484586788000e-001, 9.99979798185333e-001, 9.76060123067333e-001, 9.52733284084000e-001, 9.87684635119000e-001, 9.69573341435000e-001, 6.72263999322000e+000, 8.81938425504667e-001, 8.16193723420333e+000, 6.46031687483333e+000, 9.99252106464333e-001, 6.62255613583333e+000, 6.07940450162667e+000, 9.99999999999667e-001, 8.72043766244000e-001, 7.02255299145000e+000, 8.60739480852333e-001, 9.99345923680333e-001, 8.17330004459667e-001 };

double Over1cc_10_MLP_22_7_2_min_input[22]={ 9.52721802638333e-001, 9.43198268998333e-001, 9.25222052145667e-001, 9.22866729721667e-001, 8.14424454238667e-001, 8.49220519646333e-001, 8.08604996355667e-001, 8.10756773806000e-001, 8.12308146372000e-001, 4.59045323467000e+000, 5.74665956678667e-001, 5.22152556633667e+000, 3.66723035187000e+000, 6.35162254726333e-001, 4.08859126770667e+000, 3.25406740473667e+000, 6.17261118161667e-001, 3.89274609002333e-001, 3.28371146222667e+000, 3.66051471635667e-001, 5.87309286467000e-001, 3.12766281606667e-001 };

double Over1cc_10_MLP_22_7_2_input[22];
double Over1cc_10_MLP_22_7_2_hidden[7];
double Over1cc_10_MLP_22_7_2_output[2];

double Over1cc_10_MLP_22_7_2_MeanInputs[22]={ 9.80081546290821e-001, 9.77345870442747e-001, 9.68445460061317e-001, 9.69594031300026e-001, 9.93469783945517e-001, 9.23805996676869e-001, 8.90373090064010e-001, 9.35958806202452e-001, 9.23526263532740e-001, 5.80275234155330e+000, 7.46144412954567e-001, 6.68959782437721e+000, 5.11767729635330e+000, 9.09573969608779e-001, 5.44660949009885e+000, 4.89997422250522e+000, 8.92540199766663e-001, 6.94392499061394e-001, 5.23787381832914e+000, 6.48195949112430e-001, 8.41600640048571e-001, 6.59646113367811e-001 };

void Over1cc_10_MLP_22_7_2_FindMax(double* vec, double* max, long* maxIndex,int len)
{
  long i;
  *max = vec[0];
  *maxIndex = 0;
  for(i=1; i<len; i++)
  {
    if(vec[i]>*max)
    {
      *max = vec[i];
      *maxIndex = i;
    }
  }
}

void Over1cc_10_MLP_22_7_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over1cc_10_MLP_22_7_2_max_input[i]-Over1cc_10_MLP_22_7_2_min_input[i]);
	input[i] = minimum - delta*Over1cc_10_MLP_22_7_2_min_input[i]+ delta*input[i];
 }
}

void Over1cc_10_MLP_22_7_2_softmax(double* vec,int len)
{

  long i, j;
  double sum=0.0;
  for(i=0; i<len; i++)
  {
    if(vec[i]>200)
    {
      double max;
      long maxIndex;
      Over1cc_10_MLP_22_7_2_FindMax(vec, &max, &maxIndex,len);
      for(j=0; j<len; j++)
      {        if(j==maxIndex) vec[j] = 1.0;
        else vec[j] = 0.0;
      }
      return;
    }
    else
    {
      vec[i] = exp(vec[i]);
    }
    sum += vec[i];
  }
  if(sum==0)
  {
   long a = 1;
  }
  if(sum!=0.0)
  {
    for(i=0; i<len; i++) vec[i] = vec[i]/sum;
  }
  else for(i=0; i<len; i++) vec[i] = 1.0/(double)len;
}

void Over1cc_10_MLP_22_7_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==0) V_OUT[row] = tanh(V_OUT[row]);
   }
}

void Over1cc_10_MLP_22_7_2_RunNeuralNet_Classification () 
{
  Over1cc_10_MLP_22_7_2_ComputeFeedForwardSignals((double*)Over1cc_10_MLP_22_7_2_input_hidden_weights,Over1cc_10_MLP_22_7_2_input,Over1cc_10_MLP_22_7_2_hidden,Over1cc_10_MLP_22_7_2_hidden_bias,22, 7,0);
  Over1cc_10_MLP_22_7_2_ComputeFeedForwardSignals((double*)Over1cc_10_MLP_22_7_2_hidden_output_wts,Over1cc_10_MLP_22_7_2_hidden,Over1cc_10_MLP_22_7_2_output,Over1cc_10_MLP_22_7_2_output_bias,7, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-HLLglcmIdmn): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[0]);
	printf("%s","Cont. Input-1(wavelet-LHLglcmIdmn): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-LLLglrlmRunLengthNonUniformityNormalized): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-LHHglcmIdmn): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-LLHglcmImc2): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-HHLglcmIdn): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[5]);
	printf("%s","Cont. Input-6(originalglcmIdn): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-LHLglrlmShortRunEmphasis): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[7]);
	printf("%s","Cont. Input-8(originalglrlmRunLengthNonUniformityNormalized): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-LHHgldmDependenceEntropy): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[9]);
	printf("%s","Cont. Input-10(originalglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[10]);
	printf("%s","Cont. Input-11(wavelet-LLLglszmZoneEntropy): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[11]);
	printf("%s","Cont. Input-12(originalglrlmRunEntropy): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[12]);
	printf("%s","Cont. Input-13(wavelet-LLLglcmMCC): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[13]);
	printf("%s","Cont. Input-14(wavelet-LHLglszmZoneEntropy): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[14]);
	printf("%s","Cont. Input-15(wavelet-LLLglcmDifferenceEntropy): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[15]);
	printf("%s","Cont. Input-16(wavelet-LLHglcmMCC): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[16]);
	printf("%s","Cont. Input-17(wavelet-LHHglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[17]);
	printf("%s","Cont. Input-18(originalglcmSumEntropy): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[18]);
	printf("%s","Cont. Input-19(wavelet-LHLglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[19]);
	printf("%s","Cont. Input-20(wavelet-HLLglcmImc2): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[20]);
	printf("%s","Cont. Input-21(originalshapeSphericity): ");
	scanf("%lg",&Over1cc_10_MLP_22_7_2_input[21]);
	for(cont_inps=0;cont_inps<22;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over1cc_10_MLP_22_7_2_input[cont_inps] == -9999)
	  Over1cc_10_MLP_22_7_2_input[cont_inps]=Over1cc_10_MLP_22_7_2_MeanInputs[cont_inps];
	}
    Over1cc_10_MLP_22_7_2_ScaleInputs(Over1cc_10_MLP_22_7_2_input,0,1,22);
	Over1cc_10_MLP_22_7_2_RunNeuralNet_Classification();
   //Output Activation is Softmax;
	Over1cc_10_MLP_22_7_2_softmax(Over1cc_10_MLP_22_7_2_output, 2);
	for(i=0;i<2;i++)
	{
      if(max<Over1cc_10_MLP_22_7_2_output[i])
      {
        max=Over1cc_10_MLP_22_7_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

