//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over1cc_1_MLP_22_14_2_input_hidden_weights[14][22]=
{
 {1.01440669974457e-002, 2.34539394639109e-002, 8.88897488619962e-003, -2.34747098216850e-003, 1.34586777045422e-002, -9.12323431483199e-003, -2.13962995087855e-002, 1.03658750750381e-002, 1.48755955447571e-002, 2.29564681230447e-003, -2.58494608276245e-002, 2.03256751582372e-002, 7.82815979308093e-003, -1.95821398471253e-002, 7.10678436280180e-003, 2.31637924274467e-002, 5.51295642707184e-003, -2.08030447505112e-003, -2.71558954382663e-002, 8.65419383009592e-003, -1.33939962867032e-002, 6.46200198586602e-003 },
 {1.06056224459094e-002, 1.04155384047301e-002, -1.84349537906779e-002, 1.33528873223593e-003, 2.82414976286191e-002, -1.50780104163571e-002, 2.44428511529093e-002, 1.09350718312210e-002, 3.89299730122382e-002, -6.93210212976017e-003, 2.40397901202353e-002, 1.44557209067746e-002, 3.30295891009573e-002, -2.48866516420136e-002, -1.07691710937066e-002, 6.75758732179464e-003, 3.92777477177783e-002, -2.45789009880612e-002, 3.53371289348416e-003, 1.02116276228081e-002, 3.80433740096485e-002, 1.09697409672110e-003 },
 {8.02475918015674e-003, -1.33410661882621e-002, 2.03986432211440e-002, -2.29979164618159e-002, -1.77341753392660e-002, 2.80613086992611e-002, -2.30764057882342e-002, -4.38136657099525e-002, -2.55867530652584e-002, 1.78053428606520e-002, -9.96391324147427e-003, -1.65751837117452e-002, -9.02056464120709e-003, 1.84389277702358e-002, -7.19504519692238e-002, -6.00781624113112e-003, 2.27323055077762e-002, 2.45162343380785e-003, -8.43851489488936e-003, 4.94950350385751e-002, -3.14790606011046e-003, 1.36758720731184e-002 },
 {-2.68753818234216e-002, -2.15260423768854e-003, 4.06029193599183e-002, 2.82321699569960e-002, 9.93037734575416e-003, -3.33735282482020e-002, 3.41008005775483e-003, -2.44424673693145e-002, -1.55094218683504e-002, 3.03951110891044e-003, 3.87395264197962e-003, 7.50996404021738e-003, -1.45448469709299e-002, 2.24692112539374e-002, 2.19256794074203e-003, 3.18406296529163e-002, 2.71622606740256e-002, -3.11450820166656e-002, 2.97700506276968e-002, 4.60484978414337e-003, 2.17829426506625e-002, 2.36980128070048e-003 },
 {1.48421642270604e-003, -5.70597209165068e-003, 6.21465718427657e-002, 2.88256483421463e-002, 8.59061863744675e-003, -1.30806331002864e-002, -1.01826555039299e-002, -9.90790951545476e-003, -1.77152572591441e-002, 2.98349387510492e-004, 8.86042800817341e-004, -5.63028076526952e-003, 1.39370600462627e-003, 1.13990621307422e-002, -3.48379179318100e-002, 2.25803856057263e-003, -7.53855066981432e-003, -3.77708148473235e-003, 3.25285423785679e-002, -1.99645537892399e-002, -5.51796790912528e-003, -1.23833107457339e-002 },
 {1.27396943329062e-003, -7.58925691386752e-003, 1.24914452927785e-003, 1.94957195627285e-002, 1.12411028457103e-002, 2.44509486674512e-002, 7.59813602602275e-003, 5.77324438687693e-003, -3.78174763684636e-003, -2.24488301228349e-002, -7.34208770262702e-003, -1.67618935048425e-002, 2.01145208887834e-002, 1.57308313414632e-002, 2.87841698396826e-002, 2.16338580852564e-002, -6.20496196128303e-003, -3.51835981629259e-002, -2.11026750621479e-002, -3.03008484235817e-002, -4.50264967192135e-003, -2.42356826631961e-002 },
 {-1.23931967316196e-002, 2.42714393407878e-004, -6.21945679227871e-003, -1.09423094084536e-002, -1.56046805368125e-002, -4.63885477052791e-002, -3.38696032618572e-002, 3.21974627034796e-003, -1.74453793823638e-002, 1.98913091620887e-002, 1.31148549642447e-002, 7.36921334006415e-003, -7.27104890839373e-003, -3.03263587446396e-002, -8.06854182450044e-003, 8.78472698489902e-003, 6.71222667393646e-003, -1.50588052774414e-003, 3.03682867161655e-003, -1.33549370001571e-002, 1.45585293205505e-002, -6.98109959794400e-003 },
 {2.24089608084547e-002, 1.37101392852179e-002, 3.97549013228916e-002, 1.20384958904574e-002, 2.75986180979242e-003, 2.94761145797040e-002, 3.00610345239270e-002, -1.55719550876847e-002, 3.78205964635045e-003, -1.62694311715976e-002, 3.77474165105819e-004, 7.82311259100853e-003, -2.38916258022643e-002, 9.49567052519365e-003, -7.62261318934918e-004, 4.06003885661889e-002, -4.62664471696586e-005, -3.30139231277950e-002, 5.04125113003987e-004, 1.89717618294992e-003, 3.65409120180299e-002, -1.09398784072286e-002 },
 {-1.87861002587285e-003, -3.17292907681902e-002, 3.05816794815407e-003, 1.24545023302586e-003, -1.73282215923121e-002, -1.61356181026653e-002, -1.70997836697520e-002, -3.94109241055519e-003, 6.40854620477444e-004, 2.41097760113251e-002, 1.17214616326842e-002, -1.56053826212175e-002, -7.84416159222447e-003, -4.06338597177633e-002, 2.15290122565876e-003, 5.40679511403944e-003, -2.72831632560272e-002, -1.68275254278284e-002, -3.97333289344047e-002, -4.87173688275340e-003, -7.58448492176108e-003, 4.83867129627193e-003 },
 {3.55550054071125e-003, 1.23344285715103e-002, 2.68399295522601e-002, 1.78803467639858e-003, 1.56843781822742e-002, -9.70405263584243e-003, -1.56223848632173e-003, -1.18486778751231e-002, -1.62864118470175e-002, 2.21665323973680e-002, 1.39138980659464e-002, 7.62261610293705e-003, -1.06380433478055e-002, 1.40617489060289e-002, -5.15193974634468e-004, 1.19202157264835e-002, -2.78905911759430e-002, 7.45390745584410e-003, -1.04834718005006e-002, 2.54123891060255e-002, 1.72381053146017e-002, 5.97086903972939e-003 },
 {-3.27965683456143e-002, 1.66764281675624e-002, -3.67642097733943e-002, 5.26388926658328e-003, -3.38757846295472e-005, 4.67529477934606e-003, 1.26165200256433e-002, -4.14152162332722e-002, -3.67221647667150e-002, -3.64761744659069e-003, 1.08465529089802e-003, 2.02483742238322e-003, -4.30954435086692e-002, -4.72742092601775e-003, 2.17656077344721e-002, -3.25449398234044e-002, 5.50570114889347e-003, 3.32694778920943e-002, -1.42382105841934e-002, 6.93061127681674e-003, 3.07425964380420e-002, 3.57319558968864e-002 },
 {1.71302940626973e-002, -2.46472230985105e-002, -1.41665091485240e-002, -4.27705554574592e-003, -2.19443531699428e-002, 1.57480848494318e-002, -2.82342677446680e-002, 1.83212874598309e-002, -2.55902866762693e-002, 4.17771148710196e-002, -2.43726818429140e-002, 2.51442037362110e-002, -4.24845380313170e-003, -1.82412482306267e-002, -2.06558279744800e-002, -8.78259803952319e-003, 2.70308970252027e-004, 1.11030606395394e-002, -6.07384477232211e-003, -2.84281188216063e-002, -1.74458518450027e-003, 3.13505301064747e-002 },
 {2.45549862954640e-002, -1.24763058925877e-002, 2.49331876921478e-002, -2.56047891706042e-002, 1.89114348764577e-003, -2.73076625780733e-003, -3.54052592689676e-002, 2.76268562514070e-003, 6.77204627376546e-003, -1.22333812336799e-002, -1.53291558508876e-004, 2.14091612746113e-002, -4.22316704208653e-002, -5.80649331339814e-003, -1.96085923060962e-002, -3.32895404039763e-002, 1.16707448544355e-002, 2.16483710423416e-002, -3.13157343779723e-002, -1.11859349356976e-002, -2.49222360077305e-002, -8.52645073978055e-003 },
 {-1.85306985948323e-002, 5.56281212273734e-003, -1.89575478683288e-002, -1.46421085719579e-002, 1.49404025090142e-003, -1.73534737561717e-004, 6.77443380114747e-003, 1.34922110170445e-003, 2.06968911181352e-002, 4.05834766004134e-003, -2.76084245623266e-003, -1.55069042179432e-002, 3.28185410961119e-002, -3.25943409647059e-003, 2.26065152182966e-002, -3.07422104008374e-002, -1.11236449088320e-002, 2.35041917349246e-002, 2.52954266920925e-003, -1.35214290976187e-002, -1.53330978976661e-003, 9.96771214717869e-004 } 
};

double Over1cc_1_MLP_22_14_2_hidden_bias[14]={ -1.52193294243154e-002, -1.68197803767921e-002, 9.88676491192325e-003, 9.09813599782895e-003, 4.82761967081411e-004, -1.29996152143790e-002, 9.75498487470965e-003, 2.24422968795547e-002, 4.68113738861012e-002, 2.86836341625330e-002, -8.87642840395063e-003, -4.90245264663383e-003, 9.22351174548283e-003, -2.58036110837847e-002 };

double Over1cc_1_MLP_22_14_2_hidden_output_wts[2][14]=
{
 {5.18595644952779e-002, 6.22814896442179e-002, 5.03273817723956e-002, 6.31742758929961e-002, 5.60510206608744e-002, 3.40837135486603e-002, 3.27758779536901e-002, 9.77828714417067e-002, 3.96633536440439e-002, 7.26772647707864e-002, 6.72501641796441e-002, 2.01723743965140e-002, 6.67380005557863e-002, 1.87666261148419e-002 },
 {-6.20202980165576e-002, -7.28081927599225e-002, -8.66729528281662e-002, -6.03627204770339e-002, -8.85448856316228e-002, -2.37802979453798e-002, -3.54868707774951e-002, -2.04463102108361e-002, -1.88580079312447e-002, -6.51310867840156e-002, -1.61551876374785e-002, -5.19222721287159e-002, -3.81648078440720e-002, -2.72639546892222e-002 }
};

double Over1cc_1_MLP_22_14_2_output_bias[2]={ 6.91283953395082e-002, -7.01712136934448e-002 };

double Over1cc_1_MLP_22_14_2_max_input[22]={ 9.98205853844333e-001, 9.96754273526000e-001, 9.88273973642000e-001, 9.94484586788000e-001, 9.99979798185333e-001, 9.76060123067333e-001, 9.52733284084000e-001, 9.87684635119000e-001, 9.69573341435000e-001, 6.72263999322000e+000, 8.81938425504667e-001, 8.16193723420333e+000, 6.46031687483333e+000, 9.99252106464333e-001, 6.62255613583333e+000, 6.07940450162667e+000, 9.99999999999667e-001, 8.72043766244000e-001, 7.02255299145000e+000, 8.60739480852333e-001, 9.99345923680333e-001, 8.17330004459667e-001 };

double Over1cc_1_MLP_22_14_2_min_input[22]={ 9.52721802638333e-001, 9.43198268998333e-001, 9.25222052145667e-001, 9.22866729721667e-001, 8.14424454238667e-001, 8.49220519646333e-001, 8.08604996355667e-001, 8.10756773806000e-001, 8.12308146372000e-001, 4.59045323467000e+000, 5.74665956678667e-001, 5.22152556633667e+000, 3.66723035187000e+000, 6.35162254726333e-001, 4.08859126770667e+000, 3.25406740473667e+000, 6.17261118161667e-001, 3.89274609002333e-001, 3.28371146222667e+000, 3.66051471635667e-001, 5.87309286467000e-001, 3.12766281606667e-001 };

double Over1cc_1_MLP_22_14_2_input[22];
double Over1cc_1_MLP_22_14_2_hidden[14];
double Over1cc_1_MLP_22_14_2_output[2];

double Over1cc_1_MLP_22_14_2_MeanInputs[22]={ 9.80081546290821e-001, 9.77345870442747e-001, 9.68445460061317e-001, 9.69594031300026e-001, 9.93469783945517e-001, 9.23805996676869e-001, 8.90373090064010e-001, 9.35958806202452e-001, 9.23526263532740e-001, 5.80275234155330e+000, 7.46144412954567e-001, 6.68959782437721e+000, 5.11767729635330e+000, 9.09573969608779e-001, 5.44660949009885e+000, 4.89997422250522e+000, 8.92540199766663e-001, 6.94392499061394e-001, 5.23787381832914e+000, 6.48195949112430e-001, 8.41600640048571e-001, 6.59646113367811e-001 };

void Over1cc_1_MLP_22_14_2_FindMax(double* vec, double* max, long* maxIndex,int len)
{
  long i;
  *max = vec[0];
  *maxIndex = 0;
  for(i=1; i<len; i++)
  {
    if(vec[i]>*max)
    {
      *max = vec[i];
      *maxIndex = i;
    }
  }
}

void Over1cc_1_MLP_22_14_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over1cc_1_MLP_22_14_2_max_input[i]-Over1cc_1_MLP_22_14_2_min_input[i]);
	input[i] = minimum - delta*Over1cc_1_MLP_22_14_2_min_input[i]+ delta*input[i];
 }
}

void Over1cc_1_MLP_22_14_2_softmax(double* vec,int len)
{

  long i, j;
  double sum=0.0;
  for(i=0; i<len; i++)
  {
    if(vec[i]>200)
    {
      double max;
      long maxIndex;
      Over1cc_1_MLP_22_14_2_FindMax(vec, &max, &maxIndex,len);
      for(j=0; j<len; j++)
      {        if(j==maxIndex) vec[j] = 1.0;
        else vec[j] = 0.0;
      }
      return;
    }
    else
    {
      vec[i] = exp(vec[i]);
    }
    sum += vec[i];
  }
  if(sum==0)
  {
   long a = 1;
  }
  if(sum!=0.0)
  {
    for(i=0; i<len; i++) vec[i] = vec[i]/sum;
  }
  else for(i=0; i<len; i++) vec[i] = 1.0/(double)len;
}

void Over1cc_1_MLP_22_14_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==0) V_OUT[row] = exp(V_OUT[row]);
   }
}

void Over1cc_1_MLP_22_14_2_RunNeuralNet_Classification () 
{
  Over1cc_1_MLP_22_14_2_ComputeFeedForwardSignals((double*)Over1cc_1_MLP_22_14_2_input_hidden_weights,Over1cc_1_MLP_22_14_2_input,Over1cc_1_MLP_22_14_2_hidden,Over1cc_1_MLP_22_14_2_hidden_bias,22, 14,0);
  Over1cc_1_MLP_22_14_2_ComputeFeedForwardSignals((double*)Over1cc_1_MLP_22_14_2_hidden_output_wts,Over1cc_1_MLP_22_14_2_hidden,Over1cc_1_MLP_22_14_2_output,Over1cc_1_MLP_22_14_2_output_bias,14, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-HLLglcmIdmn): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[0]);
	printf("%s","Cont. Input-1(wavelet-LHLglcmIdmn): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-LLLglrlmRunLengthNonUniformityNormalized): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-LHHglcmIdmn): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-LLHglcmImc2): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-HHLglcmIdn): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[5]);
	printf("%s","Cont. Input-6(originalglcmIdn): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-LHLglrlmShortRunEmphasis): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[7]);
	printf("%s","Cont. Input-8(originalglrlmRunLengthNonUniformityNormalized): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-LHHgldmDependenceEntropy): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[9]);
	printf("%s","Cont. Input-10(originalglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[10]);
	printf("%s","Cont. Input-11(wavelet-LLLglszmZoneEntropy): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[11]);
	printf("%s","Cont. Input-12(originalglrlmRunEntropy): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[12]);
	printf("%s","Cont. Input-13(wavelet-LLLglcmMCC): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[13]);
	printf("%s","Cont. Input-14(wavelet-LHLglszmZoneEntropy): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[14]);
	printf("%s","Cont. Input-15(wavelet-LLLglcmDifferenceEntropy): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[15]);
	printf("%s","Cont. Input-16(wavelet-LLHglcmMCC): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[16]);
	printf("%s","Cont. Input-17(wavelet-LHHglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[17]);
	printf("%s","Cont. Input-18(originalglcmSumEntropy): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[18]);
	printf("%s","Cont. Input-19(wavelet-LHLglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[19]);
	printf("%s","Cont. Input-20(wavelet-HLLglcmImc2): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[20]);
	printf("%s","Cont. Input-21(originalshapeSphericity): ");
	scanf("%lg",&Over1cc_1_MLP_22_14_2_input[21]);
	for(cont_inps=0;cont_inps<22;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over1cc_1_MLP_22_14_2_input[cont_inps] == -9999)
	  Over1cc_1_MLP_22_14_2_input[cont_inps]=Over1cc_1_MLP_22_14_2_MeanInputs[cont_inps];
	}
    Over1cc_1_MLP_22_14_2_ScaleInputs(Over1cc_1_MLP_22_14_2_input,0,1,22);
	Over1cc_1_MLP_22_14_2_RunNeuralNet_Classification();
   //Output Activation is Softmax;
	Over1cc_1_MLP_22_14_2_softmax(Over1cc_1_MLP_22_14_2_output, 2);
	for(i=0;i<2;i++)
	{
      if(max<Over1cc_1_MLP_22_14_2_output[i])
      {
        max=Over1cc_1_MLP_22_14_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

