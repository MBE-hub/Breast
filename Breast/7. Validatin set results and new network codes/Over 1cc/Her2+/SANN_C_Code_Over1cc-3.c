//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over1cc_3_MLP_22_11_2_input_hidden_weights[11][22]=
{
 {-6.07863234770314e-003, -1.47405584480791e-001, 7.64333930645422e-002, -1.59034062413004e-001, 1.66059084890259e-001, -6.09789959233114e-002, -7.95960691824996e-002, 9.47370938203618e-003, 5.25346230693791e-002, 7.33569052016310e-003, 7.40777619949499e-002, -2.59706817723310e-002, 5.10225541403759e-002, 4.96963522891662e-002, -4.96925362800319e-003, 8.56870434353874e-002, 8.42185868649846e-002, 8.02826655562423e-004, 6.64854492065107e-002, -2.79081545963382e-002, 1.54545574830880e-001, 3.21768521739533e-001 },
 {6.46338041407535e-002, 9.71069847328175e-001, -6.22661182124454e-001, 2.43703811346181e-001, -3.00868395347543e-001, 5.28811519739055e-001, 1.69815603403001e-001, -2.37375210193041e-001, 6.34671554599707e-002, -8.12996412713148e-003, -3.38799162279929e-001, -1.71467673365745e-002, -8.04469166567493e-002, 4.27722747968757e-001, -2.54788657749532e-001, -5.00242585797665e-001, -3.08267419305280e-002, 5.61880962347560e-001, -1.31237434192306e-001, 4.17639539432326e-001, -2.22916325698672e-001, -1.40449286557258e+000 },
 {-1.05626860532171e-001, -6.68764216586334e-001, 6.69042118247548e-001, 1.65826900026910e-001, 1.42854078552223e-002, -2.81746745194531e-001, 6.36379801088724e-002, 3.68098704597662e-001, -1.35806803780822e-001, 1.35775614371711e-001, 2.57188454719525e-001, 1.23767927713082e-001, -6.53426525880157e-003, -3.25451522102699e-001, 3.63396737988673e-001, 4.58344124382547e-001, -8.50472650375897e-002, -4.74721728694107e-001, -1.52399890941201e-002, -2.99611524848369e-001, 3.20276167978752e-002, 8.04103382790080e-001 },
 {4.06306535320154e-001, 1.00393312752517e+000, -8.26563008653585e-001, -1.62043526548364e-001, 2.86341021543965e-002, 5.55024622303074e-001, 1.00996762611605e-001, -3.48300318849122e-001, 2.44531312921334e-001, -3.92293899630951e-002, -2.84135917702154e-001, 1.55770755546373e-002, 9.06386400517810e-002, 6.53964668866760e-001, -3.34119947889407e-001, -4.78235061408947e-001, 9.72213509769176e-002, 6.90997994765936e-001, 1.22784425160062e-001, 4.50014799721463e-001, -1.30890167993104e-001, -1.06364650411885e+000 },
 {3.68292109441746e-001, 1.74849212869650e+000, -1.25965827754149e+000, 2.47385232152839e-001, -4.16442322017967e-001, 9.48562408869554e-001, 2.68876284761240e-001, -5.69126728509868e-001, 1.38341675859295e-001, -1.72829607792126e-002, -6.46493160084642e-001, -7.32178024911918e-002, -2.21245031013180e-002, 7.90230175289299e-001, -5.05888007447298e-001, -9.68939463460136e-001, 2.32697342536383e-002, 1.09638742760390e+000, -1.04043706283713e-001, 8.21381926631861e-001, -3.66985999504623e-001, -2.35192505414454e+000 },
 {-9.89850270771784e-002, -4.71184959214866e-001, 4.79474233479927e-001, 4.82860924407859e-002, 7.87450101149309e-002, -2.16450130921190e-001, -3.02656291929393e-002, 2.62268776913965e-001, -2.60971653163445e-002, 1.23736907453041e-002, 2.16324373681703e-001, 3.98040852649788e-002, -1.67379794337256e-002, -1.41764991226777e-001, 2.17686015023967e-001, 2.59168209703001e-001, 1.06188545524895e-001, -2.79566386014971e-001, -3.91891394178409e-002, -1.40100974181755e-001, 1.78991925826730e-001, 6.06012780949014e-001 },
 {2.12002690089681e-001, 7.92718842675358e-001, -6.28681109148445e-001, 9.33886466340003e-002, -1.67415508392671e-001, 4.05416457319076e-001, 1.55359887191346e-001, -2.44758927210302e-001, 1.66394182719778e-002, 1.29317831363702e-002, -3.65528936279964e-001, -1.56141313812287e-002, -8.22540960842452e-002, 3.22738110914233e-001, -2.41793026397249e-001, -4.84043129401019e-001, -7.20715942977549e-002, 4.44606960733725e-001, -5.04601559281980e-002, 3.12410404808434e-001, -2.73374775248210e-001, -9.68103130061165e-001 },
 {-6.41121456679116e-002, 3.72273866934639e-001, -1.33246508630458e-001, 3.20916920084937e-001, -2.81219713501726e-001, 2.16674970326227e-001, 1.83907697195504e-001, 2.28644060843828e-002, -7.59944641037020e-002, 6.45113582157864e-003, -2.67085621535362e-001, 7.25557391264996e-003, -1.48611864989806e-001, 1.20378928450402e-001, -3.25067306920813e-002, -2.18776107661771e-001, -1.20271915200860e-001, 1.38593477119163e-002, -2.16661915715255e-001, 1.04996646071577e-001, -2.15660348889139e-001, -6.50662893347167e-001 },
 {4.48885066410684e-002, -6.61589073743927e-001, 9.95275969119651e-002, -7.25261633953082e-001, 2.02265974469329e-001, -3.43818984660489e-001, -4.68954698791988e-001, -1.19725089286701e-001, 1.36924177201535e-001, -6.30314919770681e-003, 4.01534911848742e-001, 2.02551626377727e-003, 2.92305922073163e-001, -2.02784321459031e-001, 3.89911574345363e-003, 2.46128398775805e-001, -2.98918733824952e-002, -1.06875391194070e-001, 3.50097037044042e-001, -1.86763346637352e-001, 3.41663192360497e-001, 8.79867453713732e-001 },
 {-1.58536751622997e-001, -3.69026745015229e-001, 1.22461091678156e-002, -2.97749284946815e-001, -1.18383413021261e-001, -2.33137641780005e-001, -2.40191505595711e-001, -2.10458805660763e-001, -8.48934552056489e-002, -5.88844029019094e-002, 7.16534752335596e-002, -8.78853397997383e-002, 2.60275547282753e-002, -2.94649370650884e-001, -5.93978072305664e-002, 1.55338541252104e-001, -1.26772310437498e-001, -1.42355719175924e-001, 8.68762820517053e-002, -2.15225695725553e-001, 1.17125251920821e-001, 1.30261422228957e-001 },
 {1.37600004687532e-001, 8.43208420457234e-001, -6.36705366034311e-001, 1.62850933071271e-001, -2.42265863586108e-001, 4.15666125120982e-001, 1.60239761084001e-001, -2.66260956009750e-001, 1.78883445628346e-002, -5.87338583093440e-002, -3.47299837579373e-001, -3.75868756795891e-002, -3.84635220342361e-002, 3.56303869359771e-001, -2.26821985310014e-001, -4.57829388836502e-001, -4.10831039792860e-002, 4.42336790462664e-001, -1.01922418118734e-001, 2.93415878677452e-001, -2.29757810724579e-001, -1.18224690464663e+000 } 
};

double Over1cc_3_MLP_22_11_2_hidden_bias[11]={ 3.32524209225161e-002, 5.40083918202844e-003, -3.32146241178840e-002, 2.41545489734872e-001, 5.26937918245213e-002, 2.32817322941296e-002, 8.86327702594111e-002, -1.02362438486562e-002, -1.61053186110336e-001, -4.01099305126610e-001, 1.26612177433866e-002 };

double Over1cc_3_MLP_22_11_2_hidden_output_wts[2][11]=
{
 {2.99375255521676e-001, 2.90645116726819e-001, -4.38481925456376e-001, 6.39563385828811e-001, 8.68851497113464e-001, -5.95323763089390e-002, 1.09526190258281e-001, -4.43872031231390e-001, 8.09531885340367e-001, -2.10726471188951e-001, 8.68935068604774e-002 },
 {-1.41099719826318e-001, 1.29705063376890e-001, 6.27384487379236e-001, -9.72478833773804e-001, -4.29673842509936e-001, 5.44316094115939e-001, -2.41770847686246e-001, 6.14410938053583e-001, -1.08724865388555e+000, -1.01197121558606e+000, -3.15881204857903e-002 }
};

double Over1cc_3_MLP_22_11_2_output_bias[2]={ 1.12749000599294e+000, -7.77153091502446e-001 };

double Over1cc_3_MLP_22_11_2_max_input[22]={ 9.98205853844333e-001, 9.96754273526000e-001, 9.88273973642000e-001, 9.94484586788000e-001, 9.99979798185333e-001, 9.76060123067333e-001, 9.52733284084000e-001, 9.87684635119000e-001, 9.69573341435000e-001, 6.72263999322000e+000, 8.81938425504667e-001, 8.16193723420333e+000, 6.46031687483333e+000, 9.99252106464333e-001, 6.62255613583333e+000, 6.07940450162667e+000, 9.99999999999667e-001, 8.72043766244000e-001, 7.02255299145000e+000, 8.60739480852333e-001, 9.99345923680333e-001, 8.17330004459667e-001 };

double Over1cc_3_MLP_22_11_2_min_input[22]={ 9.52721802638333e-001, 9.43198268998333e-001, 9.25222052145667e-001, 9.22866729721667e-001, 8.14424454238667e-001, 8.49220519646333e-001, 8.08604996355667e-001, 8.10756773806000e-001, 8.12308146372000e-001, 4.59045323467000e+000, 5.74665956678667e-001, 5.22152556633667e+000, 3.66723035187000e+000, 6.35162254726333e-001, 4.08859126770667e+000, 3.25406740473667e+000, 6.17261118161667e-001, 3.89274609002333e-001, 3.28371146222667e+000, 3.66051471635667e-001, 5.87309286467000e-001, 3.12766281606667e-001 };

double Over1cc_3_MLP_22_11_2_input[22];
double Over1cc_3_MLP_22_11_2_hidden[11];
double Over1cc_3_MLP_22_11_2_output[2];

double Over1cc_3_MLP_22_11_2_MeanInputs[22]={ 9.80081546290821e-001, 9.77345870442747e-001, 9.68445460061317e-001, 9.69594031300026e-001, 9.93469783945517e-001, 9.23805996676869e-001, 8.90373090064010e-001, 9.35958806202452e-001, 9.23526263532740e-001, 5.80275234155330e+000, 7.46144412954567e-001, 6.68959782437721e+000, 5.11767729635330e+000, 9.09573969608779e-001, 5.44660949009885e+000, 4.89997422250522e+000, 8.92540199766663e-001, 6.94392499061394e-001, 5.23787381832914e+000, 6.48195949112430e-001, 8.41600640048571e-001, 6.59646113367811e-001 };

void Over1cc_3_MLP_22_11_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over1cc_3_MLP_22_11_2_max_input[i]-Over1cc_3_MLP_22_11_2_min_input[i]);
	input[i] = minimum - delta*Over1cc_3_MLP_22_11_2_min_input[i]+ delta*input[i];
 }
}

void Over1cc_3_MLP_22_11_2_Normalise(double out[],long length)
{
  long i, j;
  double sum = 0.0;
  for(i=0; i<length; i++)
  {
   if(out[i]>100)
   {
    out[i] = 1.0;
    j = i;
    for(i=0; i<length; i++)
    {
     if(i!=j) out[i] = 0.0;
    }
    break;
   }
   else out[i] = exp(out[i]);
  }
  for(i=0; i<length; i++)
  {
   sum += out[i];
  }
  for(i=0; i<length; i++)
  {
   out[i] = out[i]/sum;
  }
}

void Over1cc_3_MLP_22_11_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==0) V_OUT[row] = tanh(V_OUT[row]);
      if(layer==1) V_OUT[row] = tanh(V_OUT[row]);
   }
}

void Over1cc_3_MLP_22_11_2_RunNeuralNet_Classification () 
{
  Over1cc_3_MLP_22_11_2_ComputeFeedForwardSignals((double*)Over1cc_3_MLP_22_11_2_input_hidden_weights,Over1cc_3_MLP_22_11_2_input,Over1cc_3_MLP_22_11_2_hidden,Over1cc_3_MLP_22_11_2_hidden_bias,22, 11,0);
  Over1cc_3_MLP_22_11_2_ComputeFeedForwardSignals((double*)Over1cc_3_MLP_22_11_2_hidden_output_wts,Over1cc_3_MLP_22_11_2_hidden,Over1cc_3_MLP_22_11_2_output,Over1cc_3_MLP_22_11_2_output_bias,11, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-HLLglcmIdmn): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[0]);
	printf("%s","Cont. Input-1(wavelet-LHLglcmIdmn): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-LLLglrlmRunLengthNonUniformityNormalized): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-LHHglcmIdmn): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-LLHglcmImc2): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-HHLglcmIdn): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[5]);
	printf("%s","Cont. Input-6(originalglcmIdn): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-LHLglrlmShortRunEmphasis): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[7]);
	printf("%s","Cont. Input-8(originalglrlmRunLengthNonUniformityNormalized): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-LHHgldmDependenceEntropy): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[9]);
	printf("%s","Cont. Input-10(originalglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[10]);
	printf("%s","Cont. Input-11(wavelet-LLLglszmZoneEntropy): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[11]);
	printf("%s","Cont. Input-12(originalglrlmRunEntropy): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[12]);
	printf("%s","Cont. Input-13(wavelet-LLLglcmMCC): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[13]);
	printf("%s","Cont. Input-14(wavelet-LHLglszmZoneEntropy): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[14]);
	printf("%s","Cont. Input-15(wavelet-LLLglcmDifferenceEntropy): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[15]);
	printf("%s","Cont. Input-16(wavelet-LLHglcmMCC): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[16]);
	printf("%s","Cont. Input-17(wavelet-LHHglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[17]);
	printf("%s","Cont. Input-18(originalglcmSumEntropy): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[18]);
	printf("%s","Cont. Input-19(wavelet-LHLglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[19]);
	printf("%s","Cont. Input-20(wavelet-HLLglcmImc2): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[20]);
	printf("%s","Cont. Input-21(originalshapeSphericity): ");
	scanf("%lg",&Over1cc_3_MLP_22_11_2_input[21]);
	for(cont_inps=0;cont_inps<22;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over1cc_3_MLP_22_11_2_input[cont_inps] == -9999)
	  Over1cc_3_MLP_22_11_2_input[cont_inps]=Over1cc_3_MLP_22_11_2_MeanInputs[cont_inps];
	}
    Over1cc_3_MLP_22_11_2_ScaleInputs(Over1cc_3_MLP_22_11_2_input,0,1,22);
	Over1cc_3_MLP_22_11_2_RunNeuralNet_Classification();
   //Normalise output if output activation is not Softmax;
 	Over1cc_3_MLP_22_11_2_Normalise(Over1cc_3_MLP_22_11_2_output,2);
	for(i=0;i<2;i++)
	{
      if(max<Over1cc_3_MLP_22_11_2_output[i])
      {
        max=Over1cc_3_MLP_22_11_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

