//Analysis Type - Classification 
#include <stdio.h>
#include <conio.h>
#include <math.h>
#include <stdlib.h>


double Over1cc_2_MLP_22_10_2_input_hidden_weights[10][22]=
{
 {2.31544348545004e+000, 1.05534763314488e+001, -7.52719708886073e+000, 3.59939508748258e+000, -2.05815605926013e+000, 4.07009768894935e+000, -3.37035770159199e+000, -5.94534149086114e+000, 2.15750984023257e+000, -1.81683584785548e+000, -4.90443666290410e+000, -3.81083954903445e-001, 2.09465826054934e+000, 1.27309065288744e+000, -3.60191018005161e+000, -1.01327803794215e+001, 4.33997253039946e+000, 7.95932482701482e+000, 3.25816564103878e+000, 7.14630975382635e+000, -2.32249522937699e+000, -1.10137532901413e+001 },
 {2.78487052803633e+000, 4.53033382016120e+000, -8.57792564180093e-002, 1.81532578146481e+000, 4.54597462070483e-001, 3.79801754922637e+000, 5.68300576913282e+000, -5.73636498071316e-001, -1.55674449360699e+000, 2.70284183504192e-002, -3.94685585567843e+000, -1.34500586701804e+000, -5.11622560834949e+000, -1.10012867744851e+000, -3.49871679498713e+000, 2.53961661918679e-001, 3.34363067959015e+000, -1.99863557169292e+000, -5.08840253465734e+000, -5.38946134154848e-001, 1.46933828526770e+000, -5.55261554794496e+000 },
 {1.86672169524000e+000, 9.02047957107241e+000, -6.86927072595003e+000, 3.27460761072847e+000, -3.32942392435895e+000, 4.29035805571815e+000, 1.99604277186081e+000, -4.29710313195655e+000, -1.10237453398213e+000, -1.93502515392511e-002, -5.10355725492067e+000, 4.38240436650914e-001, -5.83056228593999e-001, 8.51369684115513e-001, -2.24830692549884e+000, -4.60672108255465e+000, -2.40129361356164e+000, 3.80261072535323e+000, -3.90637033218224e-001, 2.72273915760527e+000, -4.51589289401760e+000, -1.17966981239562e+001 },
 {6.63642006489764e-001, 6.63565839807981e+000, -6.68862939744353e+000, 1.70233705108579e+000, -4.73390048661583e+000, 3.50367972783439e+000, 1.88889671363725e+000, -3.69088759498593e+000, -1.88266624488270e+000, 2.71232347408288e-001, -4.69531652169011e+000, 3.41564907816244e-004, -1.07191695607719e+000, -3.65860348449256e-001, -1.63385390979426e+000, -3.56294404012173e+000, -4.31760409101754e+000, 2.48281113904782e+000, -1.10444457382564e+000, 1.22541641019765e+000, -4.42430265966847e+000, -1.17939536044540e+001 },
 {3.62908977456402e+000, 8.49276127298270e+000, -7.48620882244632e+000, -3.70742250972743e-001, -3.97928770075341e+000, 5.61787057585110e+000, -1.33838671010405e+000, -4.99217854072275e+000, 1.31422617611462e+000, -1.47917188716034e+000, -4.25349697954210e+000, 2.72036198243160e-001, 3.95769801684009e+000, 4.16658001618625e+000, -2.56816779686185e+000, -6.30119541028085e+000, 2.46752675694594e+000, 8.20299073284942e+000, 4.47433374893774e+000, 7.24839440640711e+000, -4.54929434763873e-001, -1.35872671675184e+001 },
 {7.67578145594697e+000, 7.15902003523865e+000, -2.36243602904085e+001, -9.78368213274076e+000, -2.12589777503955e+000, 3.75701680704892e+000, -2.97579193633881e-001, -7.31619504417730e+000, -7.29853383035151e-001, -6.98392662793880e+000, -6.94826248794151e+000, -9.77833160435127e+000, 3.68613734672532e+000, 1.75430482958573e+001, -5.87693943606100e+000, 1.76980219623412e+000, 5.51974535936441e+000, 9.80160312785589e+000, 1.01943899092219e+001, 5.54253430933178e-001, 1.07803637555314e+001, -9.92661641705906e+000 },
 {1.74750472140450e+000, 5.44321518926058e+000, -3.24921909545486e+000, -3.23372104796997e-001, -1.44645870171980e+000, 2.81321955704549e+000, 3.66555414098313e-001, -2.43731903295510e+000, 6.81799305183753e-001, -1.48828073460946e+000, -2.70971402601141e+000, -9.61631265621118e-001, -1.59265058497348e+000, 2.44476227659987e+000, -3.09230546714758e+000, -3.88968252463974e+000, 1.25021692192231e+000, 1.02155089862920e+000, -1.62864350742882e+000, 8.15318678389384e-001, -1.78193594745553e+000, -7.64877039703008e+000 },
 {-3.13778800853227e-001, 3.21887534885181e+000, -3.35864691130758e+000, 1.54450615470830e+000, -1.51048894049677e+000, 3.65429303027507e+000, 4.33793326489692e+000, 4.19503439295523e+000, -2.51447317965622e-001, 3.10410682078887e+000, -3.31696104997905e-001, -1.12171842629840e+000, -3.26638491481907e+000, -5.36159895588813e-002, 2.74443151539548e+000, 7.04166639639688e-001, -5.03089419623477e+000, 2.07145334086970e+000, -3.94858620594857e+000, 1.94156682533472e-001, -1.64817299093929e+000, -8.19691749762375e+000 },
 {3.52475906430658e+000, 1.15026835047665e+001, -6.17515756691240e+000, 7.47579426932349e+000, -2.42304447262108e+000, 4.43522796524159e+000, 9.06295679478126e-001, -8.03948807699241e+000, -9.50879043413178e-001, -7.31674653742585e-001, -8.02967299559168e+000, 1.76789882378122e+000, 1.02247563595641e+000, -3.96853102650151e+000, -3.06482832287517e+000, -7.00393431214764e+000, -6.86743253655001e-001, 3.31543707566043e+000, 2.43244870437117e+000, 3.41281208625691e+000, -7.46491193912281e+000, -9.57041679641360e+000 },
 {1.29775086369429e+000, 6.46591703728306e+000, -4.51646837400665e+000, 1.99220186419455e+000, -2.23215037985169e+000, 3.78933764669585e+000, 1.99972668895031e+000, -1.80685223512044e+000, -1.17431828529132e-001, 5.97138730004768e-001, -2.71049174365026e+000, 2.10373999704648e-001, -4.35343228895804e-001, 1.60487056886155e+000, -1.04565086132016e+000, -2.54274105622886e+000, -1.46851718664997e+000, 3.26480320520467e+000, -6.40116698550934e-001, 2.19715909759808e+000, -2.21022249248584e+000, -9.06470344665215e+000 } 
};

double Over1cc_2_MLP_22_10_2_hidden_bias[10]={ 1.89391616541742e+000, 1.21877200623490e+000, -2.84781867987365e-001, -2.32475348520272e+000, -3.87386648448240e-001, 1.39444215972905e+000, 1.38305299380109e-001, -4.51350991571708e-001, 1.60908877856890e+000, -8.99424034108182e-002 };

double Over1cc_2_MLP_22_10_2_hidden_output_wts[2][10]=
{
 {1.83398611433375e+000, -1.62396167637869e+000, 1.42907911074383e+000, -6.76892285551201e-001, 6.05685841172260e-001, 2.78045100821971e+000, -2.18614969863224e+000, -6.78691084354167e-001, 2.07438957558847e+000, -5.02206176125654e-001 },
 {-1.79807747824113e+000, 1.66946579689725e+000, -1.42817098512148e+000, 6.94830259585291e-001, -6.62945911971405e-001, -2.77204112268073e+000, 2.19563664439540e+000, 6.43362078030448e-001, -2.07032152282923e+000, 5.26050257806515e-001 }
};

double Over1cc_2_MLP_22_10_2_output_bias[2]={ 5.01131462513885e-002, -7.48865113833009e-002 };

double Over1cc_2_MLP_22_10_2_max_input[22]={ 9.98205853844333e-001, 9.96754273526000e-001, 9.88273973642000e-001, 9.94484586788000e-001, 9.99979798185333e-001, 9.76060123067333e-001, 9.52733284084000e-001, 9.87684635119000e-001, 9.69573341435000e-001, 6.72263999322000e+000, 8.81938425504667e-001, 8.16193723420333e+000, 6.46031687483333e+000, 9.99252106464333e-001, 6.62255613583333e+000, 6.07940450162667e+000, 9.99999999999667e-001, 8.72043766244000e-001, 7.02255299145000e+000, 8.60739480852333e-001, 9.99345923680333e-001, 8.17330004459667e-001 };

double Over1cc_2_MLP_22_10_2_min_input[22]={ 9.52721802638333e-001, 9.43198268998333e-001, 9.25222052145667e-001, 9.22866729721667e-001, 8.14424454238667e-001, 8.49220519646333e-001, 8.08604996355667e-001, 8.10756773806000e-001, 8.12308146372000e-001, 4.59045323467000e+000, 5.74665956678667e-001, 5.22152556633667e+000, 3.66723035187000e+000, 6.35162254726333e-001, 4.08859126770667e+000, 3.25406740473667e+000, 6.17261118161667e-001, 3.89274609002333e-001, 3.28371146222667e+000, 3.66051471635667e-001, 5.87309286467000e-001, 3.12766281606667e-001 };

double Over1cc_2_MLP_22_10_2_input[22];
double Over1cc_2_MLP_22_10_2_hidden[10];
double Over1cc_2_MLP_22_10_2_output[2];

double Over1cc_2_MLP_22_10_2_MeanInputs[22]={ 9.80081546290821e-001, 9.77345870442747e-001, 9.68445460061317e-001, 9.69594031300026e-001, 9.93469783945517e-001, 9.23805996676869e-001, 8.90373090064010e-001, 9.35958806202452e-001, 9.23526263532740e-001, 5.80275234155330e+000, 7.46144412954567e-001, 6.68959782437721e+000, 5.11767729635330e+000, 9.09573969608779e-001, 5.44660949009885e+000, 4.89997422250522e+000, 8.92540199766663e-001, 6.94392499061394e-001, 5.23787381832914e+000, 6.48195949112430e-001, 8.41600640048571e-001, 6.59646113367811e-001 };

void Over1cc_2_MLP_22_10_2_FindMax(double* vec, double* max, long* maxIndex,int len)
{
  long i;
  *max = vec[0];
  *maxIndex = 0;
  for(i=1; i<len; i++)
  {
    if(vec[i]>*max)
    {
      *max = vec[i];
      *maxIndex = i;
    }
  }
}

void Over1cc_2_MLP_22_10_2_ScaleInputs(double* input, double minimum, double maximum, int size)
{
 double delta;
 long i;
 for(i=0; i<size; i++)
 {
	delta = (maximum-minimum)/(Over1cc_2_MLP_22_10_2_max_input[i]-Over1cc_2_MLP_22_10_2_min_input[i]);
	input[i] = minimum - delta*Over1cc_2_MLP_22_10_2_min_input[i]+ delta*input[i];
 }
}

void Over1cc_2_MLP_22_10_2_softmax(double* vec,int len)
{

  long i, j;
  double sum=0.0;
  for(i=0; i<len; i++)
  {
    if(vec[i]>200)
    {
      double max;
      long maxIndex;
      Over1cc_2_MLP_22_10_2_FindMax(vec, &max, &maxIndex,len);
      for(j=0; j<len; j++)
      {        if(j==maxIndex) vec[j] = 1.0;
        else vec[j] = 0.0;
      }
      return;
    }
    else
    {
      vec[i] = exp(vec[i]);
    }
    sum += vec[i];
  }
  if(sum==0)
  {
   long a = 1;
  }
  if(sum!=0.0)
  {
    for(i=0; i<len; i++) vec[i] = vec[i]/sum;
  }
  else for(i=0; i<len; i++) vec[i] = 1.0/(double)len;
}

void Over1cc_2_MLP_22_10_2_ComputeFeedForwardSignals(double* MAT_INOUT,double* V_IN,double* V_OUT, double* V_BIAS,int size1,int size2,int layer)
{
  int row,col;
  for(row=0;row < size2; row++) 
    {
      V_OUT[row]=0.0;
      for(col=0;col<size1;col++)V_OUT[row]+=(*(MAT_INOUT+(row*size1)+col)*V_IN[col]);
      V_OUT[row]+=V_BIAS[row];
      if(layer==0) V_OUT[row] = exp(V_OUT[row]);
   }
}

void Over1cc_2_MLP_22_10_2_RunNeuralNet_Classification () 
{
  Over1cc_2_MLP_22_10_2_ComputeFeedForwardSignals((double*)Over1cc_2_MLP_22_10_2_input_hidden_weights,Over1cc_2_MLP_22_10_2_input,Over1cc_2_MLP_22_10_2_hidden,Over1cc_2_MLP_22_10_2_hidden_bias,22, 10,0);
  Over1cc_2_MLP_22_10_2_ComputeFeedForwardSignals((double*)Over1cc_2_MLP_22_10_2_hidden_output_wts,Over1cc_2_MLP_22_10_2_hidden,Over1cc_2_MLP_22_10_2_output,Over1cc_2_MLP_22_10_2_output_bias,10, 2,1);
}

int main()
{
  int cont_inps;
  int index;
  int i=0;
  int keyin=1;
  double max;
  while(1)
  {
	max=3.e-300;
	printf("\n%s\n","Enter values for Continuous inputs (To skip a continuous input please enter -9999)");
	printf("%s","Cont. Input-0(wavelet-HLLglcmIdmn): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[0]);
	printf("%s","Cont. Input-1(wavelet-LHLglcmIdmn): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[1]);
	printf("%s","Cont. Input-2(wavelet-LLLglrlmRunLengthNonUniformityNormalized): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[2]);
	printf("%s","Cont. Input-3(wavelet-LHHglcmIdmn): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[3]);
	printf("%s","Cont. Input-4(wavelet-LLHglcmImc2): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[4]);
	printf("%s","Cont. Input-5(wavelet-HHLglcmIdn): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[5]);
	printf("%s","Cont. Input-6(originalglcmIdn): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[6]);
	printf("%s","Cont. Input-7(wavelet-LHLglrlmShortRunEmphasis): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[7]);
	printf("%s","Cont. Input-8(originalglrlmRunLengthNonUniformityNormalized): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[8]);
	printf("%s","Cont. Input-9(wavelet-LHHgldmDependenceEntropy): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[9]);
	printf("%s","Cont. Input-10(originalglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[10]);
	printf("%s","Cont. Input-11(wavelet-LLLglszmZoneEntropy): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[11]);
	printf("%s","Cont. Input-12(originalglrlmRunEntropy): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[12]);
	printf("%s","Cont. Input-13(wavelet-LLLglcmMCC): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[13]);
	printf("%s","Cont. Input-14(wavelet-LHLglszmZoneEntropy): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[14]);
	printf("%s","Cont. Input-15(wavelet-LLLglcmDifferenceEntropy): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[15]);
	printf("%s","Cont. Input-16(wavelet-LLHglcmMCC): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[16]);
	printf("%s","Cont. Input-17(wavelet-LHHglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[17]);
	printf("%s","Cont. Input-18(originalglcmSumEntropy): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[18]);
	printf("%s","Cont. Input-19(wavelet-LHLglszmSmallAreaEmphasis): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[19]);
	printf("%s","Cont. Input-20(wavelet-HLLglcmImc2): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[20]);
	printf("%s","Cont. Input-21(originalshapeSphericity): ");
	scanf("%lg",&Over1cc_2_MLP_22_10_2_input[21]);
	for(cont_inps=0;cont_inps<22;cont_inps++)
	{
     //Substitution of missing continuous variables
     if(Over1cc_2_MLP_22_10_2_input[cont_inps] == -9999)
	  Over1cc_2_MLP_22_10_2_input[cont_inps]=Over1cc_2_MLP_22_10_2_MeanInputs[cont_inps];
	}
    Over1cc_2_MLP_22_10_2_ScaleInputs(Over1cc_2_MLP_22_10_2_input,0,1,22);
	Over1cc_2_MLP_22_10_2_RunNeuralNet_Classification();
   //Output Activation is Softmax;
	Over1cc_2_MLP_22_10_2_softmax(Over1cc_2_MLP_22_10_2_output, 2);
	for(i=0;i<2;i++)
	{
      if(max<Over1cc_2_MLP_22_10_2_output[i])
      {
        max=Over1cc_2_MLP_22_10_2_output[i];
        index=i+1;
      }
	}
	printf("\n%s","Predicted category = ");

    switch(index)
    {
        case 1: printf("%s\n","0"); break;
        case 2: printf("%s\n","1"); break;
        default: break;
    }
    printf("\n%s%.14f","Confidence level = ",max);
	printf("\n\n%s\n","Press any key to make another prediction or enter 0 to quit the program.");
	keyin=getch();
	if(keyin==48)break;
  }
	return 0;
}

